import{a as m,b as S,c as mn,d as _t,e as ls,f}from"./chunk-P4F3WYZT.js";var wg=null;var rd=1,Ag=Symbol("SIGNAL");function Z(t){let e=wg;return wg=t,e}var Sg={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function hI(t){if(!(sd(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===rd)){if(!t.producerMustRecompute(t)&&!od(t)){t.dirty=!1,t.lastCleanEpoch=rd;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=rd}}function Dg(t){return t&&(t.nextProducerIndex=0),Z(t)}function bg(t,e){if(Z(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(sd(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)id(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function od(t){gc(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(hI(n),r!==n.version))return!0}return!1}function _g(t){if(gc(t),sd(t))for(let e=0;e<t.producerNode.length;e++)id(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function id(t,e){if(fI(t),gc(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)id(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],o=t.liveConsumerNode[e];gc(o),o.producerIndexOfThis[r]=e}}function sd(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function gc(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function fI(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function pI(){throw new Error}var gI=pI;function Rg(t){gI=t}function B(t){return typeof t=="function"}function Po(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var mc=Po(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function us(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Se=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let i of n)i.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(B(r))try{r()}catch(i){e=i instanceof mc?i.errors:[i]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let i of o)try{Mg(i)}catch(s){e=e??[],s instanceof mc?e=[...e,...s.errors]:e.push(s)}}if(e)throw new mc(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Mg(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&us(n,e)}remove(e){let{_finalizers:n}=this;n&&us(n,e),e instanceof t&&e._removeParent(this)}};Se.EMPTY=(()=>{let t=new Se;return t.closed=!0,t})();var ad=Se.EMPTY;function yc(t){return t instanceof Se||t&&"closed"in t&&B(t.remove)&&B(t.add)&&B(t.unsubscribe)}function Mg(t){B(t)?t():t.unsubscribe()}var Rt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var xo={setTimeout(t,e,...n){let{delegate:r}=xo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=xo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function vc(t){xo.setTimeout(()=>{let{onUnhandledError:e}=Rt;if(e)e(t);else throw t})}function ds(){}var Ng=cd("C",void 0,void 0);function kg(t){return cd("E",void 0,t)}function Og(t){return cd("N",t,void 0)}function cd(t,e,n){return{kind:t,value:e,error:n}}var Sr=null;function Lo(t){if(Rt.useDeprecatedSynchronousErrorHandling){let e=!Sr;if(e&&(Sr={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Sr;if(Sr=null,n)throw r}}else t()}function Pg(t){Rt.useDeprecatedSynchronousErrorHandling&&Sr&&(Sr.errorThrown=!0,Sr.error=t)}var Dr=class extends Se{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,yc(e)&&e.add(this)):this.destination=vI}static create(e,n,r){return new Fo(e,n,r)}next(e){this.isStopped?ud(Og(e),this):this._next(e)}error(e){this.isStopped?ud(kg(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ud(Ng,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},mI=Function.prototype.bind;function ld(t,e){return mI.call(t,e)}var dd=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Cc(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Cc(r)}else Cc(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Cc(n)}}},Fo=class extends Dr{constructor(e,n,r){super();let o;if(B(e)||!e)o={next:e??void 0,error:n??void 0,complete:r??void 0};else{let i;this&&Rt.useDeprecatedNextContext?(i=Object.create(e),i.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&ld(e.next,i),error:e.error&&ld(e.error,i),complete:e.complete&&ld(e.complete,i)}):o=e}this.destination=new dd(o)}};function Cc(t){Rt.useDeprecatedSynchronousErrorHandling?Pg(t):vc(t)}function yI(t){throw t}function ud(t,e){let{onStoppedNotification:n}=Rt;n&&xo.setTimeout(()=>n(t,e))}var vI={closed:!0,next:ds,error:yI,complete:ds};var Uo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ct(t){return t}function hd(...t){return fd(t)}function fd(t){return t.length===0?ct:t.length===1?t[0]:function(n){return t.reduce((r,o)=>o(r),n)}}var te=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,o){let i=EI(n)?n:new Fo(n,r,o);return Lo(()=>{let{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=xg(r),new r((o,i)=>{let s=new Fo({next:a=>{try{n(a)}catch(c){i(c),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Uo](){return this}pipe(...n){return fd(n)(this)}toPromise(n){return n=xg(n),new n((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return t.create=e=>new t(e),t})();function xg(t){var e;return(e=t??Rt.Promise)!==null&&e!==void 0?e:Promise}function CI(t){return t&&B(t.next)&&B(t.error)&&B(t.complete)}function EI(t){return t&&t instanceof Dr||CI(t)&&yc(t)}function pd(t){return B(t?.lift)}function W(t){return e=>{if(pd(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(t,e,n,r,o){return new gd(t,e,n,r,o)}var gd=class extends Dr{constructor(e,n,r,o,i,s){super(e),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=o?function(a){try{o(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ho(){return W((t,e)=>{let n=null;t._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let o=t._connection,i=n;n=null,o&&(!i||o===i)&&o.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Bo=class extends te{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,pd(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Se;let n=this.getSubject();e.add(this.source.subscribe(Y(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Se.EMPTY)}return e}refCount(){return Ho()(this)}};var Lg=Po(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ie=(()=>{class t extends te{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Ec(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Lg}next(n){Lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Lo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:o,observers:i}=this;return r||o?ad:(this.currentObservers=null,i.push(n),new Se(()=>{this.currentObservers=null,us(i,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:o,isStopped:i}=this;r?n.error(o):i&&n.complete()}asObservable(){let n=new te;return n.source=this,n}}return t.create=(e,n)=>new Ec(e,n),t})(),Ec=class extends Ie{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:ad}};var De=class extends Ie{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var md={now(){return(md.delegate||Date).now()},delegate:void 0};var hs=class extends Ie{constructor(e=1/0,n=1/0,r=md){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:o,_timestampProvider:i,_windowTime:s}=this;n||(r.push(e),!o&&r.push(i.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:o}=this,i=o.slice();for(let s=0;s<i.length&&!e.closed;s+=r?1:2)e.next(i[s]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:o}=this,i=(o?1:2)*e;if(e<1/0&&i<r.length&&r.splice(0,r.length-i),!o){let s=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}};var ze=new te(t=>t.complete());function Fg(t){return t&&B(t.schedule)}function Ug(t){return t[t.length-1]}function Hg(t){return B(Ug(t))?t.pop():void 0}function Vn(t){return Fg(Ug(t))?t.pop():void 0}function jg(t,e,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(h){s(h)}}function c(u){try{l(r.throw(u))}catch(h){s(h)}}function l(u){u.done?i(u.value):o(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function Bg(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function br(t){return this instanceof br?(this.v=t,this):new br(t)}function Vg(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),o,i=[];return o={},a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(y){return function(I){return Promise.resolve(I).then(y,h)}}function a(y,I){r[y]&&(o[y]=function(T){return new Promise(function(b,_){i.push([y,T,b,_])>1||c(y,T)})},I&&(o[y]=I(o[y])))}function c(y,I){try{l(r[y](I))}catch(T){g(i[0][3],T)}}function l(y){y.value instanceof br?Promise.resolve(y.value.v).then(u,h):g(i[0][2],y)}function u(y){c("next",y)}function h(y){c("throw",y)}function g(y,I){y(I),i.shift(),i.length&&c(i[0][0],i[0][1])}}function $g(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Bg=="function"?Bg(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(s){return new Promise(function(a,c){s=t[i](s),o(a,c,s.done,s.value)})}}function o(i,s,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},s)}}var Ic=t=>t&&typeof t.length=="number"&&typeof t!="function";function Tc(t){return B(t?.then)}function wc(t){return B(t[Uo])}function Ac(t){return Symbol.asyncIterator&&B(t?.[Symbol.asyncIterator])}function Sc(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function II(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Dc=II();function bc(t){return B(t?.[Dc])}function _c(t){return Vg(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:o}=yield br(n.read());if(o)return yield br(void 0);yield yield br(r)}}finally{n.releaseLock()}})}function Rc(t){return B(t?.getReader)}function Pe(t){if(t instanceof te)return t;if(t!=null){if(wc(t))return TI(t);if(Ic(t))return wI(t);if(Tc(t))return AI(t);if(Ac(t))return Gg(t);if(bc(t))return SI(t);if(Rc(t))return DI(t)}throw Sc(t)}function TI(t){return new te(e=>{let n=t[Uo]();if(B(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function wI(t){return new te(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function AI(t){return new te(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,vc)})}function SI(t){return new te(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Gg(t){return new te(e=>{bI(t,e).catch(n=>e.error(n))})}function DI(t){return Gg(_c(t))}function bI(t,e){var n,r,o,i;return jg(this,void 0,void 0,function*(){try{for(n=$g(t);r=yield n.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=n.return)&&(yield i.call(n))}finally{if(o)throw o.error}}e.complete()})}function et(t,e,n,r=0,o=!1){let i=e.schedule(function(){n(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(i),!o)return i}function Mc(t,e=0){return W((n,r)=>{n.subscribe(Y(r,o=>et(r,t,()=>r.next(o),e),()=>et(r,t,()=>r.complete(),e),o=>et(r,t,()=>r.error(o),e)))})}function Nc(t,e=0){return W((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function qg(t,e){return Pe(t).pipe(Nc(e),Mc(e))}function zg(t,e){return Pe(t).pipe(Nc(e),Mc(e))}function Kg(t,e){return new te(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Wg(t,e){return new te(n=>{let r;return et(n,e,()=>{r=t[Dc](),et(n,e,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){n.error(s);return}i?n.complete():n.next(o)},0,!0)}),()=>B(r?.return)&&r.return()})}function kc(t,e){if(!t)throw new Error("Iterable cannot be null");return new te(n=>{et(n,e,()=>{let r=t[Symbol.asyncIterator]();et(n,e,()=>{r.next().then(o=>{o.done?n.complete():n.next(o.value)})},0,!0)})})}function Yg(t,e){return kc(_c(t),e)}function Qg(t,e){if(t!=null){if(wc(t))return qg(t,e);if(Ic(t))return Kg(t,e);if(Tc(t))return zg(t,e);if(Ac(t))return kc(t,e);if(bc(t))return Wg(t,e);if(Rc(t))return Yg(t,e)}throw Sc(t)}function X(t,e){return e?Qg(t,e):Pe(t)}function M(...t){let e=Vn(t);return X(t,e)}function jo(t,e){let n=B(t)?t:()=>t,r=o=>o.error(n());return new te(e?o=>e.schedule(r,0,o):r)}function yd(t){return!!t&&(t instanceof te||B(t.lift)&&B(t.subscribe))}var yn=Po(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return W((n,r)=>{let o=0;n.subscribe(Y(r,i=>{r.next(t.call(e,i,o++))}))})}var{isArray:_I}=Array;function RI(t,e){return _I(e)?t(...e):t(e)}function Jg(t){return j(e=>RI(t,e))}var{isArray:MI}=Array,{getPrototypeOf:NI,prototype:kI,keys:OI}=Object;function Zg(t){if(t.length===1){let e=t[0];if(MI(e))return{args:e,keys:null};if(PI(e)){let n=OI(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function PI(t){return t&&typeof t=="object"&&NI(t)===kI}function Xg(t,e){return t.reduce((n,r,o)=>(n[r]=e[o],n),{})}function Oc(...t){let e=Vn(t),n=Hg(t),{args:r,keys:o}=Zg(t);if(r.length===0)return X([],e);let i=new te(xI(r,e,o?s=>Xg(o,s):ct));return n?i.pipe(Jg(n)):i}function xI(t,e,n=ct){return r=>{em(e,()=>{let{length:o}=t,i=new Array(o),s=o,a=o;for(let c=0;c<o;c++)em(e,()=>{let l=X(t[c],e),u=!1;l.subscribe(Y(r,h=>{i[c]=h,u||(u=!0,a--),a||r.next(n(i.slice()))},()=>{--s||r.complete()}))},r)},r)}}function em(t,e,n){t?et(n,t,e):e()}function tm(t,e,n,r,o,i,s,a){let c=[],l=0,u=0,h=!1,g=()=>{h&&!c.length&&!l&&e.complete()},y=T=>l<r?I(T):c.push(T),I=T=>{i&&e.next(T),l++;let b=!1;Pe(n(T,u++)).subscribe(Y(e,_=>{o?.(_),i?y(_):e.next(_)},()=>{b=!0},void 0,()=>{if(b)try{for(l--;c.length&&l<r;){let _=c.shift();s?et(e,s,()=>I(_)):I(_)}g()}catch(_){e.error(_)}}))};return t.subscribe(Y(e,y,()=>{h=!0,g()})),()=>{a?.()}}function be(t,e,n=1/0){return B(e)?be((r,o)=>j((i,s)=>e(r,i,o,s))(Pe(t(r,o))),n):(typeof e=="number"&&(n=e),W((r,o)=>tm(r,o,t,n)))}function vd(t=1/0){return be(ct,t)}function nm(){return vd(1)}function Vo(...t){return nm()(X(t,Vn(t)))}function Pc(t){return new te(e=>{Pe(t()).subscribe(e)})}function ve(t,e){return W((n,r)=>{let o=0;n.subscribe(Y(r,i=>t.call(e,i,o++)&&r.next(i)))})}function Mt(t){return W((e,n)=>{let r=null,o=!1,i;r=e.subscribe(Y(n,void 0,void 0,s=>{i=Pe(t(s,Mt(t)(e))),r?(r.unsubscribe(),r=null,i.subscribe(n)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(n))})}function rm(t,e,n,r,o){return(i,s)=>{let a=n,c=e,l=0;i.subscribe(Y(s,u=>{let h=l++;c=a?t(c,u,h):(a=!0,u),r&&s.next(c)},o&&(()=>{a&&s.next(c),s.complete()})))}}function Nt(t,e){return B(e)?be(t,e,1):be(t,1)}function $n(t){return W((e,n)=>{let r=!1;e.subscribe(Y(n,o=>{r=!0,n.next(o)},()=>{r||n.next(t),n.complete()}))})}function lt(t){return t<=0?()=>ze:W((e,n)=>{let r=0;e.subscribe(Y(n,o=>{++r<=t&&(n.next(o),t<=r&&n.complete())}))})}function Cd(t){return j(()=>t)}function xc(t=LI){return W((e,n)=>{let r=!1;e.subscribe(Y(n,o=>{r=!0,n.next(o)},()=>r?n.complete():n.error(t())))})}function LI(){return new yn}function Gn(t){return W((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function qt(t,e){let n=arguments.length>=2;return r=>r.pipe(t?ve((o,i)=>t(o,i,r)):ct,lt(1),n?$n(e):xc(()=>new yn))}function $o(t){return t<=0?()=>ze:W((e,n)=>{let r=[];e.subscribe(Y(n,o=>{r.push(o),t<r.length&&r.shift()},()=>{for(let o of r)n.next(o);n.complete()},void 0,()=>{r=null}))})}function Ed(t,e){let n=arguments.length>=2;return r=>r.pipe(t?ve((o,i)=>t(o,i,r)):ct,$o(1),n?$n(e):xc(()=>new yn))}function Id(t,e){return W(rm(t,e,arguments.length>=2,!0))}function Td(...t){let e=Vn(t);return W((n,r)=>{(e?Vo(t,n,e):Vo(t,n)).subscribe(r)})}function _e(t,e){return W((n,r)=>{let o=null,i=0,s=!1,a=()=>s&&!o&&r.complete();n.subscribe(Y(r,c=>{o?.unsubscribe();let l=0,u=i++;Pe(t(c,u)).subscribe(o=Y(r,h=>r.next(e?e(c,h,u,l++):h),()=>{o=null,a()}))},()=>{s=!0,a()}))})}function fs(t){return W((e,n)=>{Pe(t).subscribe(Y(n,()=>n.complete(),ds)),!n.closed&&e.subscribe(n)})}function xe(t,e,n){let r=B(t)||e||n?{next:t,error:e,complete:n}:t;return r?W((o,i)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;o.subscribe(Y(i,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),i.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),i.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),i.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):ct}var x=class extends Error{constructor(e,n){super(ol(e,n)),this.code=e}};function ol(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function il(t){return{toString:t}.toString()}var ps=globalThis;function le(t){for(let e in t)if(t[e]===le)return e;throw Error("Could not find renamed property on target object.")}function tt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(tt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function om(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var FI=le({__forward_ref__:le});function xm(t){return t.__forward_ref__=xm,t.toString=function(){return tt(this())},t}function It(t){return Lm(t)?t():t}function Lm(t){return typeof t=="function"&&t.hasOwnProperty(FI)&&t.__forward_ref__===xm}function k(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function xr(t){return{providers:t.providers||[],imports:t.imports||[]}}function sl(t){return im(t,Um)||im(t,Hm)}function Fm(t){return sl(t)!==null}function im(t,e){return t.hasOwnProperty(e)?t[e]:null}function UI(t){let e=t&&(t[Um]||t[Hm]);return e||null}function sm(t){return t&&(t.hasOwnProperty(am)||t.hasOwnProperty(HI))?t[am]:null}var Um=le({\u0275prov:le}),am=le({\u0275inj:le}),Hm=le({ngInjectableDef:le}),HI=le({ngInjectorDef:le}),O=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=k({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Bm(t){return t&&!!t.\u0275providers}var BI=le({\u0275cmp:le}),jI=le({\u0275dir:le}),VI=le({\u0275pipe:le}),$I=le({\u0275mod:le}),jc=le({\u0275fac:le}),gs=le({__NG_ELEMENT_ID__:le}),cm=le({__NG_ENV_ID__:le});function jm(t){return typeof t=="string"?t:t==null?"":String(t)}function GI(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():jm(t)}function qI(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new x(-200,t)}function dh(t,e){throw new x(-201,!1)}var q=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(q||{}),Od;function Vm(){return Od}function Et(t){let e=Od;return Od=t,e}function $m(t,e,n){let r=sl(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&q.Optional)return null;if(e!==void 0)return e;dh(t,"Injector")}var zI={},ms=zI,KI="__NG_DI_FLAG__",Vc="ngTempTokenPath",WI="ngTokenPath",YI=/\n/gm,QI="\u0275",lm="__source",Ko;function JI(){return Ko}function qn(t){let e=Ko;return Ko=t,e}function ZI(t,e=q.Default){if(Ko===void 0)throw new x(-203,!1);return Ko===null?$m(t,void 0,e):Ko.get(t,e&q.Optional?null:void 0,e)}function R(t,e=q.Default){return(Vm()||ZI)(It(t),e)}function D(t,e=q.Default){return R(t,al(e))}function al(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Pd(t){let e=[];for(let n=0;n<t.length;n++){let r=It(t[n]);if(Array.isArray(r)){if(r.length===0)throw new x(900,!1);let o,i=q.Default;for(let s=0;s<r.length;s++){let a=r[s],c=XI(a);typeof c=="number"?c===-1?o=a.token:i|=c:o=a}e.push(R(o,i))}else e.push(R(r))}return e}function XI(t){return t[KI]}function eT(t,e,n,r){let o=t[Vc];throw e[lm]&&o.unshift(e[lm]),t.message=tT(`
`+t.message,o,n,r),t[WI]=o,t[Vc]=null,t}function tT(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==QI?t.slice(2):t;let o=tt(e);if(Array.isArray(e))o=e.map(tt).join(" -> ");else if(typeof e=="object"){let i=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];i.push(s+":"+(typeof a=="string"?JSON.stringify(a):tt(a)))}o=`{${i.join(", ")}}`}return`${n}${r?"("+r+")":""}[${o}]: ${t.replace(YI,`
  `)}`}function Qo(t,e){let n=t.hasOwnProperty(jc);return n?t[jc]:null}function hh(t,e){t.forEach(n=>Array.isArray(n)?hh(n,e):e(n))}function Gm(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function $c(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}var ys={},zt=[],Jo=new O(""),qm=new O("",-1),zm=new O(""),Gc=class{get(e,n=ms){if(n===ms){let r=new Error(`NullInjectorError: No provider for ${tt(e)}!`);throw r.name="NullInjectorError",r}return n}},Km=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Km||{}),Yt=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Yt||{}),Kn=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Kn||{});function nT(t,e,n){let r=t.length;for(;;){let o=t.indexOf(e,n);if(o===-1)return o;if(o===0||t.charCodeAt(o-1)<=32){let i=e.length;if(o+i===r||t.charCodeAt(o+i)<=32)return o}n=o+1}}function xd(t,e,n){let r=0;for(;r<n.length;){let o=n[r];if(typeof o=="number"){if(o!==0)break;r++;let i=n[r++],s=n[r++],a=n[r++];t.setAttribute(e,s,a,i)}else{let i=o,s=n[++r];oT(i)?t.setProperty(e,i,s):t.setAttribute(e,i,s),r++}}return r}function rT(t){return t===3||t===4||t===6}function oT(t){return t.charCodeAt(0)===64}function fh(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let o=e[r];typeof o=="number"?n=o:n===0||(n===-1||n===2?um(t,n,o,null,e[++r]):um(t,n,o,null,null))}}return t}function um(t,e,n,r,o){let i=0,s=t.length;if(e===-1)s=-1;else for(;i<t.length;){let a=t[i++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=i-1;break}}}for(;i<t.length;){let a=t[i];if(typeof a=="number")break;if(a===n){if(r===null){o!==null&&(t[i+1]=o);return}else if(r===t[i+1]){t[i+2]=o;return}}i++,r!==null&&i++,o!==null&&i++}s!==-1&&(t.splice(s,0,e),i=s+1),t.splice(i++,0,n),r!==null&&t.splice(i++,0,r),o!==null&&t.splice(i++,0,o)}var Wm="ng-template";function iT(t,e,n,r){let o=0;if(r){for(;o<e.length&&typeof e[o]=="string";o+=2)if(e[o]==="class"&&nT(e[o+1].toLowerCase(),n,0)!==-1)return!0}else if(ph(t))return!1;if(o=e.indexOf(1,o),o>-1){let i;for(;++o<e.length&&typeof(i=e[o])=="string";)if(i.toLowerCase()===n)return!0}return!1}function ph(t){return t.type===4&&t.value!==Wm}function sT(t,e,n){let r=t.type===4&&!n?Wm:t.value;return e===r}function aT(t,e,n){let r=4,o=t.attrs,i=o!==null?uT(o):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!kt(r)&&!kt(c))return!1;if(s&&kt(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!sT(t,c,n)||c===""&&e.length===1){if(kt(r))return!1;s=!0}}else if(r&8){if(o===null||!iT(t,o,c,n)){if(kt(r))return!1;s=!0}}else{let l=e[++a],u=cT(c,o,ph(t),n);if(u===-1){if(kt(r))return!1;s=!0;continue}if(l!==""){let h;if(u>i?h="":h=o[u+1].toLowerCase(),r&2&&l!==h){if(kt(r))return!1;s=!0}}}}return kt(r)||s}function kt(t){return(t&1)===0}function cT(t,e,n,r){if(e===null)return-1;let o=0;if(r||!n){let i=!1;for(;o<e.length;){let s=e[o];if(s===t)return o;if(s===3||s===6)i=!0;else if(s===1||s===2){let a=e[++o];for(;typeof a=="string";)a=e[++o];continue}else{if(s===4)break;if(s===0){o+=4;continue}}o+=i?1:2}return-1}else return dT(e,t)}function lT(t,e,n=!1){for(let r=0;r<e.length;r++)if(aT(t,e[r],n))return!0;return!1}function uT(t){for(let e=0;e<t.length;e++){let n=t[e];if(rT(n))return e}return t.length}function dT(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function dm(t,e){return t?":not("+e.trim()+")":e}function hT(t){let e=t[0],n=1,r=2,o="",i=!1;for(;n<t.length;){let s=t[n];if(typeof s=="string")if(r&2){let a=t[++n];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+s:r&4&&(o+=" "+s);else o!==""&&!kt(s)&&(e+=dm(i,o),o=""),r=s,i=i||!kt(r);n++}return o!==""&&(e+=dm(i,o)),e}function fT(t){return t.map(hT).join(",")}function pT(t){let e=[],n=[],r=1,o=2;for(;r<t.length;){let i=t[r];if(typeof i=="string")o===2?i!==""&&e.push(i,t[++r]):o===8&&n.push(i);else{if(!kt(o))break;o=i}r++}return{attrs:e,classes:n}}function xt(t){return il(()=>{let e=Xm(t),n=S(m({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Km.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Yt.Emulated,styles:t.styles||zt,_:null,schemas:t.schemas||null,tView:null,id:""});ey(n);let r=t.dependencies;return n.directiveDefs=fm(r,!1),n.pipeDefs=fm(r,!0),n.id=yT(n),n})}function gT(t){return Rr(t)||Ym(t)}function mT(t){return t!==null}function Lr(t){return il(()=>({type:t.type,bootstrap:t.bootstrap||zt,declarations:t.declarations||zt,imports:t.imports||zt,exports:t.exports||zt,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function hm(t,e){if(t==null)return ys;let n={};for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],i,s,a=Kn.None;Array.isArray(o)?(a=o[0],i=o[1],s=o[2]??i):(i=o,s=o),e?(n[i]=a!==Kn.None?[r,a]:r,e[i]=s):n[i]=r}return n}function cl(t){return il(()=>{let e=Xm(t);return ey(e),e})}function Rr(t){return t[BI]||null}function Ym(t){return t[jI]||null}function Qm(t){return t[VI]||null}function Jm(t){let e=Rr(t)||Ym(t)||Qm(t);return e!==null?e.standalone:!1}function Zm(t,e){let n=t[$I]||null;if(!n&&e===!0)throw new Error(`Type ${tt(t)} does not have '\u0275mod' property.`);return n}function Xm(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||ys,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||zt,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:hm(t.inputs,e),outputs:hm(t.outputs),debugInfo:null}}function ey(t){t.features?.forEach(e=>e(t))}function fm(t,e){if(!t)return null;let n=e?Qm:gT;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(mT)}function yT(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let o of n)e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function ei(t){return{\u0275providers:t}}function vT(...t){return{\u0275providers:ty(!0,t),\u0275fromNgModule:!0}}function ty(t,...e){let n=[],r=new Set,o,i=s=>{n.push(s)};return hh(e,s=>{let a=s;Ld(a,i,[],r)&&(o||=[],o.push(a))}),o!==void 0&&ny(o,i),n}function ny(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:o}=t[n];gh(o,i=>{e(i,r)})}}function Ld(t,e,n,r){if(t=It(t),!t)return!1;let o=null,i=sm(t),s=!i&&Rr(t);if(!i&&!s){let c=t.ngModule;if(i=sm(c),i)o=c;else return!1}else{if(s&&!s.standalone)return!1;o=t}let a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Ld(l,e,n,r)}}else if(i){if(i.imports!=null&&!a){r.add(o);let l;try{hh(i.imports,u=>{Ld(u,e,n,r)&&(l||=[],l.push(u))})}finally{}l!==void 0&&ny(l,e)}if(!a){let l=Qo(o)||(()=>new o);e({provide:o,useFactory:l,deps:zt},o),e({provide:zm,useValue:o,multi:!0},o),e({provide:Jo,useValue:()=>R(o),multi:!0},o)}let c=i.providers;if(c!=null&&!a){let l=t;gh(c,u=>{e(u,l)})}}else return!1;return o!==t&&t.providers!==void 0}function gh(t,e){for(let n of t)Bm(n)&&(n=n.\u0275providers),Array.isArray(n)?gh(n,e):e(n)}var CT=le({provide:String,useValue:le});function ry(t){return t!==null&&typeof t=="object"&&CT in t}function ET(t){return!!(t&&t.useExisting)}function IT(t){return!!(t&&t.useFactory)}function Fd(t){return typeof t=="function"}var ll=new O(""),Lc={},TT={},wd;function mh(){return wd===void 0&&(wd=new Gc),wd}var nt=class{},vs=class extends nt{get destroyed(){return this._destroyed}constructor(e,n,r,o){super(),this.parent=n,this.source=r,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Hd(e,s=>this.processProvider(s)),this.records.set(qm,Go(void 0,this)),o.has("environment")&&this.records.set(nt,Go(void 0,this));let i=this.records.get(ll);i!=null&&typeof i.value=="string"&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(zm,zt,q.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Z(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Z(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=qn(this),r=Et(void 0),o;try{return e()}finally{qn(n),Et(r)}}get(e,n=ms,r=q.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(cm))return e[cm](this);r=al(r);let o,i=qn(this),s=Et(void 0);try{if(!(r&q.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=_T(e)&&sl(e);l&&this.injectableDefInScope(l)?c=Go(Ud(e),Lc):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&q.Self?mh():this.parent;return n=r&q.Optional&&n===ms?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[Vc]=a[Vc]||[]).unshift(tt(e)),i)throw a;return eT(a,e,"R3InjectorError",this.source)}else throw a}finally{Et(s),qn(i)}}resolveInjectorInitializers(){let e=Z(null),n=qn(this),r=Et(void 0),o;try{let i=this.get(Jo,zt,q.Self);for(let s of i)s()}finally{qn(n),Et(r),Z(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(tt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new x(205,!1)}processProvider(e){e=It(e);let n=Fd(e)?e:It(e&&e.provide),r=AT(e);if(!Fd(e)&&e.multi===!0){let o=this.records.get(n);o||(o=Go(void 0,Lc,!0),o.factory=()=>Pd(o.multi),this.records.set(n,o)),n=e,o.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=Z(null);try{return n.value===Lc&&(n.value=TT,n.value=n.factory()),typeof n.value=="object"&&n.value&&bT(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Z(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=It(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Ud(t){let e=sl(t),n=e!==null?e.factory:Qo(t);if(n!==null)return n;if(t instanceof O)throw new x(204,!1);if(t instanceof Function)return wT(t);throw new x(204,!1)}function wT(t){if(t.length>0)throw new x(204,!1);let n=UI(t);return n!==null?()=>n.factory(t):()=>new t}function AT(t){if(ry(t))return Go(void 0,t.useValue);{let e=ST(t);return Go(e,Lc)}}function ST(t,e,n){let r;if(Fd(t)){let o=It(t);return Qo(o)||Ud(o)}else if(ry(t))r=()=>It(t.useValue);else if(IT(t))r=()=>t.useFactory(...Pd(t.deps||[]));else if(ET(t))r=()=>R(It(t.useExisting));else{let o=It(t&&(t.useClass||t.provide));if(DT(t))r=()=>new o(...Pd(t.deps));else return Qo(o)||Ud(o)}return r}function Go(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function DT(t){return!!t.deps}function bT(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function _T(t){return typeof t=="function"||typeof t=="object"&&t instanceof O}function Hd(t,e){for(let n of t)Array.isArray(n)?Hd(n,e):n&&Bm(n)?Hd(n.\u0275providers,e):e(n)}function Cn(t,e){t instanceof vs&&t.assertNotDestroyed();let n,r=qn(t),o=Et(void 0);try{return e()}finally{qn(r),Et(o)}}function RT(){return Vm()!==void 0||JI()!=null}function MT(t){return typeof t=="function"}var En=0,K=1,L=2,Ve=3,Pt=4,Lt=5,qc=6,Cs=7,Tt=8,Zo=9,Qt=10,rt=11,Es=12,pm=13,ti=14,Jt=15,ul=16,qo=17,Xo=18,dl=19,oy=20,zn=21,Ad=22,Mr=23,Zt=25,iy=1;var Nr=7,zc=8,Kc=9,ut=10,yh=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(yh||{});function Wo(t){return Array.isArray(t)&&typeof t[iy]=="object"}function In(t){return Array.isArray(t)&&t[iy]===!0}function sy(t){return(t.flags&4)!==0}function hl(t){return t.componentOffset>-1}function vh(t){return(t.flags&1)===1}function _s(t){return!!t.template}function NT(t){return(t[L]&512)!==0}var Bd=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function ay(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function fl(){return cy}function cy(t){return t.type.prototype.ngOnChanges&&(t.setInput=OT),kT}fl.ngInherit=!0;function kT(){let t=uy(this),e=t?.current;if(e){let n=t.previous;if(n===ys)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function OT(t,e,n,r,o){let i=this.declaredInputs[r],s=uy(t)||PT(t,{previous:ys,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[i];a[i]=new Bd(l&&l.currentValue,n,c===ys),ay(t,e,o,n)}var ly="__ngSimpleChanges__";function uy(t){return t[ly]||null}function PT(t,e){return t[ly]=e}var gm=null;var Kt=function(t,e,n){gm?.(t,e,n)},xT="svg",LT="math",FT=!1;function UT(){return FT}function Xt(t){for(;Array.isArray(t);)t=t[En];return t}function HT(t,e){return Xt(e[t])}function Ft(t,e){return Xt(e[t.index])}function Ch(t,e){return t.data[e]}function Fr(t,e){let n=e[t];return Wo(n)?n:n[En]}function Eh(t){return(t[L]&128)===128}function BT(t){return In(t[Ve])}function Wc(t,e){return e==null?null:t[e]}function dy(t){t[qo]=0}function jT(t){t[L]&1024||(t[L]|=1024,Eh(t)&&Is(t))}function VT(t,e){for(;t>0;)e=e[ti],t--;return e}function Ih(t){return!!(t[L]&9216||t[Mr]?.dirty)}function jd(t){t[Qt].changeDetectionScheduler?.notify(1),Ih(t)?Is(t):t[L]&64&&(UT()?(t[L]|=1024,Is(t)):t[Qt].changeDetectionScheduler?.notify())}function Is(t){t[Qt].changeDetectionScheduler?.notify();let e=Ts(t);for(;e!==null&&!(e[L]&8192||(e[L]|=8192,!Eh(e)));)e=Ts(e)}function hy(t,e){if((t[L]&256)===256)throw new x(911,!1);t[zn]===null&&(t[zn]=[]),t[zn].push(e)}function $T(t,e){if(t[zn]===null)return;let n=t[zn].indexOf(e);n!==-1&&t[zn].splice(n,1)}function Ts(t){let e=t[Ve];return In(e)?e[Ve]:e}var Q={lFrame:Cy(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function GT(){return Q.lFrame.elementDepthCount}function qT(){Q.lFrame.elementDepthCount++}function zT(){Q.lFrame.elementDepthCount--}function fy(){return Q.bindingsEnabled}function KT(){return Q.skipHydrationRootTNode!==null}function WT(t){return Q.skipHydrationRootTNode===t}function YT(){Q.skipHydrationRootTNode=null}function Re(){return Q.lFrame.lView}function Ur(){return Q.lFrame.tView}function Th(t){return Q.lFrame.contextLView=t,t[Tt]}function wh(t){return Q.lFrame.contextLView=null,t}function en(){let t=py();for(;t!==null&&t.type===64;)t=t.parent;return t}function py(){return Q.lFrame.currentTNode}function QT(){let t=Q.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Rs(t,e){let n=Q.lFrame;n.currentTNode=t,n.isParent=e}function gy(){return Q.lFrame.isParent}function JT(){Q.lFrame.isParent=!1}function ZT(t){return Q.lFrame.bindingIndex=t}function Ah(){return Q.lFrame.bindingIndex++}function XT(){return Q.lFrame.inI18n}function ew(t,e){let n=Q.lFrame;n.bindingIndex=n.bindingRootIndex=t,Vd(e)}function tw(){return Q.lFrame.currentDirectiveIndex}function Vd(t){Q.lFrame.currentDirectiveIndex=t}function my(t){Q.lFrame.currentQueryIndex=t}function nw(t){let e=t[K];return e.type===2?e.declTNode:e.type===1?t[Lt]:null}function yy(t,e,n){if(n&q.SkipSelf){let o=e,i=t;for(;o=o.parent,o===null&&!(n&q.Host);)if(o=nw(i),o===null||(i=i[ti],o.type&10))break;if(o===null)return!1;e=o,t=i}let r=Q.lFrame=vy();return r.currentTNode=e,r.lView=t,!0}function Sh(t){let e=vy(),n=t[K];Q.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function vy(){let t=Q.lFrame,e=t===null?null:t.child;return e===null?Cy(t):e}function Cy(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function Ey(){let t=Q.lFrame;return Q.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var Iy=Ey;function Dh(){let t=Ey();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function rw(t){return(Q.lFrame.contextLView=VT(t,Q.lFrame.contextLView))[Tt]}function bh(){return Q.lFrame.selectedIndex}function kr(t){Q.lFrame.selectedIndex=t}function ow(){let t=Q.lFrame;return Ch(t.tView,t.selectedIndex)}function iw(){return Q.lFrame.currentNamespace}var Ty=!0;function _h(){return Ty}function Rh(t){Ty=t}function sw(t,e,n){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=e.type.prototype;if(r){let s=cy(e);(n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s)}o&&(n.preOrderHooks??=[]).push(0-t,o),i&&((n.preOrderHooks??=[]).push(t,i),(n.preOrderCheckHooks??=[]).push(t,i))}function Mh(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let i=t.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=i;s&&(t.contentHooks??=[]).push(-n,s),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function Fc(t,e,n){wy(t,e,3,n)}function Uc(t,e,n,r){(t[L]&3)===n&&wy(t,e,n,r)}function Sd(t,e){let n=t[L];(n&3)===e&&(n&=16383,n+=1,t[L]=n)}function wy(t,e,n,r){let o=r!==void 0?t[qo]&65535:0,i=r??-1,s=e.length-1,a=0;for(let c=o;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[qo]+=65536),(a<i||i==-1)&&(aw(t,n,e,c),t[qo]=(t[qo]&4294901760)+c+2),c++}function mm(t,e){Kt(4,t,e);let n=Z(null);try{e.call(t)}finally{Z(n),Kt(5,t,e)}}function aw(t,e,n,r){let o=n[r]<0,i=n[r+1],s=o?-n[r]:n[r],a=t[s];o?t[L]>>14<t[qo]>>16&&(t[L]&3)===e&&(t[L]+=16384,mm(a,i)):mm(a,i)}var Yo=-1,ws=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function cw(t){return t instanceof ws}function lw(t){return(t.flags&8)!==0}function uw(t){return(t.flags&16)!==0}function Ay(t){return t!==Yo}function Yc(t){return t&32767}function dw(t){return t>>16}function Qc(t,e){let n=dw(t),r=e;for(;n>0;)r=r[ti],n--;return r}var $d=!0;function ym(t){let e=$d;return $d=t,e}var hw=256,Sy=hw-1,Dy=5,fw=0,Wt={};function pw(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(gs)&&(r=n[gs]),r==null&&(r=n[gs]=fw++);let o=r&Sy,i=1<<o;e.data[t+(o>>Dy)]|=i}function by(t,e){let n=_y(t,e);if(n!==-1)return n;let r=e[K];r.firstCreatePass&&(t.injectorIndex=e.length,Dd(r.data,t),Dd(e,null),Dd(r.blueprint,null));let o=Nh(t,e),i=t.injectorIndex;if(Ay(o)){let s=Yc(o),a=Qc(o,e),c=a[K].data;for(let l=0;l<8;l++)e[i+l]=a[s+l]|c[s+l]}return e[i+8]=o,i}function Dd(t,e){t.push(0,0,0,0,0,0,0,0,e)}function _y(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function Nh(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,o=e;for(;o!==null;){if(r=Oy(o),r===null)return Yo;if(n++,o=o[ti],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Yo}function gw(t,e,n){pw(t,e,n)}function Ry(t,e,n){if(n&q.Optional||t!==void 0)return t;dh(e,"NodeInjector")}function My(t,e,n,r){if(n&q.Optional&&r===void 0&&(r=null),!(n&(q.Self|q.Host))){let o=t[Zo],i=Et(void 0);try{return o?o.get(e,r,n&q.Optional):$m(e,r,n&q.Optional)}finally{Et(i)}}return Ry(r,e,n)}function Ny(t,e,n,r=q.Default,o){if(t!==null){if(e[L]&2048&&!(r&q.Self)){let s=Ew(t,e,n,r,Wt);if(s!==Wt)return s}let i=ky(t,e,n,r,Wt);if(i!==Wt)return i}return My(e,n,r,o)}function ky(t,e,n,r,o){let i=vw(n);if(typeof i=="function"){if(!yy(e,t,r))return r&q.Host?Ry(o,n,r):My(e,n,r,o);try{let s;if(s=i(r),s==null&&!(r&q.Optional))dh(n);else return s}finally{Iy()}}else if(typeof i=="number"){let s=null,a=_y(t,e),c=Yo,l=r&q.Host?e[Jt][Lt]:null;for((a===-1||r&q.SkipSelf)&&(c=a===-1?Nh(t,e):e[a+8],c===Yo||!Cm(r,!1)?a=-1:(s=e[K],a=Yc(c),e=Qc(c,e)));a!==-1;){let u=e[K];if(vm(i,a,u.data)){let h=mw(a,e,n,s,r,l);if(h!==Wt)return h}c=e[a+8],c!==Yo&&Cm(r,e[K].data[a+8]===l)&&vm(i,a,e)?(s=u,a=Yc(c),e=Qc(c,e)):a=-1}}return o}function mw(t,e,n,r,o,i){let s=e[K],a=s.data[t+8],c=r==null?hl(a)&&$d:r!=s&&(a.type&3)!==0,l=o&q.Host&&i===a,u=yw(a,s,n,c,l);return u!==null?As(e,s,u,a):Wt}function yw(t,e,n,r,o){let i=t.providerIndexes,s=e.data,a=i&1048575,c=t.directiveStart,l=t.directiveEnd,u=i>>20,h=r?a:a+u,g=o?a+u:l;for(let y=h;y<g;y++){let I=s[y];if(y<c&&n===I||y>=c&&I.type===n)return y}if(o){let y=s[c];if(y&&_s(y)&&y.type===n)return c}return null}function As(t,e,n,r){let o=t[n],i=e.data;if(cw(o)){let s=o;s.resolving&&qI(GI(i[n]));let a=ym(s.canSeeViewProviders);s.resolving=!0;let c,l=s.injectImpl?Et(s.injectImpl):null,u=yy(t,r,q.Default);try{o=t[n]=s.factory(void 0,i,t,r),e.firstCreatePass&&n>=r.directiveStart&&sw(n,i[n],e)}finally{l!==null&&Et(l),ym(a),s.resolving=!1,Iy()}}return o}function vw(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(gs)?t[gs]:void 0;return typeof e=="number"?e>=0?e&Sy:Cw:e}function vm(t,e,n){let r=1<<t;return!!(n[e+(t>>Dy)]&r)}function Cm(t,e){return!(t&q.Self)&&!(t&q.Host&&e)}var _r=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return Ny(this._tNode,this._lView,e,al(r),n)}};function Cw(){return new _r(en(),Re())}function kh(t){return il(()=>{let e=t.prototype.constructor,n=e[jc]||Gd(e),r=Object.prototype,o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==r;){let i=o[jc]||Gd(o);if(i&&i!==n)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function Gd(t){return Lm(t)?()=>{let e=Gd(It(t));return e&&e()}:Qo(t)}function Ew(t,e,n,r,o){let i=t,s=e;for(;i!==null&&s!==null&&s[L]&2048&&!(s[L]&512);){let a=ky(i,s,n,r|q.Self,Wt);if(a!==Wt)return a;let c=i.parent;if(!c){let l=s[oy];if(l){let u=l.get(n,Wt,r);if(u!==Wt)return u}c=Oy(s),s=s[ti]}i=c}return o}function Oy(t){let e=t[K],n=e.type;return n===2?e.declTNode:n===1?t[Lt]:null}function Em(t,e=null,n=null,r){let o=Py(t,e,n,r);return o.resolveInjectorInitializers(),o}function Py(t,e=null,n=null,r,o=new Set){let i=[n||zt,vT(t)];return r=r||(typeof t=="object"?void 0:tt(t)),new vs(i,e||mh(),r||null,o)}var Ms=(()=>{let e=class e{static create(r,o){if(Array.isArray(r))return Em({name:""},o,r,"");{let i=r.name??"";return Em({name:i},r.parent,r.providers,i)}}};e.THROW_IF_NOT_FOUND=ms,e.NULL=new Gc,e.\u0275prov=k({token:e,providedIn:"any",factory:()=>R(qm)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var Iw="ngOriginalError";function bd(t){return t[Iw]}var vn=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&bd(e);for(;n&&bd(n);)n=bd(n);return n||null}},xy=new O("",{providedIn:"root",factory:()=>D(vn).handleError.bind(void 0)}),Ly=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Tw,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),qd=class extends Ly{constructor(e){super(),this._lView=e}onDestroy(e){return hy(this._lView,e),()=>$T(this._lView,e)}};function Tw(){return new qd(Re())}function ww(){return pl(en(),Re())}function pl(t,e){return new gl(Ft(t,e))}var gl=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=ww;let t=e;return t})();var zd=class extends Ie{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,RT()&&(this.destroyRef=D(Ly,{optional:!0})??void 0)}emit(e){let n=Z(null);try{super.next(e)}finally{Z(n)}}subscribe(e,n,r){let o=e,i=n||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;o=c.next?.bind(c),i=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(i=_d(i),o&&(o=_d(o)),s&&(s=_d(s)));let a=super.subscribe({next:o,error:i,complete:s});return e instanceof Se&&e.add(a),a}};function _d(t){return e=>{setTimeout(t,void 0,e)}}var Ot=zd;function Fy(t){return(t.flags&128)===128}var Uy=new Map,Aw=0;function Sw(){return Aw++}function Dw(t){Uy.set(t[dl],t)}function bw(t){Uy.delete(t[dl])}var Im="__ngContext__";function Or(t,e){Wo(e)?(t[Im]=e[dl],Dw(e)):t[Im]=e}function Hy(t){return jy(t[Es])}function By(t){return jy(t[Pt])}function jy(t){for(;t!==null&&!In(t);)t=t[Pt];return t}var Kd;function Vy(t){Kd=t}function _w(){if(Kd!==void 0)return Kd;if(typeof document<"u")return document;throw new x(210,!1)}var Oh=new O("",{providedIn:"root",factory:()=>Rw}),Rw="ng",Ph=new O(""),Yn=new O("",{providedIn:"platform",factory:()=>"unknown"});var xh=new O("",{providedIn:"root",factory:()=>_w().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Mw="h",Nw="b";var kw=()=>null;function Lh(t,e,n=!1){return kw(t,e,n)}var $y=!1,Ow=new O("",{providedIn:"root",factory:()=>$y});function Gy(t){return t instanceof Function?t():t}var Hr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Hr||{}),Pw;function Fh(t,e){return Pw(t,e)}function zo(t,e,n,r,o){if(r!=null){let i,s=!1;In(r)?i=r:Wo(r)&&(s=!0,r=r[En]);let a=Xt(r);t===0&&n!==null?o==null?Wy(e,n,a):Zc(e,n,a,o||null,!0):t===1&&n!==null?Zc(e,n,a,o||null,!0):t===2?Jw(e,a,s):t===3&&e.destroyNode(a),i!=null&&Xw(e,t,i,n,o)}}function xw(t,e){return t.createText(e)}function Lw(t,e,n){t.setValue(e,n)}function qy(t,e,n){return t.createElement(e,n)}function Fw(t,e){zy(t,e),e[En]=null,e[Lt]=null}function Uw(t,e,n,r,o,i){r[En]=o,r[Lt]=e,ml(t,r,n,1,o,i)}function zy(t,e){e[Qt].changeDetectionScheduler?.notify(1),ml(t,e,e[rt],2,null,null)}function Hw(t){let e=t[Es];if(!e)return Rd(t[K],t);for(;e;){let n=null;if(Wo(e))n=e[Es];else{let r=e[ut];r&&(n=r)}if(!n){for(;e&&!e[Pt]&&e!==t;)Wo(e)&&Rd(e[K],e),e=e[Ve];e===null&&(e=t),Wo(e)&&Rd(e[K],e),n=e&&e[Pt]}e=n}}function Bw(t,e,n,r){let o=ut+r,i=n.length;r>0&&(n[o-1][Pt]=e),r<i-ut?(e[Pt]=n[o],Gm(n,ut+r,e)):(n.push(e),e[Pt]=null),e[Ve]=n;let s=e[ul];s!==null&&n!==s&&jw(s,e);let a=e[Xo];a!==null&&a.insertView(t),jd(e),e[L]|=128}function jw(t,e){let n=t[Kc],o=e[Ve][Ve][Jt];e[Jt]!==o&&(t[L]|=yh.HasTransplantedViews),n===null?t[Kc]=[e]:n.push(e)}function Ky(t,e){let n=t[Kc],r=n.indexOf(e);n.splice(r,1)}function Jc(t,e){if(t.length<=ut)return;let n=ut+e,r=t[n];if(r){let o=r[ul];o!==null&&o!==t&&Ky(o,r),e>0&&(t[n-1][Pt]=r[Pt]);let i=$c(t,ut+e);Fw(r[K],r);let s=i[Xo];s!==null&&s.detachView(i[K]),r[Ve]=null,r[Pt]=null,r[L]&=-129}return r}function Uh(t,e){if(!(e[L]&256)){let n=e[rt];n.destroyNode&&ml(t,e,n,3,null,null),Hw(e)}}function Rd(t,e){if(e[L]&256)return;let n=Z(null);try{e[L]&=-129,e[L]|=256,e[Mr]&&_g(e[Mr]),$w(t,e),Vw(t,e),e[K].type===1&&e[rt].destroy();let r=e[ul];if(r!==null&&In(e[Ve])){r!==e[Ve]&&Ky(r,e);let o=e[Xo];o!==null&&o.detachView(t)}bw(e)}finally{Z(n)}}function Vw(t,e){let n=t.cleanup,r=e[Cs];if(n!==null)for(let i=0;i<n.length-1;i+=2)if(typeof n[i]=="string"){let s=n[i+3];s>=0?r[s]():r[-s].unsubscribe(),i+=2}else{let s=r[n[i+1]];n[i].call(s)}r!==null&&(e[Cs]=null);let o=e[zn];if(o!==null){e[zn]=null;for(let i=0;i<o.length;i++){let s=o[i];s()}}}function $w(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let o=e[n[r]];if(!(o instanceof ws)){let i=n[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){let a=o[i[s]],c=i[s+1];Kt(4,a,c);try{c.call(a)}finally{Kt(5,a,c)}}else{Kt(4,o,i);try{i.call(o)}finally{Kt(5,o,i)}}}}}function Gw(t,e,n){return qw(t,e.parent,n)}function qw(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[En];{let{componentOffset:o}=r;if(o>-1){let{encapsulation:i}=t.data[r.directiveStart+o];if(i===Yt.None||i===Yt.Emulated)return null}return Ft(r,n)}}function Zc(t,e,n,r,o){t.insertBefore(e,n,r,o)}function Wy(t,e,n){t.appendChild(e,n)}function Tm(t,e,n,r,o){r!==null?Zc(t,e,n,r,o):Wy(t,e,n)}function zw(t,e,n,r){t.removeChild(e,n,r)}function Hh(t,e){return t.parentNode(e)}function Kw(t,e){return t.nextSibling(e)}function Ww(t,e,n){return Qw(t,e,n)}function Yw(t,e,n){return t.type&40?Ft(t,n):null}var Qw=Yw,wm;function Bh(t,e,n,r){let o=Gw(t,r,e),i=e[rt],s=r.parent||e[Lt],a=Ww(s,r,e);if(o!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)Tm(i,o,n[c],a,!1);else Tm(i,o,n,a,!1);wm!==void 0&&wm(i,r,e,n,o)}function Hc(t,e){if(e!==null){let n=e.type;if(n&3)return Ft(e,t);if(n&4)return Wd(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Hc(t,r);{let o=t[e.index];return In(o)?Wd(-1,o):Xt(o)}}else{if(n&32)return Fh(e,t)()||Xt(t[e.index]);{let r=Yy(t,e);if(r!==null){if(Array.isArray(r))return r[0];let o=Ts(t[Jt]);return Hc(o,r)}else return Hc(t,e.next)}}}return null}function Yy(t,e){if(e!==null){let r=t[Jt][Lt],o=e.projection;return r.projection[o]}return null}function Wd(t,e){let n=ut+t+1;if(n<e.length){let r=e[n],o=r[K].firstChild;if(o!==null)return Hc(r,o)}return e[Nr]}function Jw(t,e,n){let r=Hh(t,e);r&&zw(t,r,e,n)}function jh(t,e,n,r,o,i,s){for(;n!=null;){let a=r[n.index],c=n.type;if(s&&e===0&&(a&&Or(Xt(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)jh(t,e,n.child,r,o,i,!1),zo(e,t,o,a,i);else if(c&32){let l=Fh(n,r),u;for(;u=l();)zo(e,t,o,u,i);zo(e,t,o,a,i)}else c&16?Zw(t,e,r,n,o,i):zo(e,t,o,a,i);n=s?n.projectionNext:n.next}}function ml(t,e,n,r,o,i){jh(n,r,t.firstChild,e,o,i,!1)}function Zw(t,e,n,r,o,i){let s=n[Jt],c=s[Lt].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];zo(e,t,o,u,i)}else{let l=c,u=s[Ve];Fy(r)&&(l.flags|=128),jh(t,e,l,u,o,i,!0)}}function Xw(t,e,n,r,o){let i=n[Nr],s=Xt(n);i!==s&&zo(e,t,r,i,o);for(let a=ut;a<n.length;a++){let c=n[a];ml(c[K],c,t,e,r,i)}}function eA(t,e,n){t.setAttribute(e,"style",n)}function Qy(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Jy(t,e,n){let{mergedAttrs:r,classes:o,styles:i}=n;r!==null&&xd(t,e,r),o!==null&&Qy(t,e,o),i!==null&&eA(t,e,i)}var yl={};function dt(t=1){Zy(Ur(),Re(),bh()+t,!1)}function Zy(t,e,n,r){if(!r)if((e[L]&3)===3){let i=t.preOrderCheckHooks;i!==null&&Fc(e,i,n)}else{let i=t.preOrderHooks;i!==null&&Uc(e,i,0,n)}kr(n)}function $e(t,e=q.Default){let n=Re();if(n===null)return R(t,e);let r=en();return Ny(r,n,It(t),e)}function Xy(t,e,n,r,o,i){let s=Z(null);try{let a=null;o&Kn.SignalBased&&(a=e[r][Ag]),a!==null&&a.transformFn!==void 0&&(i=a.transformFn(i)),o&Kn.HasDecoratorInputTransform&&(i=t.inputTransforms[r].call(e,i)),t.setInput!==null?t.setInput(e,a,i,n,r):ay(e,a,r,i)}finally{Z(s)}}function tA(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let o=n[r];if(o<0)kr(~o);else{let i=o,s=n[++r],a=n[++r];ew(s,i);let c=e[i];a(2,c)}}}finally{kr(-1)}}function vl(t,e,n,r,o,i,s,a,c,l,u){let h=e.blueprint.slice();return h[En]=o,h[L]=r|4|128|8|64,(l!==null||t&&t[L]&2048)&&(h[L]|=2048),dy(h),h[Ve]=h[ti]=t,h[Tt]=n,h[Qt]=s||t&&t[Qt],h[rt]=a||t&&t[rt],h[Zo]=c||t&&t[Zo]||null,h[Lt]=i,h[dl]=Sw(),h[qc]=u,h[oy]=l,h[Jt]=e.type==2?t[Jt]:h,h}function Cl(t,e,n,r,o){let i=t.data[e];if(i===null)i=nA(t,e,n,r,o),XT()&&(i.flags|=32);else if(i.type&64){i.type=n,i.value=r,i.attrs=o;let s=QT();i.injectorIndex=s===null?-1:s.injectorIndex}return Rs(i,!0),i}function nA(t,e,n,r,o){let i=py(),s=gy(),a=s?i:i&&i.parent,c=t.data[e]=aA(t,a,n,e,r,o);return t.firstChild===null&&(t.firstChild=c),i!==null&&(s?i.child==null&&c.parent!==null&&(i.child=c):i.next===null&&(i.next=c,c.prev=i)),c}function ev(t,e,n,r){if(n===0)return-1;let o=e.length;for(let i=0;i<n;i++)e.push(r),t.blueprint.push(r),t.data.push(null);return o}function tv(t,e,n,r,o){let i=bh(),s=r&2;try{kr(-1),s&&e.length>Zt&&Zy(t,e,Zt,!1),Kt(s?2:0,o),n(r,o)}finally{kr(i),Kt(s?3:1,o)}}function nv(t,e,n){if(sy(e)){let r=Z(null);try{let o=e.directiveStart,i=e.directiveEnd;for(let s=o;s<i;s++){let a=t.data[s];if(a.contentQueries){let c=n[s];a.contentQueries(1,c,s)}}}finally{Z(r)}}}function rv(t,e,n){fy()&&(pA(t,e,n,Ft(n,e)),(n.flags&64)===64&&cv(t,e,n))}function ov(t,e,n=Ft){let r=e.localNames;if(r!==null){let o=e.index+1;for(let i=0;i<r.length;i+=2){let s=r[i+1],a=s===-1?n(e,t):t[s];t[o++]=a}}}function iv(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=Vh(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function Vh(t,e,n,r,o,i,s,a,c,l,u){let h=Zt+r,g=h+o,y=rA(h,g),I=typeof l=="function"?l():l;return y[K]={type:t,blueprint:y,template:n,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof i=="function"?i():i,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:I,incompleteFirstPass:!1,ssrId:u}}function rA(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:yl);return n}function oA(t,e,n,r){let i=r.get(Ow,$y)||n===Yt.ShadowDom,s=t.selectRootElement(e,i);return iA(s),s}function iA(t){sA(t)}var sA=()=>null;function aA(t,e,n,r,o,i){let s=e?e.injectorIndex:-1,a=0;return KT()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Am(t,e,n,r,o){for(let i in e){if(!e.hasOwnProperty(i))continue;let s=e[i];if(s===void 0)continue;r??={};let a,c=Kn.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=i;if(o!==null){if(!o.hasOwnProperty(i))continue;l=o[i]}t===0?Sm(r,n,l,a,c):Sm(r,n,l,a)}return r}function Sm(t,e,n,r,o){let i;t.hasOwnProperty(n)?(i=t[n]).push(e,r):i=t[n]=[e,r],o!==void 0&&i.push(o)}function cA(t,e,n){let r=e.directiveStart,o=e.directiveEnd,i=t.data,s=e.attrs,a=[],c=null,l=null;for(let u=r;u<o;u++){let h=i[u],g=n?n.get(h):null,y=g?g.inputs:null,I=g?g.outputs:null;c=Am(0,h.inputs,u,c,y),l=Am(1,h.outputs,u,l,I);let T=c!==null&&s!==null&&!ph(e)?wA(c,u,s):null;a.push(T)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function lA(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function uA(t,e,n,r,o,i,s,a){let c=Ft(e,n),l=e.inputs,u;!a&&l!=null&&(u=l[r])?($h(t,n,u,r,o),hl(e)&&dA(n,e.index)):e.type&3?(r=lA(r),o=s!=null?s(o,e.value||"",r):o,i.setProperty(c,r,o)):e.type&12}function dA(t,e){let n=Fr(e,t);n[L]&16||(n[L]|=64)}function sv(t,e,n,r){if(fy()){let o=r===null?null:{"":-1},i=mA(t,n),s,a;i===null?s=a=null:[s,a]=i,s!==null&&av(t,e,n,s,o,a),o&&yA(n,r,o)}n.mergedAttrs=fh(n.mergedAttrs,n.attrs)}function av(t,e,n,r,o,i){for(let l=0;l<r.length;l++)gw(by(n,e),t,r[l].type);CA(n,t.data.length,r.length);for(let l=0;l<r.length;l++){let u=r[l];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,c=ev(t,e,r.length,null);for(let l=0;l<r.length;l++){let u=r[l];n.mergedAttrs=fh(n.mergedAttrs,u.hostAttrs),EA(t,n,e,c,u),vA(c,u,o),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let h=u.type.prototype;!s&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),s=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}cA(t,n,i)}function hA(t,e,n,r,o){let i=o.hostBindings;if(i){let s=t.hostBindingOpCodes;s===null&&(s=t.hostBindingOpCodes=[]);let a=~e.index;fA(s)!=a&&s.push(a),s.push(n,r,i)}}function fA(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function pA(t,e,n,r){let o=n.directiveStart,i=n.directiveEnd;hl(n)&&IA(e,n,t.data[o+n.componentOffset]),t.firstCreatePass||by(n,e),Or(r,e);let s=n.initialInputs;for(let a=o;a<i;a++){let c=t.data[a],l=As(e,t,a,n);if(Or(l,e),s!==null&&TA(e,a-o,l,c,n,s),_s(c)){let u=Fr(n.index,e);u[Tt]=As(e,t,a,n)}}}function cv(t,e,n){let r=n.directiveStart,o=n.directiveEnd,i=n.index,s=tw();try{kr(i);for(let a=r;a<o;a++){let c=t.data[a],l=e[a];Vd(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&gA(c,l)}}finally{kr(-1),Vd(s)}}function gA(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function mA(t,e){let n=t.directiveRegistry,r=null,o=null;if(n)for(let i=0;i<n.length;i++){let s=n[i];if(lT(e,s.selectors,!1))if(r||(r=[]),_s(s))if(s.findHostDirectiveDefs!==null){let a=[];o=o||new Map,s.findHostDirectiveDefs(s,a,o),r.unshift(...a,s);let c=a.length;Yd(t,e,c)}else r.unshift(s),Yd(t,e,0);else o=o||new Map,s.findHostDirectiveDefs?.(s,r,o),r.push(s)}return r===null?null:[r,o]}function Yd(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function yA(t,e,n){if(e){let r=t.localNames=[];for(let o=0;o<e.length;o+=2){let i=n[e[o+1]];if(i==null)throw new x(-301,!1);r.push(e[o],i)}}}function vA(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;_s(e)&&(n[""]=t)}}function CA(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function EA(t,e,n,r,o){t.data[r]=o;let i=o.factory||(o.factory=Qo(o.type,!0)),s=new ws(i,_s(o),$e);t.blueprint[r]=s,n[r]=s,hA(t,e,r,ev(t,n,o.hostVars,yl),o)}function IA(t,e,n){let r=Ft(e,t),o=iv(n),i=t[Qt].rendererFactory,s=16;n.signals?s=4096:n.onPush&&(s=64);let a=El(t,vl(t,o,null,s,r,e,null,i.createRenderer(r,n),null,null,null));t[e.index]=a}function TA(t,e,n,r,o,i){let s=i[e];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],l=s[a++],u=s[a++],h=s[a++];Xy(r,n,c,l,u,h)}}function wA(t,e,n){let r=null,o=0;for(;o<n.length;){let i=n[o];if(i===0){o+=4;continue}else if(i===5){o+=2;continue}if(typeof i=="number")break;if(t.hasOwnProperty(i)){r===null&&(r=[]);let s=t[i];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(i,s[a+1],s[a+2],n[o+1]);break}}o+=2}return r}function lv(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function uv(t,e){let n=t.contentQueries;if(n!==null){let r=Z(null);try{for(let o=0;o<n.length;o+=2){let i=n[o],s=n[o+1];if(s!==-1){let a=t.data[s];my(i),a.contentQueries(2,e[s],s)}}}finally{Z(r)}}}function El(t,e){return t[Es]?t[pm][Pt]=e:t[Es]=e,t[pm]=e,e}function Qd(t,e,n){my(0);let r=Z(null);try{e(t,n)}finally{Z(r)}}function AA(t){return t[Cs]||(t[Cs]=[])}function SA(t){return t.cleanup||(t.cleanup=[])}function dv(t,e){let n=t[Zo],r=n?n.get(vn,null):null;r&&r.handleError(e)}function $h(t,e,n,r,o){for(let i=0;i<n.length;){let s=n[i++],a=n[i++],c=n[i++],l=e[s],u=t.data[s];Xy(u,l,r,a,c,o)}}function DA(t,e,n){let r=HT(e,t);Lw(t[rt],r,n)}function bA(t,e){let n=Fr(e,t),r=n[K];_A(r,n);let o=n[En];o!==null&&n[qc]===null&&(n[qc]=Lh(o,n[Zo])),Gh(r,n,n[Tt])}function _A(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function Gh(t,e,n){Sh(e);try{let r=t.viewQuery;r!==null&&Qd(1,r,n);let o=t.template;o!==null&&tv(t,e,o,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Xo]?.finishViewCreation(t),t.staticContentQueries&&uv(t,e),t.staticViewQueries&&Qd(2,t.viewQuery,n);let i=t.components;i!==null&&RA(e,i)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[L]&=-5,Dh()}}function RA(t,e){for(let n=0;n<e.length;n++)bA(t,e[n])}function hv(t,e,n,r){let o=Z(null);try{let i=e.tView,a=t[L]&4096?4096:16,c=vl(t,i,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=t[e.index];c[ul]=l;let u=t[Xo];return u!==null&&(c[Xo]=u.createEmbeddedView(i)),Gh(i,c,n),c}finally{Z(o)}}function MA(t,e){let n=ut+e;if(n<t.length)return t[n]}function Jd(t,e){return!e||e.firstChild===null||Fy(t)}function fv(t,e,n,r=!0){let o=e[K];if(Bw(o,e,t,n),r){let s=Wd(n,t),a=e[rt],c=Hh(a,t[Nr]);c!==null&&Uw(o,t[Lt],a,e,c,s)}let i=e[qc];i!==null&&i.firstChild!==null&&(i.firstChild=null)}function NA(t,e){let n=Jc(t,e);return n!==void 0&&Uh(n[K],n),n}function Xc(t,e,n,r,o=!1){for(;n!==null;){let i=e[n.index];i!==null&&r.push(Xt(i)),In(i)&&kA(i,r);let s=n.type;if(s&8)Xc(t,e,n.child,r);else if(s&32){let a=Fh(n,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=Yy(e,n);if(Array.isArray(a))r.push(...a);else{let c=Ts(e[Jt]);Xc(c[K],c,a,r,!0)}}n=o?n.projectionNext:n.next}return r}function kA(t,e){for(let n=ut;n<t.length;n++){let r=t[n],o=r[K].firstChild;o!==null&&Xc(r[K],r,o,e)}t[Nr]!==t[En]&&e.push(t[Nr])}var pv=[];function OA(t){return t[Mr]??PA(t)}function PA(t){let e=pv.pop()??Object.create(LA);return e.lView=t,e}function xA(t){t.lView[Mr]!==t&&(t.lView=null,pv.push(t))}var LA=S(m({},Sg),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Is(t.lView)},consumerOnSignalRead(){this.lView[Mr]=this}}),gv=100;function mv(t,e=!0,n=0){let r=t[Qt],o=r.rendererFactory,i=!1;i||o.begin?.();try{FA(t,n)}catch(s){throw e&&dv(t,s),s}finally{i||(o.end?.(),r.inlineEffectRunner?.flush())}}function FA(t,e){Zd(t,e);let n=0;for(;Ih(t);){if(n===gv)throw new x(103,!1);n++,Zd(t,1)}}function UA(t,e,n,r){let o=e[L];if((o&256)===256)return;let i=!1;!i&&e[Qt].inlineEffectRunner?.flush(),Sh(e);let s=null,a=null;!i&&HA(t)&&(a=OA(e),s=Dg(a));try{dy(e),ZT(t.bindingStartIndex),n!==null&&tv(t,e,n,2,r);let c=(o&3)===3;if(!i)if(c){let h=t.preOrderCheckHooks;h!==null&&Fc(e,h,null)}else{let h=t.preOrderHooks;h!==null&&Uc(e,h,0,null),Sd(e,0)}if(BA(e),yv(e,0),t.contentQueries!==null&&uv(t,e),!i)if(c){let h=t.contentCheckHooks;h!==null&&Fc(e,h)}else{let h=t.contentHooks;h!==null&&Uc(e,h,1),Sd(e,1)}tA(t,e);let l=t.components;l!==null&&Cv(e,l,0);let u=t.viewQuery;if(u!==null&&Qd(2,u,r),!i)if(c){let h=t.viewCheckHooks;h!==null&&Fc(e,h)}else{let h=t.viewHooks;h!==null&&Uc(e,h,2),Sd(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[Ad]){for(let h of e[Ad])h();e[Ad]=null}i||(e[L]&=-73)}catch(c){throw Is(e),c}finally{a!==null&&(bg(a,s),xA(a)),Dh()}}function HA(t){return t.type!==2}function yv(t,e){for(let n=Hy(t);n!==null;n=By(n))for(let r=ut;r<n.length;r++){let o=n[r];vv(o,e)}}function BA(t){for(let e=Hy(t);e!==null;e=By(e)){if(!(e[L]&yh.HasTransplantedViews))continue;let n=e[Kc];for(let r=0;r<n.length;r++){let o=n[r],i=o[Ve];jT(o)}}}function jA(t,e,n){let r=Fr(e,t);vv(r,n)}function vv(t,e){Eh(t)&&Zd(t,e)}function Zd(t,e){let r=t[K],o=t[L],i=t[Mr],s=!!(e===0&&o&16);if(s||=!!(o&64&&e===0),s||=!!(o&1024),s||=!!(i?.dirty&&od(i)),i&&(i.dirty=!1),t[L]&=-9217,s)UA(r,t,r.template,t[Tt]);else if(o&8192){yv(t,1);let a=r.components;a!==null&&Cv(t,a,1)}}function Cv(t,e,n){for(let r=0;r<e.length;r++)jA(t,e[r],n)}function qh(t){for(t[Qt].changeDetectionScheduler?.notify();t;){t[L]|=64;let e=Ts(t);if(NT(t)&&!e)return t;t=e}return null}var Pr=class{get rootNodes(){let e=this._lView,n=e[K];return Xc(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Tt]}set context(e){this._lView[Tt]=e}get destroyed(){return(this._lView[L]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Ve];if(In(e)){let n=e[zc],r=n?n.indexOf(this):-1;r>-1&&(Jc(e,r),$c(n,r))}this._attachedToViewContainer=!1}Uh(this._lView[K],this._lView)}onDestroy(e){hy(this._lView,e)}markForCheck(){qh(this._cdRefInjectingView||this._lView)}detach(){this._lView[L]&=-129}reattach(){jd(this._lView),this._lView[L]|=128}detectChanges(){this._lView[L]|=1024,mv(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new x(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,zy(this._lView[K],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new x(902,!1);this._appRef=e,jd(this._lView)}},zh=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=GA;let t=e;return t})(),VA=zh,$A=class extends VA{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let o=hv(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new Pr(o)}};function GA(){return qA(en(),Re())}function qA(t,e){return t.type&4?new $A(e,t,pl(t,e)):null}var V0=new RegExp(`^(\\d+)*(${Nw}|${Mw})*(.*)`);var zA=()=>null;function Xd(t,e){return zA(t,e)}var eh=class{},th=class{},el=class{};function KA(t){let e=Error(`No component factory found for ${tt(t)}.`);return e[WA]=t,e}var WA="ngComponent";var nh=class{resolveComponentFactory(e){throw KA(e)}},Il=(()=>{let e=class e{};e.NULL=new nh;let t=e;return t})(),Ss=class{};var YA=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Md={};var Dm=new Set;function Tl(t){Dm.has(t)||(Dm.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function bm(...t){}function QA(){let t=typeof ps.requestAnimationFrame=="function",e=ps[t?"requestAnimationFrame":"setTimeout"],n=ps[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let o=n[Zone.__symbol__("OriginalDelegate")];o&&(n=o)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var Ce=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ot(!1),this.onMicrotaskEmpty=new Ot(!1),this.onStable=new Ot(!1),this.onError=new Ot(!1),typeof Zone>"u")throw new x(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&n,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=QA().nativeRequestAnimationFrame,XA(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new x(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new x(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,o){let i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,e,JA,bm,bm);try{return i.runTask(s,n,r)}finally{i.cancelTask(s)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},JA={};function Kh(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function ZA(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ps,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,rh(t),t.isCheckStableRunning=!0,Kh(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),rh(t))}function XA(t){let e=()=>{ZA(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,o,i,s,a)=>{if(eS(a))return n.invokeTask(o,i,s,a);try{return _m(t),n.invokeTask(o,i,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&i.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),Rm(t)}},onInvoke:(n,r,o,i,s,a,c)=>{try{return _m(t),n.invoke(o,i,s,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),Rm(t)}},onHasTask:(n,r,o,i)=>{n.hasTask(o,i),r===o&&(i.change=="microTask"?(t._hasPendingMicrotasks=i.microTask,rh(t),Kh(t)):i.change=="macroTask"&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(n,r,o,i)=>(n.handleError(o,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}function rh(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function _m(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Rm(t){t._nesting--,Kh(t)}function eS(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var Ev=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let o of r)o()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function oh(t,e,n){let r=n?t.styles:null,o=n?t.classes:null,i=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")i=a;else if(i==1)o=om(o,a);else if(i==2){let c=a,l=e[++s];r=om(r,c+": "+l+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=o:t.classesWithoutHost=o}var tl=class extends Il{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Rr(e);return new Ds(n,this.ngModule)}};function Mm(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function tS(t){let e=t.toLowerCase();return e==="svg"?xT:e==="math"?LT:null}var ih=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=al(r);let o=this.injector.get(e,Md,r);return o!==Md||n===Md?o:this.parentInjector.get(e,n,r)}},Ds=class extends el{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=Mm(e.inputs);if(n!==null)for(let o of r)n.hasOwnProperty(o.propName)&&(o.transform=n[o.propName]);return r}get outputs(){return Mm(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=fT(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,o){let i=Z(null);try{o=o||this.ngModule;let s=o instanceof nt?o:o?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new ih(e,s):e,c=a.get(Ss,null);if(c===null)throw new x(407,!1);let l=a.get(YA,null),u=a.get(Ev,null),h=a.get(eh,null),g={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:h},y=c.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",T=r?oA(y,r,this.componentDef.encapsulation,a):qy(y,I,tS(I)),b=512;this.componentDef.signals?b|=4096:this.componentDef.onPush||(b|=16);let _=null;T!==null&&(_=Lh(T,a,!0));let se=Vh(0,null,null,1,0,null,null,null,null,null,null),re=vl(null,se,null,b,null,null,g,y,a,null,_);Sh(re);let ne,Fe;try{let Ae=this.componentDef,Ct,Oo=null;Ae.findHostDirectiveDefs?(Ct=[],Oo=new Map,Ae.findHostDirectiveDefs(Ae,Ct,Oo),Ct.push(Ae)):Ct=[Ae];let uI=nS(re,T),dI=rS(uI,T,Ae,Ct,re,g,y);Fe=Ch(se,Zt),T&&sS(y,Ae,T,r),n!==void 0&&aS(Fe,this.ngContentSelectors,n),ne=iS(dI,Ae,Ct,Oo,re,[cS]),Gh(se,re,null)}finally{Dh()}return new sh(this.componentType,ne,pl(Fe,re),re,Fe)}finally{Z(i)}}},sh=class extends th{constructor(e,n,r,o,i){super(),this.location=r,this._rootLView=o,this._tNode=i,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Pr(o,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,o;if(r!==null&&(o=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let i=this._rootLView;$h(i[K],i,o,e,n),this.previousInputValues.set(e,n);let s=Fr(this._tNode.index,i);qh(s)}}get injector(){return new _r(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function nS(t,e){let n=t[K],r=Zt;return t[r]=e,Cl(n,r,2,"#host",null)}function rS(t,e,n,r,o,i,s){let a=o[K];oS(r,t,e,s);let c=null;e!==null&&(c=Lh(e,o[Zo]));let l=i.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let h=vl(o,iv(n),null,u,o[t.index],t,i,l,null,null,c);return a.firstCreatePass&&Yd(a,t,r.length-1),El(o,h),o[t.index]=h}function oS(t,e,n,r){for(let o of t)e.mergedAttrs=fh(e.mergedAttrs,o.hostAttrs);e.mergedAttrs!==null&&(oh(e,e.mergedAttrs,!0),n!==null&&Jy(r,n,e))}function iS(t,e,n,r,o,i){let s=en(),a=o[K],c=Ft(s,o);av(a,o,s,n,null,r);for(let u=0;u<n.length;u++){let h=s.directiveStart+u,g=As(o,a,h,s);Or(g,o)}cv(a,o,s),c&&Or(c,o);let l=As(o,a,s.directiveStart+s.componentOffset,s);if(t[Tt]=o[Tt]=l,i!==null)for(let u of i)u(l,e);return nv(a,s,o),l}function sS(t,e,n,r){if(r)xd(t,n,["ng-version","17.3.11"]);else{let{attrs:o,classes:i}=pT(e.selectors[0]);o&&xd(t,n,o),i&&i.length>0&&Qy(t,n,i.join(" "))}}function aS(t,e,n){let r=t.projection=[];for(let o=0;o<e.length;o++){let i=n[o];r.push(i!=null?Array.from(i):null)}}function cS(){let t=en();Mh(Re()[K],t)}var Ns=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=lS;let t=e;return t})();function lS(){let t=en();return dS(t,Re())}var uS=Ns,Iv=class extends uS{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return pl(this._hostTNode,this._hostLView)}get injector(){return new _r(this._hostTNode,this._hostLView)}get parentInjector(){let e=Nh(this._hostTNode,this._hostLView);if(Ay(e)){let n=Qc(e,this._hostLView),r=Yc(e),o=n[K].data[r+8];return new _r(o,n)}else return new _r(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=Nm(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-ut}createEmbeddedView(e,n,r){let o,i;typeof r=="number"?o=r:r!=null&&(o=r.index,i=r.injector);let s=Xd(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},i,s);return this.insertImpl(a,o,Jd(this._hostTNode,s)),a}createComponent(e,n,r,o,i){let s=e&&!MT(e),a;if(s)a=n;else{let I=n||{};a=I.index,r=I.injector,o=I.projectableNodes,i=I.environmentInjector||I.ngModuleRef}let c=s?e:new Ds(Rr(e)),l=r||this.parentInjector;if(!i&&c.ngModule==null){let T=(s?l:this.parentInjector).get(nt,null);T&&(i=T)}let u=Rr(c.componentType??{}),h=Xd(this._lContainer,u?.id??null),g=h?.firstChild??null,y=c.create(l,o,g,i);return this.insertImpl(y.hostView,a,Jd(this._hostTNode,h)),y}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let o=e._lView;if(BT(o)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=o[Ve],l=new Iv(c,c[Lt],c[Ve]);l.detach(l.indexOf(e))}}let i=this._adjustIndex(n),s=this._lContainer;return fv(s,o,i,r),e.attachToViewContainerRef(),Gm(Nd(s),i,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=Nm(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Jc(this._lContainer,n);r&&($c(Nd(this._lContainer),n),Uh(r[K],r))}detach(e){let n=this._adjustIndex(e,-1),r=Jc(this._lContainer,n);return r&&$c(Nd(this._lContainer),n)!=null?new Pr(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function Nm(t){return t[zc]}function Nd(t){return t[zc]||(t[zc]=[])}function dS(t,e){let n,r=e[t.index];return In(r)?n=r:(n=lv(r,e,null,t),e[t.index]=n,El(e,n)),fS(n,e,t,r),new Iv(n,t,e)}function hS(t,e){let n=t[rt],r=n.createComment(""),o=Ft(e,t),i=Hh(n,o);return Zc(n,i,r,Kw(n,o),!1),r}var fS=mS,pS=()=>!1;function gS(t,e,n){return pS(t,e,n)}function mS(t,e,n,r){if(t[Nr])return;let o;n.type&8?o=Xt(r):o=hS(e,n),t[Nr]=o}var Wn=class{},bs=class{};var ah=class extends Wn{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new tl(this);let o=Zm(e);this._bootstrapComponents=Gy(o.bootstrap),this._r3Injector=Py(e,n,[{provide:Wn,useValue:this},{provide:Il,useValue:this.componentFactoryResolver},...r],tt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},ch=class extends bs{constructor(e){super(),this.moduleType=e}create(e){return new ah(this.moduleType,e,[])}};var nl=class extends Wn{constructor(e){super(),this.componentFactoryResolver=new tl(this),this.instance=null;let n=new vs([...e.providers,{provide:Wn,useValue:this},{provide:Il,useValue:this.componentFactoryResolver}],e.parent||mh(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Wh(t,e,n=null){return new nl({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Br=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new De(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Yh(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function yS(t){return(t.flags&32)===32}function vS(t,e,n,r,o,i,s,a,c){let l=e.consts,u=Cl(e,t,4,s||null,Wc(l,a));sv(e,n,u,Wc(l,c)),Mh(e,u);let h=u.tView=Vh(2,u,r,o,i,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}function ks(t,e,n,r,o,i,s,a){let c=Re(),l=Ur(),u=t+Zt,h=l.firstCreatePass?vS(u,l,c,e,n,r,o,i,s):l.data[u];Rs(h,!1);let g=CS(l,c,h,t);_h()&&Bh(l,c,g,h),Or(g,c);let y=lv(g,c,g,h);return c[u]=y,El(c,y),gS(y,h,c),vh(h)&&rv(l,c,h),s!=null&&ov(c,h,a),ks}var CS=ES;function ES(t,e,n,r){return Rh(!0),e[rt].createComment("")}function IS(t,e,n,r){return Yh(t,Ah(),n)?e+jm(n)+r:yl}function wl(t,e,n){let r=Re(),o=Ah();if(Yh(r,o,e)){let i=Ur(),s=ow();uA(i,s,r,t,e,r[rt],n,!1)}return wl}function km(t,e,n,r,o){let i=e.inputs,s=o?"class":"style";$h(t,n,i[s],s,r)}function Qh(t,e,n){Tl("NgControlFlow");let r=Re(),o=Ah(),i=TS(r,Zt+t),s=0;if(Yh(r,o,e)){let a=Z(null);try{if(NA(i,s),e!==-1){let c=wS(r[K],Zt+e),l=Xd(i,c.tView.ssrId),u=hv(r,c,n,{dehydratedView:l});fv(i,u,s,Jd(c,l))}}finally{Z(a)}}else{let a=MA(i,s);a!==void 0&&(a[Tt]=n)}}function TS(t,e){return t[e]}function wS(t,e){return Ch(t,e)}function AS(t,e,n,r,o,i){let s=e.consts,a=Wc(s,o),c=Cl(e,t,2,r,a);return sv(e,n,c,Wc(s,i)),c.attrs!==null&&oh(c,c.attrs,!1),c.mergedAttrs!==null&&oh(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function Te(t,e,n,r){let o=Re(),i=Ur(),s=Zt+t,a=o[rt],c=i.firstCreatePass?AS(s,i,o,e,n,r):i.data[s],l=SS(i,o,c,a,e,t);o[s]=l;let u=vh(c);return Rs(c,!0),Jy(a,l,c),!yS(c)&&_h()&&Bh(i,o,l,c),GT()===0&&Or(l,o),qT(),u&&(rv(i,o,c),nv(i,c,o)),r!==null&&ov(o,c),Te}function ae(){let t=en();gy()?JT():(t=t.parent,Rs(t,!1));let e=t;WT(e)&&YT(),zT();let n=Ur();return n.firstCreatePass&&(Mh(n,t),sy(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&lw(e)&&km(n,e,Re(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&uw(e)&&km(n,e,Re(),e.stylesWithoutHost,!1),ae}function ni(t,e,n,r){return Te(t,e,n,r),ae(),ni}var SS=(t,e,n,r,o,i)=>(Rh(!0),qy(r,o,iw()));function Jh(){return Re()}var rl="en-US";var DS=rl;function bS(t){typeof t=="string"&&(DS=t.toLowerCase().replace(/_/g,"-"))}function Os(t,e,n,r){let o=Re(),i=Ur(),s=en();return RS(i,o,o[rt],s,t,e,r),Os}function _S(t,e,n,r){let o=t.cleanup;if(o!=null)for(let i=0;i<o.length-1;i+=2){let s=o[i];if(s===n&&o[i+1]===r){let a=e[Cs],c=o[i+2];return a.length>c?a[c]:null}typeof s=="string"&&(i+=2)}return null}function RS(t,e,n,r,o,i,s){let a=vh(r),l=t.firstCreatePass&&SA(t),u=e[Tt],h=AA(e),g=!0;if(r.type&3||s){let T=Ft(r,e),b=s?s(T):T,_=h.length,se=s?ne=>s(Xt(ne[r.index])):r.index,re=null;if(!s&&a&&(re=_S(t,e,o,r.index)),re!==null){let ne=re.__ngLastListenerFn__||re;ne.__ngNextListenerFn__=i,re.__ngLastListenerFn__=i,g=!1}else{i=Pm(r,e,u,i,!1);let ne=n.listen(b,o,i);h.push(i,ne),l&&l.push(o,se,_,_+1)}}else i=Pm(r,e,u,i,!1);let y=r.outputs,I;if(g&&y!==null&&(I=y[o])){let T=I.length;if(T)for(let b=0;b<T;b+=2){let _=I[b],se=I[b+1],Fe=e[_][se].subscribe(i),Ae=h.length;h.push(i,Fe),l&&l.push(o,r.index,Ae,-(Ae+1))}}}function Om(t,e,n,r){let o=Z(null);try{return Kt(6,e,n),n(r)!==!1}catch(i){return dv(t,i),!1}finally{Kt(7,e,n),Z(o)}}function Pm(t,e,n,r,o){return function i(s){if(s===Function)return r;let a=t.componentOffset>-1?Fr(t.index,e):e;qh(a);let c=Om(e,n,r,s),l=i.__ngNextListenerFn__;for(;l;)c=Om(e,n,l,s)&&c,l=l.__ngNextListenerFn__;return o&&c===!1&&s.preventDefault(),c}}function Ps(t=1){return rw(t)}function pe(t,e=""){let n=Re(),r=Ur(),o=t+Zt,i=r.firstCreatePass?Cl(r,o,1,e,null):r.data[o],s=MS(r,n,i,e,t);n[o]=s,_h()&&Bh(r,n,s,i),Rs(i,!1)}var MS=(t,e,n,r,o)=>(Rh(!0),xw(e[rt],r));function Zh(t){return tn("",t,""),Zh}function tn(t,e,n){let r=Re(),o=IS(r,t,e,n);return o!==yl&&DA(r,bh(),o),tn}var NS=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let o=ty(!1,r.type),i=o.length>0?Wh([o],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,i)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=k({token:e,providedIn:"environment",factory:()=>new e(R(nt))});let t=e;return t})();function nn(t){Tl("NgStandalone"),t.getStandaloneInjector=e=>e.get(NS).getOrCreateStandaloneInjector(t)}var Al=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var Tv=new O("");function xs(t){return!!t&&typeof t.then=="function"}function wv(t){return!!t&&typeof t.subscribe=="function"}var Av=new O(""),Sv=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,o)=>{this.resolve=r,this.reject=o}),this.appInits=D(Av,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let i of this.appInits){let s=i();if(xs(s))r.push(s);else if(wv(s)){let a=new Promise((c,l)=>{s.subscribe({complete:c,error:l})});r.push(a)}}let o=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{o()}).catch(i=>{this.reject(i)}),r.length===0&&o(),this.initialized=!0}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Sl=new O("");function kS(){Rg(()=>{throw new x(600,!1)})}function OS(t){return t.isBoundToModule}function PS(t,e,n){try{let r=n();return xs(r)?r.catch(o=>{throw e.runOutsideAngular(()=>t.handleError(o)),o}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var ri=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=D(xy),this.afterRenderEffectManager=D(Ev),this.externalTestViews=new Set,this.beforeRender=new Ie,this.afterTick=new Ie,this.componentTypes=[],this.components=[],this.isStable=D(Br).hasPendingTasks.pipe(j(r=>!r)),this._injector=D(nt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,o){let i=r instanceof el;if(!this._injector.get(Sv).done){let y=!i&&Jm(r),I=!1;throw new x(405,I)}let a;i?a=r:a=this._injector.get(Il).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=OS(a)?void 0:this._injector.get(Wn),l=o||a.selector,u=a.create(Ms.NULL,[],l,c),h=u.location.nativeElement,g=u.injector.get(Tv,null);return g?.registerApplication(h),u.onDestroy(()=>{this.detachView(u.hostView),kd(this.components,u),g?.unregisterApplication(h)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new x(101,!1);let o=Z(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(i){this.internalErrorHandler(i)}finally{this.afterTick.next(),this._runningTick=!1,Z(o)}}detectChangesInAttachedViews(r){let o=0,i=this.afterRenderEffectManager;for(;;){if(o===gv)throw new x(103,!1);if(r){let s=o===0;this.beforeRender.next(s);for(let{_lView:a,notifyErrorHandler:c}of this._views)xS(a,s,c)}if(o++,i.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>lh(s))&&(i.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:s})=>lh(s))))break}}attachView(r){let o=r;this._views.push(o),o.attachToAppRef(this)}detachView(r){let o=r;kd(this._views,o),o.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let o=this._injector.get(Sl,[]);[...this._bootstrapListeners,...o].forEach(i=>i(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>kd(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new x(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function kd(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function xS(t,e,n){!e&&!lh(t)||LS(t,n,e)}function lh(t){return Ih(t)}function LS(t,e,n){let r;n?(r=0,t[L]|=1024):t[L]&64?r=0:r=1,mv(t,e,r)}var uh=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Xh=(()=>{let e=class e{compileModuleSync(r){return new ch(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let o=this.compileModuleSync(r),i=Zm(r),s=Gy(i.declarations).reduce((a,c)=>{let l=Rr(c);return l&&a.push(new Ds(l)),a},[]);return new uh(o,s)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var FS=(()=>{let e=class e{constructor(){this.zone=D(Ce),this.applicationRef=D(ri)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function US(t){return[{provide:Ce,useFactory:t},{provide:Jo,multi:!0,useFactory:()=>{let e=D(FS,{optional:!0});return()=>e.initialize()}},{provide:Jo,multi:!0,useFactory:()=>{let e=D(VS);return()=>{e.initialize()}}},{provide:xy,useFactory:HS}]}function HS(){let t=D(Ce),e=D(vn);return n=>t.runOutsideAngular(()=>e.handleError(n))}function BS(t){let e=US(()=>new Ce(jS(t)));return ei([[],e])}function jS(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var VS=(()=>{let e=class e{constructor(){this.subscription=new Se,this.initialized=!1,this.zone=D(Ce),this.pendingTasks=D(Br)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ce.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ce.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function $S(){return typeof $localize<"u"&&$localize.locale||rl}var ef=new O("",{providedIn:"root",factory:()=>D(ef,q.Optional|q.SkipSelf)||$S()});var Dv=new O("");var Bc=null;function GS(t=[],e){return Ms.create({name:e,providers:[{provide:ll,useValue:"platform"},{provide:Dv,useValue:new Set([()=>Bc=null])},...t]})}function qS(t=[]){if(Bc)return Bc;let e=GS(t);return Bc=e,kS(),zS(e),e}function zS(t){t.get(Ph,null)?.forEach(n=>n())}var Ls=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=KS;let t=e;return t})();function KS(t){return WS(en(),Re(),(t&16)===16)}function WS(t,e,n){if(hl(t)&&!n){let r=Fr(t.index,e);return new Pr(r,r)}else if(t.type&47){let r=e[Jt];return new Pr(r,e)}return null}function bv(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,o=qS(r),i=[BS(),...n||[]],a=new nl({providers:i,parent:o,debugName:"",runEnvironmentInitializers:!1}).injector,c=a.get(Ce);return c.run(()=>{a.resolveInjectorInitializers();let l=a.get(vn,null),u;c.runOutsideAngular(()=>{u=c.onError.subscribe({next:y=>{l.handleError(y)}})});let h=()=>a.destroy(),g=o.get(Dv);return g.add(h),a.onDestroy(()=>{u.unsubscribe(),g.delete(h)}),PS(l,c,()=>{let y=a.get(Sv);return y.runInitializers(),y.donePromise.then(()=>{let I=a.get(ef,rl);bS(I||rl);let T=a.get(ri);return e!==void 0&&T.bootstrap(e),T})})})}catch(e){return Promise.reject(e)}}var Ov=null;function oi(){return Ov}function Pv(t){Ov??=t}var Dl=class{};var Ge=new O(""),xv=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>D(XS),providedIn:"platform"});let t=e;return t})();var XS=(()=>{let e=class e extends xv{constructor(){super(),this._doc=D(Ge),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return oi().getBaseHref(this._doc)}onPopState(r){let o=oi().getGlobalEventTarget(this._doc,"window");return o.addEventListener("popstate",r,!1),()=>o.removeEventListener("popstate",r)}onHashChange(r){let o=oi().getGlobalEventTarget(this._doc,"window");return o.addEventListener("hashchange",r,!1),()=>o.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,o,i){this._history.pushState(r,o,i)}replaceState(r,o,i){this._history.replaceState(r,o,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function Lv(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function _v(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function jr(t){return t&&t[0]!=="?"?"?"+t:t}var bl=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>D(Fv),providedIn:"root"});let t=e;return t})(),eD=new O(""),Fv=(()=>{let e=class e extends bl{constructor(r,o){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=o??this._platformLocation.getBaseHrefFromDOM()??D(Ge).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Lv(this._baseHref,r)}path(r=!1){let o=this._platformLocation.pathname+jr(this._platformLocation.search),i=this._platformLocation.hash;return i&&r?`${o}${i}`:o}pushState(r,o,i,s){let a=this.prepareExternalUrl(i+jr(s));this._platformLocation.pushState(r,o,a)}replaceState(r,o,i,s){let a=this.prepareExternalUrl(i+jr(s));this._platformLocation.replaceState(r,o,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(o){return new(o||e)(R(xv),R(eD,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var wn=(()=>{let e=class e{constructor(r){this._subject=new Ot,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let o=this._locationStrategy.getBaseHref();this._basePath=rD(_v(Rv(o))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,o=""){return this.path()==this.normalize(r+jr(o))}normalize(r){return e.stripTrailingSlash(nD(this._basePath,Rv(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,o="",i=null){this._locationStrategy.pushState(i,"",r,o),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+jr(o)),i)}replaceState(r,o="",i=null){this._locationStrategy.replaceState(i,"",r,o),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+jr(o)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(o=>{this._notifyUrlChangeListeners(o.url,o.state)}),()=>{let o=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(o,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",o){this._urlChangeListeners.forEach(i=>i(r,o))}subscribe(r,o,i){return this._subject.subscribe({next:r,error:o,complete:i})}};e.normalizeQueryParams=jr,e.joinWithSlash=Lv,e.stripTrailingSlash=_v,e.\u0275fac=function(o){return new(o||e)(R(bl))},e.\u0275prov=k({token:e,factory:()=>tD(),providedIn:"root"});let t=e;return t})();function tD(){return new wn(R(bl))}function nD(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function Rv(t){return t.replace(/\/index.html$/,"")}function rD(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function _l(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[o,i]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(o.trim()===e)return decodeURIComponent(i)}return null}var Uv=(()=>{let e=class e{constructor(r,o){this._viewContainer=r,this._context=new tf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=o}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){Mv("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){Mv("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,o){return!0}};e.\u0275fac=function(o){return new(o||e)($e(Ns),$e(zh))},e.\u0275dir=cl({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),tf=class{constructor(){this.$implicit=null,this.ngIf=null}};function Mv(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${tt(e)}'.`)}var Fs=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=Lr({type:e}),e.\u0275inj=xr({});let t=e;return t})(),Hv="browser",oD="server";function Rl(t){return t===oD}var ii=class{};var Hs=class{},Bs=class{},An=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let o=n.slice(0,r),i=o.toLowerCase(),s=n.slice(r+1).trim();this.maybeSetNormalizedName(o,i),this.headers.has(i)?this.headers.get(i).push(s):this.headers.set(i,[s])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let o=(e.op==="a"?this.headers.get(n):void 0)||[];o.push(...r),this.headers.set(n,o);break;case"d":let i=e.value;if(!i)this.headers.delete(n),this.normalizedNames.delete(n);else{let s=this.headers.get(n);if(!s)return;s=s.filter(a=>i.indexOf(a)===-1),s.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(i=>i.toString()),o=e.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var sf=class{encodeKey(e){return Bv(e)}encodeValue(e){return Bv(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function aD(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(o=>{let i=o.indexOf("="),[s,a]=i==-1?[e.decodeKey(o),""]:[e.decodeKey(o.slice(0,i)),e.decodeValue(o.slice(i+1))],c=n.get(s)||[];c.push(a),n.set(s,c)}),n}var cD=/%(\d[a-f0-9])/gi,lD={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Bv(t){return encodeURIComponent(t).replace(cD,(e,n)=>lD[n]??e)}function Ml(t){return`${t}`}var Jn=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new sf,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=aD(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],o=Array.isArray(r)?r.map(Ml):[Ml(r)];this.map.set(n,o)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let o=e[r];Array.isArray(o)?o.forEach(i=>{n.push({param:r,value:i,op:"a"})}):n.push({param:r,value:o,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(Ml(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],o=r.indexOf(Ml(e.value));o!==-1&&r.splice(o,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var af=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function uD(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function jv(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function Vv(t){return typeof Blob<"u"&&t instanceof Blob}function $v(t){return typeof FormData<"u"&&t instanceof FormData}function dD(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var Us=class t{constructor(e,n,r,o){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let i;if(uD(this.method)||o?(this.body=r!==void 0?r:null,i=o):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),this.transferCache=i.transferCache),this.headers??=new An,this.context??=new af,!this.params)this.params=new Jn,this.urlWithParams=n;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),c=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||jv(this.body)||Vv(this.body)||$v(this.body)||dD(this.body)?this.body:this.body instanceof Jn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||$v(this.body)?null:Vv(this.body)?this.body.type||null:jv(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Jn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,o=e.responseType||this.responseType,i=e.transferCache??this.transferCache,s=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,u=e.params||this.params,h=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((g,y)=>g.set(y,e.setHeaders[y]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((g,y)=>g.set(y,e.setParams[y]),u)),new t(n,r,s,{params:u,headers:l,context:h,reportProgress:c,responseType:o,withCredentials:a,transferCache:i})}},Zn=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Zn||{}),js=class{constructor(e,n=$s.Ok,r="OK"){this.headers=e.headers||new An,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Nl=class t extends js{constructor(e={}){super(e),this.type=Zn.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Vs=class t extends js{constructor(e={}){super(e),this.type=Zn.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Qn=class extends js{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},$s=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}($s||{});function rf(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var Gs=(()=>{let e=class e{constructor(r){this.handler=r}request(r,o,i={}){let s;if(r instanceof Us)s=r;else{let l;i.headers instanceof An?l=i.headers:l=new An(i.headers);let u;i.params&&(i.params instanceof Jn?u=i.params:u=new Jn({fromObject:i.params})),s=new Us(r,o,i.body!==void 0?i.body:null,{headers:l,context:i.context,params:u,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let a=M(s).pipe(Nt(l=>this.handler.handle(l)));if(r instanceof Us||i.observe==="events")return a;let c=a.pipe(ve(l=>l instanceof Vs));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(j(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(j(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(j(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(j(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(r,o={}){return this.request("DELETE",r,o)}get(r,o={}){return this.request("GET",r,o)}head(r,o={}){return this.request("HEAD",r,o)}jsonp(r,o){return this.request("JSONP",r,{params:new Jn().append(o,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,o={}){return this.request("OPTIONS",r,o)}patch(r,o,i={}){return this.request("PATCH",r,rf(i,o))}post(r,o,i={}){return this.request("POST",r,rf(i,o))}put(r,o,i={}){return this.request("PUT",r,rf(i,o))}};e.\u0275fac=function(o){return new(o||e)(R(Hs))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),hD=/^\)\]\}',?\n/,fD="X-Request-URL";function Gv(t){if(t.url)return t.url;let e=fD.toLocaleLowerCase();return t.headers.get(e)}var of=(()=>{let e=class e{constructor(){this.fetchImpl=D(cf,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=D(Ce)}handle(r){return new te(o=>{let i=new AbortController;return this.doRequest(r,i.signal,o).then(lf,s=>o.error(new Qn({error:s}))),()=>i.abort()})}doRequest(r,o,i){return f(this,null,function*(){let s=this.createRequestInit(r),a;try{let I=this.fetchImpl(r.urlWithParams,m({signal:o},s));pD(I),i.next({type:Zn.Sent}),a=yield I}catch(I){i.error(new Qn({error:I,status:I.status??0,statusText:I.statusText,url:r.urlWithParams,headers:I.headers}));return}let c=new An(a.headers),l=a.statusText,u=Gv(a)??r.urlWithParams,h=a.status,g=null;if(r.reportProgress&&i.next(new Nl({headers:c,status:h,statusText:l,url:u})),a.body){let I=a.headers.get("content-length"),T=[],b=a.body.getReader(),_=0,se,re,ne=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>f(this,null,function*(){for(;;){let{done:Ae,value:Ct}=yield b.read();if(Ae)break;if(T.push(Ct),_+=Ct.length,r.reportProgress){re=r.responseType==="text"?(re??"")+(se??=new TextDecoder).decode(Ct,{stream:!0}):void 0;let Oo=()=>i.next({type:Zn.DownloadProgress,total:I?+I:void 0,loaded:_,partialText:re});ne?ne.run(Oo):Oo()}}}));let Fe=this.concatChunks(T,_);try{let Ae=a.headers.get("Content-Type")??"";g=this.parseBody(r,Fe,Ae)}catch(Ae){i.error(new Qn({error:Ae,headers:new An(a.headers),status:a.status,statusText:a.statusText,url:Gv(a)??r.urlWithParams}));return}}h===0&&(h=g?$s.Ok:0),h>=200&&h<300?(i.next(new Vs({body:g,headers:c,status:h,statusText:l,url:u})),i.complete()):i.error(new Qn({error:g,headers:c,status:h,statusText:l,url:u}))})}parseBody(r,o,i){switch(r.responseType){case"json":let s=new TextDecoder().decode(o).replace(hD,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(o);case"blob":return new Blob([o],{type:i});case"arraybuffer":return o.buffer}}createRequestInit(r){let o={},i=r.withCredentials?"include":void 0;if(r.headers.forEach((s,a)=>o[s]=a.join(",")),o.Accept??="application/json, text/plain, */*",!o["Content-Type"]){let s=r.detectContentTypeHeader();s!==null&&(o["Content-Type"]=s)}return{body:r.serializeBody(),method:r.method,headers:o,credentials:i}}concatChunks(r,o){let i=new Uint8Array(o),s=0;for(let a of r)i.set(a,s),s+=a.length;return i}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),cf=class{};function lf(){}function pD(t){t.then(lf,lf)}function Wv(t,e){return e(t)}function gD(t,e){return(n,r)=>e.intercept(n,{handle:o=>t(o,r)})}function mD(t,e,n){return(r,o)=>Cn(n,()=>e(r,i=>t(i,o)))}var uf=new O(""),df=new O(""),yD=new O(""),Yv=new O("");function vD(){let t=null;return(e,n)=>{t===null&&(t=(D(uf,{optional:!0})??[]).reduceRight(gD,Wv));let r=D(Br),o=r.add();return t(e,n).pipe(Gn(()=>r.remove(o)))}}var qv=(()=>{let e=class e extends Hs{constructor(r,o){super(),this.backend=r,this.injector=o,this.chain=null,this.pendingTasks=D(Br);let i=D(Yv,{optional:!0});this.backend=i??r}handle(r){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(df),...this.injector.get(yD,[])]));this.chain=i.reduceRight((s,a)=>mD(s,a,this.injector),Wv)}let o=this.pendingTasks.add();return this.chain(r,i=>this.backend.handle(i)).pipe(Gn(()=>this.pendingTasks.remove(o)))}};e.\u0275fac=function(o){return new(o||e)(R(Bs),R(nt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();var CD=/^\)\]\}',?\n/;function ED(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var zv=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new x(-2800,!1);let o=this.xhrFactory;return(o.\u0275loadImpl?X(o.\u0275loadImpl()):M(null)).pipe(_e(()=>new te(s=>{let a=o.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((b,_)=>a.setRequestHeader(b,_.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let b=r.detectContentTypeHeader();b!==null&&a.setRequestHeader("Content-Type",b)}if(r.responseType){let b=r.responseType.toLowerCase();a.responseType=b!=="json"?b:"text"}let c=r.serializeBody(),l=null,u=()=>{if(l!==null)return l;let b=a.statusText||"OK",_=new An(a.getAllResponseHeaders()),se=ED(a)||r.url;return l=new Nl({headers:_,status:a.status,statusText:b,url:se}),l},h=()=>{let{headers:b,status:_,statusText:se,url:re}=u(),ne=null;_!==$s.NoContent&&(ne=typeof a.response>"u"?a.responseText:a.response),_===0&&(_=ne?$s.Ok:0);let Fe=_>=200&&_<300;if(r.responseType==="json"&&typeof ne=="string"){let Ae=ne;ne=ne.replace(CD,"");try{ne=ne!==""?JSON.parse(ne):null}catch(Ct){ne=Ae,Fe&&(Fe=!1,ne={error:Ct,text:ne})}}Fe?(s.next(new Vs({body:ne,headers:b,status:_,statusText:se,url:re||void 0})),s.complete()):s.error(new Qn({error:ne,headers:b,status:_,statusText:se,url:re||void 0}))},g=b=>{let{url:_}=u(),se=new Qn({error:b,status:a.status||0,statusText:a.statusText||"Unknown Error",url:_||void 0});s.error(se)},y=!1,I=b=>{y||(s.next(u()),y=!0);let _={type:Zn.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(_.total=b.total),r.responseType==="text"&&a.responseText&&(_.partialText=a.responseText),s.next(_)},T=b=>{let _={type:Zn.UploadProgress,loaded:b.loaded};b.lengthComputable&&(_.total=b.total),s.next(_)};return a.addEventListener("load",h),a.addEventListener("error",g),a.addEventListener("timeout",g),a.addEventListener("abort",g),r.reportProgress&&(a.addEventListener("progress",I),c!==null&&a.upload&&a.upload.addEventListener("progress",T)),a.send(c),s.next({type:Zn.Sent}),()=>{a.removeEventListener("error",g),a.removeEventListener("abort",g),a.removeEventListener("load",h),a.removeEventListener("timeout",g),r.reportProgress&&(a.removeEventListener("progress",I),c!==null&&a.upload&&a.upload.removeEventListener("progress",T)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(o){return new(o||e)(R(ii))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Qv=new O(""),ID="XSRF-TOKEN",TD=new O("",{providedIn:"root",factory:()=>ID}),wD="X-XSRF-TOKEN",AD=new O("",{providedIn:"root",factory:()=>wD}),kl=class{},SD=(()=>{let e=class e{constructor(r,o,i){this.doc=r,this.platform=o,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=_l(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(o){return new(o||e)(R(Ge),R(Yn),R(TD))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function DD(t,e){let n=t.url.toLowerCase();if(!D(Qv)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=D(kl).getToken(),o=D(AD);return r!=null&&!t.headers.has(o)&&(t=t.clone({headers:t.headers.set(o,r)})),e(t)}var hf=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(hf||{});function Jv(t,e){return{\u0275kind:t,\u0275providers:e}}function Zv(...t){let e=[Gs,zv,qv,{provide:Hs,useExisting:qv},{provide:Bs,useExisting:zv},{provide:df,useValue:DD,multi:!0},{provide:Qv,useValue:!0},{provide:kl,useClass:SD}];for(let n of t)e.push(...n.\u0275providers);return ei(e)}var Kv=new O("");function Xv(){return Jv(hf.LegacyInterceptors,[{provide:Kv,useFactory:vD},{provide:df,useExisting:Kv,multi:!0}])}function eC(){return Jv(hf.Fetch,[of,{provide:Bs,useExisting:of},{provide:Yv,useExisting:of}])}var gf=class extends Dl{constructor(){super(...arguments),this.supportsDOMEvents=!0}},mf=class t extends gf{static makeCurrent(){Pv(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=_D();return n==null?null:RD(n)}resetBaseElement(){qs=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return _l(document.cookie,e)}},qs=null;function _D(){return qs=qs||document.querySelector("base"),qs?qs.getAttribute("href"):null}function RD(t){return new URL(t,document.baseURI).pathname}var MD=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),yf=new O(""),iC=(()=>{let e=class e{constructor(r,o){this._zone=o,this._eventNameToPlugin=new Map,r.forEach(i=>{i.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,o,i){return this._findPluginFor(o).addEventListener(r,o,i)}getZone(){return this._zone}_findPluginFor(r){let o=this._eventNameToPlugin.get(r);if(o)return o;if(o=this._plugins.find(s=>s.supports(r)),!o)throw new x(5101,!1);return this._eventNameToPlugin.set(r,o),o}};e.\u0275fac=function(o){return new(o||e)(R(yf),R(Ce))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Ol=class{constructor(e){this._doc=e}},ff="ng-app-id",sC=(()=>{let e=class e{constructor(r,o,i,s={}){this.doc=r,this.appId=o,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Rl(s),this.resetHostNodes()}addStyles(r){for(let o of r)this.changeUsageCount(o,1)===1&&this.onStyleAdded(o)}removeStyles(r){for(let o of r)this.changeUsageCount(o,-1)<=0&&this.onStyleRemoved(o)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(o=>o.remove()),r.clear());for(let o of this.getAllStyles())this.onStyleRemoved(o);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let o of this.getAllStyles())this.addStyleToHost(r,o)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let o of this.hostNodes)this.addStyleToHost(o,r)}onStyleRemoved(r){let o=this.styleRef;o.get(r)?.elements?.forEach(i=>i.remove()),o.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${ff}="${this.appId}"]`);if(r?.length){let o=new Map;return r.forEach(i=>{i.textContent!=null&&o.set(i.textContent,i)}),o}return null}changeUsageCount(r,o){let i=this.styleRef;if(i.has(r)){let s=i.get(r);return s.usage+=o,s.usage}return i.set(r,{usage:o,elements:[]}),o}getStyleElement(r,o){let i=this.styleNodesInDOM,s=i?.get(o);if(s?.parentNode===r)return i.delete(o),s.removeAttribute(ff),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=o,this.platformIsServer&&a.setAttribute(ff,this.appId),r.appendChild(a),a}}addStyleToHost(r,o){let i=this.getStyleElement(r,o),s=this.styleRef,a=s.get(o)?.elements;a?a.push(i):s.set(o,{elements:[i],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(o){return new(o||e)(R(Ge),R(Oh),R(xh,8),R(Yn))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),pf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Cf=/%COMP%/g,aC="%COMP%",ND=`_nghost-${aC}`,kD=`_ngcontent-${aC}`,OD=!0,PD=new O("",{providedIn:"root",factory:()=>OD});function xD(t){return kD.replace(Cf,t)}function LD(t){return ND.replace(Cf,t)}function cC(t,e){return e.map(n=>n.replace(Cf,t))}var nC=(()=>{let e=class e{constructor(r,o,i,s,a,c,l,u=null){this.eventManager=r,this.sharedStylesHost=o,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Rl(c),this.defaultRenderer=new zs(r,a,l,this.platformIsServer)}createRenderer(r,o){if(!r||!o)return this.defaultRenderer;this.platformIsServer&&o.encapsulation===Yt.ShadowDom&&(o=S(m({},o),{encapsulation:Yt.Emulated}));let i=this.getOrCreateRenderer(r,o);return i instanceof Pl?i.applyToHost(r):i instanceof Ks&&i.applyStyles(),i}getOrCreateRenderer(r,o){let i=this.rendererByCompId,s=i.get(o.id);if(!s){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(o.encapsulation){case Yt.Emulated:s=new Pl(l,u,o,this.appId,h,a,c,g);break;case Yt.ShadowDom:return new vf(l,u,r,o,a,c,this.nonce,g);default:s=new Ks(l,u,o,h,a,c,g);break}i.set(o.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(o){return new(o||e)(R(iC),R(sC),R(Oh),R(PD),R(Ge),R(Yn),R(Ce),R(xh))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),zs=class{constructor(e,n,r,o){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=o,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(pf[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(rC(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(rC(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new x(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,o){if(o){n=o+":"+n;let i=pf[o];i?e.setAttributeNS(i,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let o=pf[r];o?e.removeAttributeNS(o,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,o){o&(Hr.DashCase|Hr.Important)?e.style.setProperty(n,r,o&Hr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Hr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=oi().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function rC(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var vf=class extends zs{constructor(e,n,r,o,i,s,a,c){super(e,i,s,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=cC(o.id,o.styles);for(let u of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=u,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ks=class extends zs{constructor(e,n,r,o,i,s,a,c){super(e,i,s,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o,this.styles=c?cC(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Pl=class extends Ks{constructor(e,n,r,o,i,s,a,c){let l=o+"-"+r.id;super(e,n,r,i,s,a,c,l),this.contentAttr=xD(l),this.hostAttr=LD(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},FD=(()=>{let e=class e extends Ol{constructor(r){super(r)}supports(r){return!0}addEventListener(r,o,i){return r.addEventListener(o,i,!1),()=>this.removeEventListener(r,o,i)}removeEventListener(r,o,i){return r.removeEventListener(o,i)}};e.\u0275fac=function(o){return new(o||e)(R(Ge))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),oC=["alt","control","meta","shift"],UD={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},HD={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},BD=(()=>{let e=class e extends Ol{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,o,i){let s=e.parseEventName(o),a=e.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>oi().onAndCancel(r,s.domEventName,a))}static parseEventName(r){let o=r.toLowerCase().split("."),i=o.shift();if(o.length===0||!(i==="keydown"||i==="keyup"))return null;let s=e._normalizeKey(o.pop()),a="",c=o.indexOf("code");if(c>-1&&(o.splice(c,1),a="code."),oC.forEach(u=>{let h=o.indexOf(u);h>-1&&(o.splice(h,1),a+=u+".")}),a+=s,o.length!=0||s.length===0)return null;let l={};return l.domEventName=i,l.fullKey=a,l}static matchEventFullKeyCode(r,o){let i=UD[r.key]||r.key,s="";return o.indexOf("code.")>-1&&(i=r.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),oC.forEach(a=>{if(a!==i){let c=HD[a];c(r)&&(s+=a+".")}}),s+=i,s===o)}static eventCallback(r,o,i){return s=>{e.matchEventFullKeyCode(s,r)&&i.runGuarded(()=>o(s))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(o){return new(o||e)(R(Ge))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function lC(t,e){return bv(m({rootComponent:t},jD(e)))}function jD(t){return{appProviders:[...zD,...t?.providers??[]],platformProviders:qD}}function VD(){mf.makeCurrent()}function $D(){return new vn}function GD(){return Vy(document),document}var qD=[{provide:Yn,useValue:Hv},{provide:Ph,useValue:VD,multi:!0},{provide:Ge,useFactory:GD,deps:[]}];var zD=[{provide:ll,useValue:"root"},{provide:vn,useFactory:$D,deps:[]},{provide:yf,useClass:FD,multi:!0,deps:[Ge,Ce,Yn]},{provide:yf,useClass:BD,multi:!0,deps:[Ge]},nC,sC,iC,{provide:Ss,useExisting:nC},{provide:ii,useClass:MD,deps:[]},[]];var uC=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(o){return new(o||e)(R(Ge))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Xn={production:!1,msalConfig:{auth:{clientId:"a5ddd8f5-77c0-474a-aade-38de513d0cec",authority:"https://login.microsoftonline.com/3a284c24-f8be-427f-ad9a-7af6479b7982/"}},apiConfig:{scopes:["profile"],uri:"https://graph.microsoft.com/beta/me/profile/"}};var dC=(()=>{let e=class e{constructor(r){this.http=r}ngOnInit(){this.getProfile(Xn.apiConfig.uri)}getProfile(r){this.http.get(r).subscribe(o=>{this.profile=o})}};e.\u0275fac=function(o){return new(o||e)($e(Gs))},e.\u0275cmp=xt({type:e,selectors:[["app-profile"]],standalone:!0,features:[nn],decls:17,vars:4,template:function(o,i){o&1&&(Te(0,"div")(1,"p")(2,"strong"),pe(3,"First Name: "),ae(),pe(4),ae(),Te(5,"p")(6,"strong"),pe(7,"Last Name: "),ae(),pe(8),ae(),Te(9,"p")(10,"strong"),pe(11,"Email: "),ae(),pe(12),ae(),Te(13,"p")(14,"strong"),pe(15,"Id: "),ae(),pe(16),ae()()),o&2&&(dt(4),tn(" ",i.profile==null?null:i.profile.givenName,""),dt(4),tn(" ",i.profile==null?null:i.profile.surname,""),dt(4),tn(" ",i.profile==null?null:i.profile.userPrincipalName,""),dt(4),tn(" ",i.profile==null?null:i.profile.id,""))}});let t=e;return t})();var Eu={};_t(Eu,{blockAPICallsBeforeInitialize:()=>vu,blockAcquireTokenInPopups:()=>KC,blockNonBrowserEnvironment:()=>WC,blockRedirectInIframe:()=>zC,blockReloadInHiddenIframes:()=>qC,clearHash:()=>Np,createGuid:()=>Lb,getCurrentUri:()=>it,getHomepage:()=>Op,invoke:()=>Qe,invokeAsync:()=>C,isInIframe:()=>Ba,isInPopup:()=>GC,preconnect:()=>Va,preflightCheck:()=>ja,redirectPreflightCheck:()=>Cu,replaceHash:()=>kp});var sr={};_t(sr,{checkMaxAge:()=>pa,extractTokenClaims:()=>Rn,getJWSPayload:()=>gC});var p={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},si={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},ht=[p.OPENID_SCOPE,p.PROFILE_SCOPE,p.OFFLINE_ACCESS_SCOPE],Ef=[...ht,p.EMAIL_SCOPE],qe={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},we={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Ut={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},ai={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},he={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},xl={PLAIN:"plain",S256:"S256"},Ht={QUERY:"query",FRAGMENT:"fragment"},If=S(m({},Ht),{FORM_POST:"form_post"}),Ws={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},ci={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},Ee={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},N={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var Ys="appmetadata",hC="client_info",er="1",li={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Ke={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Me={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},$={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Sn={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Ll={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Fl={username:"username",password:"password"},Qs={httpSuccess:200,httpBadRequest:400},Vr={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Ul={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Bt={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Hl={Jwt:"JWT",Jwk:"JWK",Pop:"pop"};var Tf=300;var $r={};_t($r,{postRequestFailed:()=>Zs,unexpectedError:()=>Js});var Js="unexpected_error",Zs="post_request_failed";var Bl={[Js]:"Unexpected error in authentication.",[Zs]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},fC={unexpectedError:{code:Js,desc:Bl[Js]},postRequestFailed:{code:Zs,desc:Bl[Zs]}},G=class t extends Error{constructor(e,n,r){let o=n?`${e}: ${n}`:e;super(o),Object.setPrototypeOf(this,t.prototype),this.errorCode=e||p.EMPTY_STRING,this.errorMessage=n||p.EMPTY_STRING,this.subError=r||p.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function Xs(t,e){return new G(t,e?`${Bl[t]} ${e}`:Bl[t])}var Ne={};_t(Ne,{authTimeNotFound:()=>Dn,authorizationCodeMissingFromServerResponse:()=>oo,bindingKeyNotRemoved:()=>io,cannotAppendScopeSet:()=>to,cannotRemoveEmptyScope:()=>eo,clientInfoDecodingError:()=>tr,clientInfoEmptyError:()=>Gr,deviceCodeExpired:()=>ra,deviceCodePollingCancelled:()=>na,deviceCodeUnknownError:()=>oa,emptyInputScopeSet:()=>or,endSessionEndpointNotSupported:()=>so,endpointResolutionError:()=>We,hashNotDeserialized:()=>Wr,invalidAssertion:()=>aa,invalidCacheEnvironment:()=>_n,invalidCacheRecord:()=>no,invalidClientCredential:()=>ca,invalidState:()=>jt,keyIdMissing:()=>ao,maxAgeTranspired:()=>Jr,methodNotImplemented:()=>F,missingTenantIdError:()=>ha,multipleMatchingAccounts:()=>ta,multipleMatchingAppMetadata:()=>Zr,multipleMatchingTokens:()=>ea,nestedAppAuthBridgeDisabled:()=>fa,networkError:()=>zr,noAccountFound:()=>ia,noAccountInSilentRequest:()=>bn,noCryptoObject:()=>ir,noNetworkConnectivity:()=>ua,nonceMismatch:()=>Qr,nullOrEmptyToken:()=>qr,openIdConfigError:()=>Kr,requestCannotBeMade:()=>Xr,stateMismatch:()=>Yr,stateNotFound:()=>rr,tokenClaimsCnfRequiredForSignedJwt:()=>ro,tokenParsingError:()=>nr,tokenRefreshRequired:()=>rn,unexpectedCredentialType:()=>sa,userCanceled:()=>da,userTimeoutReached:()=>la});var tr="client_info_decoding_error",Gr="client_info_empty_error",nr="token_parsing_error",qr="null_or_empty_token",We="endpoints_resolution_error",zr="network_error",Kr="openid_config_error",Wr="hash_not_deserialized",jt="invalid_state",Yr="state_mismatch",rr="state_not_found",Qr="nonce_mismatch",Dn="auth_time_not_found",Jr="max_age_transpired",ea="multiple_matching_tokens",ta="multiple_matching_accounts",Zr="multiple_matching_appMetadata",Xr="request_cannot_be_made",eo="cannot_remove_empty_scope",to="cannot_append_scopeset",or="empty_input_scopeset",na="device_code_polling_cancelled",ra="device_code_expired",oa="device_code_unknown_error",bn="no_account_in_silent_request",no="invalid_cache_record",_n="invalid_cache_environment",ia="no_account_found",ir="no_crypto_object",sa="unexpected_credential_type",aa="invalid_assertion",ca="invalid_client_credential",rn="token_refresh_required",la="user_timeout_reached",ro="token_claims_cnf_required_for_signedjwt",oo="authorization_code_missing_from_server_response",io="binding_key_not_removed",so="end_session_endpoint_not_supported",ao="key_id_missing",ua="no_network_connectivity",da="user_canceled",ha="missing_tenant_id_error",F="method_not_implemented",fa="nested_app_auth_bridge_disabled";var U={[tr]:"The client info could not be parsed/decoded correctly",[Gr]:"The client info was empty",[nr]:"Token cannot be parsed",[qr]:"The token is null or empty",[We]:"Endpoints cannot be resolved",[zr]:"Network request failed",[Kr]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Wr]:"The hash parameters could not be deserialized",[jt]:"State was not the expected format",[Yr]:"State mismatch error",[rr]:"State not found",[Qr]:"Nonce mismatch error",[Dn]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Jr]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[ea]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ta]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Zr]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Xr]:"Token request cannot be made without authorization code or refresh token.",[eo]:"Cannot remove null or empty scope from ScopeSet",[to]:"Cannot append ScopeSet",[or]:"Empty input ScopeSet cannot be processed",[na]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[ra]:"Device code is expired.",[oa]:"Device code stopped polling for unknown reasons.",[bn]:"Please pass an account object, silent flow is not supported without account information",[no]:"Cache record object was null or undefined.",[_n]:"Invalid environment when attempting to create cache entry",[ia]:"No account found in cache for given key.",[ir]:"No crypto object detected.",[sa]:"Unexpected credential type.",[aa]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[ca]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[rn]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[la]:"User defined timeout for device code polling reached",[ro]:"Cannot generate a POP jwt if the token_claims are not populated",[oo]:"Server response does not contain an authorization code to proceed",[io]:"Could not remove the credential's binding key from storage.",[so]:"The provided authority does not support logout",[ao]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ua]:"No network connectivity. Check your internet connection.",[da]:"User cancelled the flow.",[ha]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[F]:"This method has not been implemented",[fa]:"The nested app auth bridge is disabled"},pC={clientInfoDecodingError:{code:tr,desc:U[tr]},clientInfoEmptyError:{code:Gr,desc:U[Gr]},tokenParsingError:{code:nr,desc:U[nr]},nullOrEmptyToken:{code:qr,desc:U[qr]},endpointResolutionError:{code:We,desc:U[We]},networkError:{code:zr,desc:U[zr]},unableToGetOpenidConfigError:{code:Kr,desc:U[Kr]},hashNotDeserialized:{code:Wr,desc:U[Wr]},invalidStateError:{code:jt,desc:U[jt]},stateMismatchError:{code:Yr,desc:U[Yr]},stateNotFoundError:{code:rr,desc:U[rr]},nonceMismatchError:{code:Qr,desc:U[Qr]},authTimeNotFoundError:{code:Dn,desc:U[Dn]},maxAgeTranspired:{code:Jr,desc:U[Jr]},multipleMatchingTokens:{code:ea,desc:U[ea]},multipleMatchingAccounts:{code:ta,desc:U[ta]},multipleMatchingAppMetadata:{code:Zr,desc:U[Zr]},tokenRequestCannotBeMade:{code:Xr,desc:U[Xr]},removeEmptyScopeError:{code:eo,desc:U[eo]},appendScopeSetError:{code:to,desc:U[to]},emptyInputScopeSetError:{code:or,desc:U[or]},DeviceCodePollingCancelled:{code:na,desc:U[na]},DeviceCodeExpired:{code:ra,desc:U[ra]},DeviceCodeUnknownError:{code:oa,desc:U[oa]},NoAccountInSilentRequest:{code:bn,desc:U[bn]},invalidCacheRecord:{code:no,desc:U[no]},invalidCacheEnvironment:{code:_n,desc:U[_n]},noAccountFound:{code:ia,desc:U[ia]},noCryptoObj:{code:ir,desc:U[ir]},unexpectedCredentialType:{code:sa,desc:U[sa]},invalidAssertion:{code:aa,desc:U[aa]},invalidClientCredential:{code:ca,desc:U[ca]},tokenRefreshRequired:{code:rn,desc:U[rn]},userTimeoutReached:{code:la,desc:U[la]},tokenClaimsRequired:{code:ro,desc:U[ro]},noAuthorizationCodeFromServer:{code:oo,desc:U[oo]},bindingKeyNotRemovedError:{code:io,desc:U[io]},logoutNotSupported:{code:so,desc:U[so]},keyIdMissing:{code:ao,desc:U[ao]},noNetworkConnectivity:{code:ua,desc:U[ua]},userCanceledError:{code:da,desc:U[da]},missingTenantIdError:{code:ha,desc:U[ha]},nestedAppAuthBridgeDisabled:{code:fa,desc:U[fa]}},co=class t extends G{constructor(e,n){super(e,n?`${U[e]}: ${n}`:U[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,t.prototype)}};function v(t,e){return new co(t,e)}function Rn(t,e){let n=gC(t);try{let r=e(n);return JSON.parse(r)}catch{throw v(nr)}}function gC(t){if(!t)throw v(qr);let n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw v(nr);return n[2]}function pa(t,e){if(e===0||Date.now()-3e5>t+e)throw v(Jr)}var ql={};_t(ql,{createDiscoveredInstance:()=>Of});var Ye={Default:0,Adfs:1,Dsts:2,Ciam:3};function mC(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}var Vt={};_t(Vt,{authorityMismatch:()=>Ia,authorityUriInsecure:()=>uo,cannotAllowNativeBroker:()=>Ea,cannotSetOIDCOptions:()=>Ca,claimsRequestParsingError:()=>ga,emptyInputScopesError:()=>fo,invalidAuthenticationHeader:()=>va,invalidAuthorityMetadata:()=>vo,invalidClaims:()=>Mn,invalidCloudDiscoveryMetadata:()=>ar,invalidCodeChallengeMethod:()=>yo,invalidPromptValue:()=>po,logoutRequestEmpty:()=>mo,missingNonceAuthenticationHeader:()=>ya,missingSshJwk:()=>kn,missingSshKid:()=>ma,pkceParamsMissing:()=>Nn,redirectUriEmpty:()=>lo,tokenRequestEmpty:()=>go,untrustedAuthority:()=>Co,urlEmptyError:()=>ho,urlParseError:()=>on});var lo="redirect_uri_empty",ga="claims_request_parsing_error",uo="authority_uri_insecure",on="url_parse_error",ho="empty_url_error",fo="empty_input_scopes_error",po="invalid_prompt_value",Mn="invalid_claims",go="token_request_empty",mo="logout_request_empty",yo="invalid_code_challenge_method",Nn="pkce_params_missing",ar="invalid_cloud_discovery_metadata",vo="invalid_authority_metadata",Co="untrusted_authority",kn="missing_ssh_jwk",ma="missing_ssh_kid",ya="missing_nonce_authentication_header",va="invalid_authentication_header",Ca="cannot_set_OIDCOptions",Ea="cannot_allow_native_broker",Ia="authority_mismatch";var ye={[lo]:"A redirect URI is required for all calls, and none has been set.",[ga]:"Could not parse the given claims request object.",[uo]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[on]:"URL could not be parsed into appropriate segments.",[ho]:"URL was empty or null.",[fo]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[po]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Mn]:"Given claims parameter must be a stringified JSON object.",[go]:"Token request was empty and not found in cache.",[mo]:"The logout request was null or undefined.",[yo]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Nn]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[ar]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[vo]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Co]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[kn]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[ma]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[ya]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[va]:"Invalid authentication header provided",[Ca]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ea]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[Ia]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},yC={redirectUriNotSet:{code:lo,desc:ye[lo]},claimsRequestParsingError:{code:ga,desc:ye[ga]},authorityUriInsecure:{code:uo,desc:ye[uo]},urlParseError:{code:on,desc:ye[on]},urlEmptyError:{code:ho,desc:ye[ho]},emptyScopesError:{code:fo,desc:ye[fo]},invalidPrompt:{code:po,desc:ye[po]},invalidClaimsRequest:{code:Mn,desc:ye[Mn]},tokenRequestEmptyError:{code:go,desc:ye[go]},logoutRequestEmptyError:{code:mo,desc:ye[mo]},invalidCodeChallengeMethod:{code:yo,desc:ye[yo]},invalidCodeChallengeParams:{code:Nn,desc:ye[Nn]},invalidCloudDiscoveryMetadata:{code:ar,desc:ye[ar]},invalidAuthorityMetadata:{code:vo,desc:ye[vo]},untrustedAuthority:{code:Co,desc:ye[Co]},missingSshJwk:{code:kn,desc:ye[kn]},missingSshKid:{code:ma,desc:ye[ma]},missingNonceAuthenticationHeader:{code:ya,desc:ye[ya]},invalidAuthenticationHeader:{code:va,desc:ye[va]},cannotSetOIDCOptions:{code:Ca,desc:ye[Ca]},cannotAllowNativeBroker:{code:Ea,desc:ye[Ea]},authorityMismatch:{code:Ia,desc:ye[Ia]}},Ta=class t extends G{constructor(e){super(e,ye[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,t.prototype)}};function z(t){return new Ta(t)}var ge=class{static isEmptyObj(e){if(e)try{let n=JSON.parse(e);return Object.keys(n).length===0}catch{}return!0}static startsWith(e,n){return e.indexOf(n)===0}static endsWith(e,n){return e.length>=n.length&&e.lastIndexOf(n)===e.length-n.length}static queryStringToObject(e){let n={},r=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return r.forEach(i=>{if(i.trim()){let[s,a]=i.split(/=(.+)/g,2);s&&a&&(n[o(s)]=o(a))}}),n}static trimArrayEntries(e){return e.map(n=>n.trim())}static removeEmptyStringsFromArray(e){return e.filter(n=>!!n)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,n){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(n)}};var cr={};_t(cr,{getDeserializedResponse:()=>wf,stripLeadingHashOrQuery:()=>vC});function vC(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function wf(t){if(!t||t.indexOf("=")<0)return null;try{let e=vC(t),n=Object.fromEntries(new URLSearchParams(e));if(n.code||n.error||n.error_description||n.state)return n}catch{throw v(Wr)}return null}var H=class t{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw z(ho);e.includes("#")||(this._urlString=t.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let n=e.toLowerCase();return ge.endsWith(n,"?")?n=n.slice(0,-1):ge.endsWith(n,"?/")&&(n=n.slice(0,-2)),ge.endsWith(n,"/")||(n+="/"),n}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw z(on)}if(!e.HostNameAndPort||!e.PathSegments)throw z(on);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw z(uo)}static appendQueryString(e,n){return n?e.indexOf("?")<0?`${e}?${n}`:`${e}&${n}`:e}static removeHashFromUrl(e){return t.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let n=this.getUrlComponents(),r=n.PathSegments;return e&&r.length!==0&&(r[0]===Ut.COMMON||r[0]===Ut.ORGANIZATIONS)&&(r[0]=e),t.constructAuthorityUriFromObject(n)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=this.urlString.match(e);if(!n)throw z(on);let r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5],QueryString:n[7]},o=r.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),r.PathSegments=o,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){let n=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(n);if(!r)throw z(on);return r[2]}static getAbsoluteUrl(e,n){if(e[0]===p.FORWARD_SLASH){let o=new t(n).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new t(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!wf(e)}};var EC={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Af=EC.endpointMetadata,Sf=EC.instanceDiscoveryMetadata,Df=new Set;Sf.metadata.forEach(t=>{t.aliases.forEach(e=>{Df.add(e)})});function IC(t,e){let n,r=t.canonicalAuthority;if(r){let o=new H(r).getUrlComponents().HostNameAndPort;n=CC(o,t.cloudDiscoveryMetadata?.metadata,Ke.CONFIG,e)||CC(o,Sf.metadata,Ke.HARDCODED_VALUES,e)||t.knownAuthorities}return n||[]}function CC(t,e,n,r){if(r?.trace(`getAliasesFromMetadata called with source: ${n}`),t&&e){let o=wa(e,t);if(o)return r?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),o.aliases;r?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function TC(t){return wa(Sf.metadata,t)}function wa(t,e){for(let n=0;n<t.length;n++){let r=t[n];if(r.aliases.includes(e))return r}return null}var Ue={AAD:"AAD",OIDC:"OIDC"};var lr={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};function wC(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}function AC(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}var d={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},OL=new Map([[d.AcquireTokenByCode,"ATByCode"],[d.AcquireTokenByRefreshToken,"ATByRT"],[d.AcquireTokenSilent,"ATS"],[d.AcquireTokenSilentAsync,"ATSAsync"],[d.AcquireTokenPopup,"ATPopup"],[d.AcquireTokenRedirect,"ATRedirect"],[d.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[d.CryptoOptsSignJwt,"CryptoSignJwt"],[d.SilentCacheClientAcquireToken,"SltCacheClientAT"],[d.SilentIframeClientAcquireToken,"SltIframeClientAT"],[d.SilentRefreshClientAcquireToken,"SltRClientAT"],[d.SsoSilent,"SsoSlt"],[d.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[d.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[d.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[d.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[d.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[d.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[d.BrokerHandhshake,"BrokerHandshake"],[d.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[d.AcquireTokenByBroker,"ATByBroker"],[d.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[d.RefreshTokenClientAcquireToken,"RTClientAT"],[d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[d.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[d.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[d.AcquireTokenFromCache,"ATFromCache"],[d.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[d.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[d.AcquireTokenBySilentIframe,"ATBySltIframe"],[d.InitializeBaseRequest,"InitBaseReq"],[d.InitializeSilentRequest,"InitSltReq"],[d.InitializeClientApplication,"InitClientApplication"],[d.SilentIframeClientTokenHelper,"SIClientTHelper"],[d.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[d.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[d.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[d.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[d.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[d.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[d.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[d.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[d.GetAuthCodeUrl,"GetAuthCodeUrl"],[d.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[d.HandleCodeResponse,"HandleCodeResp"],[d.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[d.AuthClientAcquireToken,"AuthClientAT"],[d.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[d.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[d.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[d.PopTokenGenerateCnf,"PopTGenCnf"],[d.PopTokenGenerateKid,"PopTGenKid"],[d.HandleServerTokenResponse,"HandleServerTRes"],[d.DeserializeResponse,"DeserializeRes"],[d.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[d.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[d.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[d.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[d.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[d.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[d.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[d.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[d.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[d.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[d.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[d.AcquireTokenByCodeAsync,"ATByCodeAsync"],[d.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[d.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[d.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[d.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[d.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[d.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[d.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[d.NativeGenerateAuthResult,"NtvGenAuthRes"],[d.RemoveHiddenIframe,"RemoveHiddenIframe"],[d.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[d.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[d.GeneratePkceCodes,"GenPkceCodes"],[d.GenerateCodeVerifier,"GenCodeVerifier"],[d.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[d.Sha256Digest,"Sha256Digest"],[d.GetRandomValues,"GetRandomValues"]]),bf={NotStarted:0,InProgress:1,Completed:2};var Qe=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);let s=r?.startMeasurement(e,o);if(o){let a=e+"CallCount";r?.incrementFields({[a]:1},o)}try{let a=t(...i);return s?.end({success:!0}),n.trace(`Returning result from ${e}`),a}catch(a){n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s?.end({success:!1},a),a}},C=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);let s=r?.startMeasurement(e,o);if(o){let a=e+"CallCount";r?.incrementFields({[a]:1},o)}return r?.setPreQueueTime(e,o),t(...i).then(a=>(n.trace(`Returning result from ${e}`),s?.end({success:!0}),a)).catch(a=>{n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s?.end({success:!1},a),a})};var SC=(()=>{class t{constructor(n,r,o,i){this.networkInterface=n,this.logger=r,this.performanceClient=o,this.correlationId=i}detectRegion(n,r){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RegionDiscoveryDetectRegion,this.correlationId);let o=n;if(o)r.region_source=Vr.ENVIRONMENT_VARIABLE;else{let i=t.IMDS_OPTIONS;try{let s=yield C(this.getRegionFromIMDS.bind(this),d.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(p.IMDS_VERSION,i);if(s.status===Qs.httpSuccess&&(o=s.body,r.region_source=Vr.IMDS),s.status===Qs.httpBadRequest){let a=yield C(this.getCurrentVersion.bind(this),d.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return r.region_source=Vr.FAILED_AUTO_DETECTION,null;let c=yield C(this.getRegionFromIMDS.bind(this),d.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);c.status===Qs.httpSuccess&&(o=c.body,r.region_source=Vr.IMDS)}}catch{return r.region_source=Vr.FAILED_AUTO_DETECTION,null}}return o||(r.region_source=Vr.FAILED_AUTO_DETECTION),o||null})}getRegionFromIMDS(n,r){return f(this,null,function*(){return this.performanceClient?.addQueueMeasurement(d.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${p.IMDS_ENDPOINT}?api-version=${n}&format=text`,r,p.IMDS_TIMEOUT)})}getCurrentVersion(n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let r=yield this.networkInterface.sendGetRequestAsync(`${p.IMDS_ENDPOINT}?format=json`,n);return r.status===Qs.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}})}}return t.IMDS_OPTIONS={headers:{Metadata:"true"}},t})();var ue={};_t(ue,{createAccessTokenEntity:()=>Mf,createIdTokenEntity:()=>Rf,createRefreshTokenEntity:()=>Nf,generateAppMetadataKey:()=>ib,generateAuthorityMetadataExpiresAt:()=>Vl,generateCredentialKey:()=>Sa,isAccessTokenEntity:()=>YD,isAppMetadataEntity:()=>sb,isAuthorityMetadataEntity:()=>ab,isAuthorityMetadataExpired:()=>$l,isCredentialEntity:()=>jl,isIdTokenEntity:()=>QD,isRefreshTokenEntity:()=>JD,isServerTelemetryEntity:()=>rb,isThrottlingEntity:()=>ob,updateAuthorityEndpointMetadata:()=>di,updateCloudDiscoveryMetadata:()=>Da});var Aa={};_t(Aa,{delay:()=>WD,isTokenExpired:()=>ui,nowSeconds:()=>ft,wasClockTurnedBack:()=>_f});function ft(){return Math.round(new Date().getTime()/1e3)}function ui(t,e){let n=Number(t)||0;return ft()+e>n}function _f(t){return Number(t)>ft()}function WD(t,e){return new Promise(n=>setTimeout(()=>n(e),t))}function Sa(t){return[ZD(t),XD(t),eb(t),tb(t),nb(t)].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function Rf(t,e,n,r,o){return{credentialType:N.ID_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n,realm:o}}function Mf(t,e,n,r,o,i,s,a,c,l,u,h,g,y,I){let T={homeAccountId:t,credentialType:N.ACCESS_TOKEN,secret:n,cachedAt:ft().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:o,target:i,tokenType:u||$.BEARER};if(h&&(T.userAssertionHash=h),l&&(T.refreshOn=l.toString()),y&&(T.requestedClaims=y,T.requestedClaimsHash=I),T.tokenType?.toLowerCase()!==$.BEARER.toLowerCase())switch(T.credentialType=N.ACCESS_TOKEN_WITH_AUTH_SCHEME,T.tokenType){case $.POP:let b=Rn(n,c);if(!b?.cnf?.kid)throw v(ro);T.keyId=b.cnf.kid;break;case $.SSH:T.keyId=g}return T}function Nf(t,e,n,r,o,i,s){let a={credentialType:N.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function jl(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function YD(t){return t?jl(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===N.ACCESS_TOKEN||t.credentialType===N.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function QD(t){return t?jl(t)&&t.hasOwnProperty("realm")&&t.credentialType===N.ID_TOKEN:!1}function JD(t){return t?jl(t)&&t.credentialType===N.REFRESH_TOKEN:!1}function ZD(t){return[t.homeAccountId,t.environment].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function XD(t){let e=t.credentialType===N.REFRESH_TOKEN&&t.familyId||t.clientId;return[t.credentialType,e,t.realm||""].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function eb(t){return(t.target||"").toLowerCase()}function tb(t){return(t.requestedClaimsHash||"").toLowerCase()}function nb(t){return t.tokenType&&t.tokenType.toLowerCase()!==$.BEARER.toLowerCase()?t.tokenType.toLowerCase():""}function rb(t,e){let n=t.indexOf(Me.CACHE_KEY)===0,r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),n&&r}function ob(t,e){let n=!1;t&&(n=t.indexOf(Sn.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),n&&r}function ib({environment:t,clientId:e}){return[Ys,t,e].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}function sb(t,e){return e?t.indexOf(Ys)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function ab(t,e){return e?t.indexOf(li.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Vl(){return ft()+li.REFRESH_TIME_SECONDS}function di(t,e,n){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=n,t.jwks_uri=e.jwks_uri}function Da(t,e,n){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=n}function $l(t){return t.expiresAt<=ft()}var wt=class t{constructor(e,n,r,o,i,s,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=n,this.cacheManager=r,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=c||!1,this.regionDiscovery=new SC(n,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(p.CIAM_AUTH_URL))return Ye.Ciam;let n=e.PathSegments;if(n.length)switch(n[0].toLowerCase()){case p.ADFS:return Ye.Adfs;case p.DSTS:return Ye.Dsts}return Ye.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new H(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw v(We)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw v(We)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw v(We)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw v(so);return this.replacePath(this.metadata.end_session_endpoint)}else throw v(We)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw v(We)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw v(We)}canReplaceTenant(e){return e.PathSegments.length===1&&!t.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Ye.Default&&this.protocolMode===Ue.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let n=e,o=new H(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,c)=>{let l=i[c];if(c===0&&this.canReplaceTenant(o)){let u=new H(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];l!==u&&(this.logger.verbose(`Replacing tenant domain name ${l} with id ${u}`),l=u)}a!==l&&(n=n.replace(`/${l}/`,`/${a}/`))}),this.replaceTenant(n)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Ye.Adfs||this.protocolMode!==Ue.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),n=yield C(this.updateCloudDiscoveryMetadata.bind(this),d.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let r=yield C(this.updateEndpointMetadata.bind(this),d.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,n,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:n,authorityEndpointSource:r},this.correlationId)})}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Vl(),jwks_uri:""}),e}updateCachedMetadata(e,n,r){n!==Ke.CACHE&&r?.source!==Ke.CACHE&&(e.expiresAt=Vl(),e.canonical_authority=this.canonicalAuthority);let o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}updateEndpointMetadata(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityUpdateEndpointMetadata,this.correlationId);let n=this.updateEndpointMetadataFromLocalSources(e);if(n){if(n.source===Ke.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&n.metadata){let o=yield C(this.updateMetadataWithRegionalInformation.bind(this),d.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n.metadata);di(e,o,!1),e.canonical_authority=this.canonicalAuthority}return n.source}let r=yield C(this.getEndpointMetadataFromNetwork.bind(this),d.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=yield C(this.updateMetadataWithRegionalInformation.bind(this),d.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),di(e,r,!0),Ke.NETWORK;throw v(Kr,this.defaultOpenIdConfigurationEndpoint)})}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let n=this.getEndpointMetadataFromConfig();if(n)return this.logger.verbose("Found endpoint metadata in authority configuration"),di(e,n,!1),{source:Ke.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let o=this.getEndpointMetadataFromHardcodedValues();if(o)return di(e,o,!1),{source:Ke.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let r=$l(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Ke.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new H(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw z(vo)}return null}getEndpointMetadataFromNetwork(){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},n=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${n}`);try{let r=yield this.networkInterface.sendGetRequestAsync(n,e);return mC(r.body)?r.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(r){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${r}`),null}})}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Af?Af[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let n=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(n){if(n!==p.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Ul.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=n,t.replaceWithRegionalInformation(e,n);let r=yield C(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),d.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome=Ul.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=r,t.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome=Ul.AUTO_DETECTION_REQUESTED_FAILED}return e})}updateCloudDiscoveryMetadata(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let n=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(n)return n;let r=yield C(this.getCloudDiscoveryMetadataFromNetwork.bind(this),d.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return Da(e,r,!0),Ke.NETWORK;throw z(Co)})}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||p.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||p.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||p.NOT_APPLICABLE}`);let n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Da(e,n,!1),Ke.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let o=TC(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Da(e,o,!1),Ke.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let r=$l(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),Ke.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Ye.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),n=wa(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),n)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),n;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),z(ar)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${p.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,n={},r=null;try{let o=yield this.networkInterface.sendGetRequestAsync(e,n),i,s;if(wC(o.body))i=o.body,s=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else if(AC(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===p.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=wa(s,this.hostnameAndPort)}catch(o){if(o instanceof G)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{let i=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${i.name}
Error Description: ${i.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=t.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r})}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(n=>n&&H.getDomainFromUrl(n).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,n){let r;if(n&&n.azureCloudInstance!==lr.None){let o=n.tenant?n.tenant:p.DEFAULT_COMMON_TENANT;r=`${n.azureCloudInstance}/${o}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return p.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw v(We)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Df.has(e)}static isPublicCloudAuthority(e){return p.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,n,r){let o=new H(e);o.validateAsUri();let i=o.getUrlComponents(),s=`${n}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${n}.${p.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let a=H.constructAuthorityUriFromObject(S(m({},o.getUrlComponents()),{HostNameAndPort:s})).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,n){let r=m({},e);return r.authorization_endpoint=t.buildRegionalAuthorityString(r.authorization_endpoint,n),r.token_endpoint=t.buildRegionalAuthorityString(r.token_endpoint,n),r.end_session_endpoint&&(r.end_session_endpoint=t.buildRegionalAuthorityString(r.end_session_endpoint,n)),r}static transformCIAMAuthority(e){let n=e,o=new H(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(p.CIAM_AUTH_URL)){let i=o.HostNameAndPort.split(".")[0];n=`${n}${i}${p.AAD_TENANT_DOMAIN_SUFFIX}`}return n}};wt.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ut.COMMON,Ut.CONSUMERS,Ut.ORGANIZATIONS]);function DC(t){let r=new H(t).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case Ut.COMMON:case Ut.ORGANIZATIONS:case Ut.CONSUMERS:return;default:return r}}function Gl(t){return t.endsWith(p.FORWARD_SLASH)?t:`${t}${p.FORWARD_SLASH}`}function kf(t){let e=t.cloudDiscoveryMetadata,n;if(e)try{n=JSON.parse(e)}catch{throw z(ar)}return{canonicalAuthority:t.authority?Gl(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:n}}function Of(t,e,n,r,o,i,s){return f(this,null,function*(){s?.addQueueMeasurement(d.AuthorityFactoryCreateDiscoveredInstance,i);let a=wt.transformCIAMAuthority(Gl(t)),c=new wt(a,e,n,r,o,i,s);try{return yield C(c.resolveEndpointsAsync.bind(c),d.AuthorityResolveEndpointsAsync,o,s,i)(),c}catch{throw v(We)}})}function zl(t,e,n){return f(this,null,function*(){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:n})})}var ba={};_t(ba,{ACCESS_TOKEN:()=>ub,CCS_HEADER:()=>vb,CLAIMS:()=>Ff,CLIENT_ASSERTION:()=>ap,CLIENT_ASSERTION_TYPE:()=>cp,CLIENT_ID:()=>ur,CLIENT_INFO:()=>gb,CLIENT_REQUEST_ID:()=>Kf,CLIENT_SECRET:()=>sp,CODE:()=>$f,CODE_CHALLENGE:()=>Gf,CODE_CHALLENGE_METHOD:()=>qf,CODE_VERIFIER:()=>zf,DEVICE_CODE:()=>ip,DOMAIN_HINT:()=>gp,ERROR:()=>cb,ERROR_DESCRIPTION:()=>lb,EXPIRES_IN:()=>hb,FOCI:()=>yb,GRANT_TYPE:()=>Lf,ID_TOKEN:()=>db,ID_TOKEN_HINT:()=>op,LOGIN_HINT:()=>pp,LOGOUT_HINT:()=>hp,NATIVE_BROKER:()=>dp,NONCE:()=>jf,OBO_ASSERTION:()=>lp,ON_BEHALF_OF:()=>mb,POST_LOGOUT_URI:()=>rp,PROMPT:()=>Vf,REDIRECT_URI:()=>Pf,REFRESH_TOKEN:()=>Hf,REFRESH_TOKEN_EXPIRES_IN:()=>fb,REQUESTED_TOKEN_USE:()=>up,REQ_CNF:()=>Yl,RESPONSE_MODE:()=>xf,RESPONSE_TYPE:()=>Kl,RETURN_SPA_CODE:()=>Ql,SCOPE:()=>Uf,SESSION_STATE:()=>pb,SID:()=>fp,STATE:()=>Bf,TOKEN_TYPE:()=>Wl,X_APP_NAME:()=>tp,X_APP_VER:()=>np,X_CLIENT_CPU:()=>Jf,X_CLIENT_CURR_TELEM:()=>Zf,X_CLIENT_LAST_TELEM:()=>Xf,X_CLIENT_OS:()=>Qf,X_CLIENT_SKU:()=>Wf,X_CLIENT_VER:()=>Yf,X_MS_LIB_CAPABILITY:()=>ep});var ur="client_id",Pf="redirect_uri",Kl="response_type",xf="response_mode",Lf="grant_type",Ff="claims",Uf="scope",cb="error",lb="error_description",ub="access_token",db="id_token",Hf="refresh_token",hb="expires_in",fb="refresh_token_expires_in",Bf="state",jf="nonce",Vf="prompt",pb="session_state",gb="client_info",$f="code",Gf="code_challenge",qf="code_challenge_method",zf="code_verifier",Kf="client-request-id",Wf="x-client-SKU",Yf="x-client-VER",Qf="x-client-OS",Jf="x-client-CPU",Zf="x-client-current-telemetry",Xf="x-client-last-telemetry",ep="x-ms-lib-capability",tp="x-app-name",np="x-app-ver",rp="post_logout_redirect_uri",op="id_token_hint",ip="device_code",sp="client_secret",ap="client_assertion",cp="client_assertion_type",Wl="token_type",Yl="req_cnf",lp="assertion",up="requested_token_use",mb="on_behalf_of",yb="foci",vb="X-AnchorMailbox",Ql="return_spa_code",dp="nativebroker",hp="logout_hint",fp="sid",pp="login_hint",gp="domain_hint";var dr={createNewGuid:()=>{throw v(F)},base64Decode:()=>{throw v(F)},base64Encode:()=>{throw v(F)},base64UrlEncode:()=>{throw v(F)},encodeKid:()=>{throw v(F)},getPublicKeyThumbprint(){return f(this,null,function*(){throw v(F)})},removeTokenBindingKey(){return f(this,null,function*(){throw v(F)})},clearKeystore(){return f(this,null,function*(){throw v(F)})},signJwt(){return f(this,null,function*(){throw v(F)})},hashString(){return f(this,null,function*(){throw v(F)})}};var oe=function(t){return t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace",t}(oe||{}),At=class t{constructor(e,n,r){this.level=oe.Info;let o=()=>{},i=e||t.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:oe.Info,this.correlationId=i.correlationId||p.EMPTY_STRING,this.packageName=n||p.EMPTY_STRING,this.packageVersion=r||p.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:oe.Info}}clone(e,n,r){return new t({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,n)}logMessage(e,n){if(n.logLevel>this.level||!this.piiLoggingEnabled&&n.containsPii)return;let i=`${`[${new Date().toUTCString()}] : [${n.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${oe[n.logLevel]} - ${e}`;this.executeCallback(n.logLevel,i,n.containsPii||!1)}executeCallback(e,n,r){this.localCallback&&this.localCallback(e,n,r)}error(e,n){this.logMessage(e,{logLevel:oe.Error,containsPii:!1,correlationId:n||p.EMPTY_STRING})}errorPii(e,n){this.logMessage(e,{logLevel:oe.Error,containsPii:!0,correlationId:n||p.EMPTY_STRING})}warning(e,n){this.logMessage(e,{logLevel:oe.Warning,containsPii:!1,correlationId:n||p.EMPTY_STRING})}warningPii(e,n){this.logMessage(e,{logLevel:oe.Warning,containsPii:!0,correlationId:n||p.EMPTY_STRING})}info(e,n){this.logMessage(e,{logLevel:oe.Info,containsPii:!1,correlationId:n||p.EMPTY_STRING})}infoPii(e,n){this.logMessage(e,{logLevel:oe.Info,containsPii:!0,correlationId:n||p.EMPTY_STRING})}verbose(e,n){this.logMessage(e,{logLevel:oe.Verbose,containsPii:!1,correlationId:n||p.EMPTY_STRING})}verbosePii(e,n){this.logMessage(e,{logLevel:oe.Verbose,containsPii:!0,correlationId:n||p.EMPTY_STRING})}trace(e,n){this.logMessage(e,{logLevel:oe.Trace,containsPii:!1,correlationId:n||p.EMPTY_STRING})}tracePii(e,n){this.logMessage(e,{logLevel:oe.Trace,containsPii:!0,correlationId:n||p.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var Jl="@azure/msal-common",hi="14.12.0";var me=class t{constructor(e){let n=e?ge.trimArrayEntries([...e]):[],r=n?ge.removeEmptyStringsFromArray(n):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(o=>this.scopes.add(o))}static fromString(e){let r=(e||p.EMPTY_STRING).split(" ");return new t(r)}static createSearchScopes(e){let n=new t(e);return n.containsOnlyOIDCScopes()?n.removeScope(p.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),n}validateInputScopes(e){if(!e||e.length<1)throw z(fo)}containsScope(e){let n=this.printScopesLowerCase().split(" "),r=new t(n);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(n=>this.containsScope(n))}containsOnlyOIDCScopes(){let e=0;return Ef.forEach(n=>{this.containsScope(n)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(n=>this.appendScope(n))}catch{throw v(to)}}removeScope(e){if(!e)throw v(eo);this.scopes.delete(e.trim())}removeOIDCScopes(){Ef.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw v(or);let n=new Set;return e.scopes.forEach(r=>n.add(r.toLowerCase())),this.scopes.forEach(r=>n.add(r.toLowerCase())),n}intersectingScopeSets(e){if(!e)throw v(or);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let n=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return n.size<o+r}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(n=>e.push(n)),e}printScopes(){return this.scopes?this.asArray().join(" "):p.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function fi(t,e){if(!t)throw v(Gr);try{let n=e(t);return JSON.parse(n)}catch{throw v(tr)}}function On(t){if(!t)throw v(tr);let e=t.split(Ee.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?p.EMPTY_STRING:e[1]}}function _a(t,e){return!!t&&!!e&&t===e.split(".")[1]}function pi(t,e){let{oid:n,sub:r,tid:o,name:i,tfp:s,acr:a}=e,c=o||s||a||"";return{tenantId:c,localAccountId:n||r||"",name:i,isHomeTenant:_a(c,t)}}function Eo(t,e,n,r){let o=t;if(e){let i=e,{isHomeTenant:a}=i,c=mn(i,["isHomeTenant"]);o=m(m({},t),c)}if(n){let s=pi(t.homeAccountId,n),{isHomeTenant:a}=s,c=mn(s,["isHomeTenant"]);return o=S(m(m({},o),c),{idTokenClaims:n,idToken:r}),o}return o}function Zl(t){return t&&(t.tid||t.tfp||t.acr)||null}var de=class t{generateAccountId(){return[this.homeAccountId,this.environment].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return t.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let n=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",n||e.tenantId||""].join(Ee.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,n,r){let o=new t;n.authorityType===Ye.Adfs?o.authorityType=ci.ADFS_ACCOUNT_TYPE:n.protocolMode===Ue.AAD?o.authorityType=ci.MSSTS_ACCOUNT_TYPE:o.authorityType=ci.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&r&&(i=fi(e.clientInfo,r)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;let s=e.environment||n&&n.getPreferredCache();if(!s)throw v(_n);o.environment=s,o.realm=i?.utid||Zl(e.idTokenClaims)||"",o.localAccountId=i?.uid||e.idTokenClaims.oid||e.idTokenClaims.sub||"";let a=e.idTokenClaims.preferred_username||e.idTokenClaims.upn,c=e.idTokenClaims.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||c||"",o.name=e.idTokenClaims.name,o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{let l=[];if(e.idTokenClaims){let u=pi(e.homeAccountId,e.idTokenClaims);l.push(u)}o.tenantProfiles=l}return o}static createFromAccountInfo(e,n,r){let o=new t;return o.authorityType=e.authorityType||ci.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=n,o.msGraphHost=r,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o}static generateHomeAccountId(e,n,r,o,i){if(!(n===Ye.Adfs||n===Ye.Dsts)){if(e)try{let s=fi(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}r.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,n,r){if(!e||!n)return!1;let o=!0;if(r){let i=e.idTokenClaims||{},s=n.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===n.homeAccountId&&e.localAccountId===n.localAccountId&&e.username===n.username&&e.tenantId===n.tenantId&&e.environment===n.environment&&e.nativeAccountId===n.nativeAccountId&&o}};var Xl="cache_quota_exceeded",Ra="cache_error_unknown";var mp={[Xl]:"Exceeded cache storage capacity.",[Ra]:"Unexpected error occurred when using cache storage."},Pn=class t extends Error{constructor(e,n){let r=n||(mp[e]?mp[e]:mp[Ra]);super(`${e}: ${r}`),Object.setPrototypeOf(this,t.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}};var xn=class t{constructor(e,n,r,o){this.clientId=e,this.cryptoImpl=n,this.commonLogger=r.clone(Jl,hi),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let n=this.getAllAccounts(e);return n.length>1?n.sort(o=>o.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e){let n=this.getAccountsFilteredBy(e);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,n){return e.flatMap(r=>this.getAccountInfoForTenantProfiles(r,n))}getAccountInfoForTenantProfiles(e,n){return this.getTenantProfilesFromAccountEntity(e,n?.tenantId,n)}getTenantedAccountInfoByFilter(e,n,r,o){let i=null,s;if(o&&!this.tenantProfileMatchesFilter(r,o))return null;let a=this.getIdToken(e,n,r.tenantId);return a&&(s=Rn(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,o))?null:(i=Eo(e,r,s,a?.secret),i)}getTenantProfilesFromAccountEntity(e,n,r){let o=e.getAccountInfo(),i=o.tenantProfiles||new Map,s=this.getTokenKeys();if(n){let c=i.get(n);if(c)i=new Map([[n,c]]);else return[]}let a=[];return i.forEach(c=>{let l=this.getTenantedAccountInfoByFilter(o,s,c,r);l&&a.push(l)}),a}tenantProfileMatchesFilter(e,n){return!(n.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,n.localAccountId)||n.name&&e.name!==n.name||n.isHomeTenant!==void 0&&e.isHomeTenant!==n.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,n){return!(n&&(n.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,n.localAccountId)||n.loginHint&&!this.matchLoginHintFromTokenClaims(e,n.loginHint)||n.username&&!this.matchUsername(e.preferred_username,n.username)||n.name&&!this.matchName(e,n.name)||n.sid&&!this.matchSid(e,n.sid)))}saveCacheRecord(e,n,r){return f(this,null,function*(){if(!e)throw v(no);try{e.account&&this.setAccount(e.account),e.idToken&&n?.idToken!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&n?.accessToken!==!1&&(yield this.saveAccessToken(e.accessToken)),e.refreshToken&&n?.refreshToken!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(o){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),o instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${o.message}`,r),o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED"||o.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new Pn(Xl)):new Pn(o.name,o.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${o}`,r),new Pn(Ra))}})}saveAccessToken(e){return f(this,null,function*(){let n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=me.fromString(e.target),i=[];r.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,n,!1))return;let a=this.getAccessTokenCredential(s);a&&this.credentialMatchesFilter(a,n)&&me.fromString(a.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(s))}),yield Promise.all(i),this.setAccessTokenCredential(e)})}getAccountsFilteredBy(e){let n=this.getAccountKeys(),r=[];return n.forEach(o=>{if(!this.isAccountKey(o,e.homeAccountId))return;let i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;let s={localAccountId:e?.localAccountId,name:e?.name},a=i.tenantProfiles?.filter(c=>this.tenantProfileMatchesFilter(c,s));a&&a.length===0||r.push(i)}),r}isAccountKey(e,n,r){return!(e.split(Ee.CACHE_KEY_SEPARATOR).length<3||n&&!e.toLowerCase().includes(n.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(Ee.CACHE_KEY_SEPARATOR).length<6)return!1;let n=e.toLowerCase();if(n.indexOf(N.ID_TOKEN.toLowerCase())===-1&&n.indexOf(N.ACCESS_TOKEN.toLowerCase())===-1&&n.indexOf(N.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&n.indexOf(N.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(n.indexOf(N.REFRESH_TOKEN.toLowerCase())>-1){let r=`${N.REFRESH_TOKEN}${Ee.CACHE_KEY_SEPARATOR}${this.clientId}${Ee.CACHE_KEY_SEPARATOR}`,o=`${N.REFRESH_TOKEN}${Ee.CACHE_KEY_SEPARATOR}${er}${Ee.CACHE_KEY_SEPARATOR}`;if(n.indexOf(r.toLowerCase())===-1&&n.indexOf(o.toLowerCase())===-1)return!1}else if(n.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,n){return!(n.clientId&&!this.matchClientId(e,n.clientId)||n.userAssertionHash&&!this.matchUserAssertionHash(e,n.userAssertionHash)||typeof n.homeAccountId=="string"&&!this.matchHomeAccountId(e,n.homeAccountId)||n.environment&&!this.matchEnvironment(e,n.environment)||n.realm&&!this.matchRealm(e,n.realm)||n.credentialType&&!this.matchCredentialType(e,n.credentialType)||n.familyId&&!this.matchFamilyId(e,n.familyId)||n.target&&!this.matchTarget(e,n.target)||(n.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==n.requestedClaimsHash||e.credentialType===N.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(n.tokenType&&!this.matchTokenType(e,n.tokenType)||n.tokenType===$.SSH&&n.keyId&&!this.matchKeyId(e,n.keyId)))}getAppMetadataFilteredBy(e){let n=this.getKeys(),r={};return n.forEach(o=>{if(!this.isAppMetadata(o))return;let i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(r[o]=i))}),r}getAuthorityMetadataByAlias(e){let n=this.getAuthorityMetadataKeys(),r=null;return n.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;let i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(r=i)}),r}removeAllAccounts(){return f(this,null,function*(){let e=this.getAccountKeys(),n=[];e.forEach(r=>{n.push(this.removeAccount(r))}),yield Promise.all(n)})}removeAccount(e){return f(this,null,function*(){let n=this.getAccount(e,this.commonLogger);n&&(yield this.removeAccountContext(n),this.removeItem(e))})}removeAccountContext(e){return f(this,null,function*(){let n=this.getTokenKeys(),r=e.generateAccountId(),o=[];n.idToken.forEach(i=>{i.indexOf(r)===0&&this.removeIdToken(i)}),n.accessToken.forEach(i=>{i.indexOf(r)===0&&o.push(this.removeAccessToken(i))}),n.refreshToken.forEach(i=>{i.indexOf(r)===0&&this.removeRefreshToken(i)}),yield Promise.all(o)})}updateOutdatedCachedAccount(e,n,r){if(n&&n.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");let o=this.getAccountKeys().filter(l=>l.startsWith(n.homeAccountId)),i=[];o.forEach(l=>{let u=this.getCachedAccountEntity(l);u&&i.push(u)});let s=i.find(l=>_a(l.realm,l.homeAccountId))||i[0];s.tenantProfiles=i.map(l=>({tenantId:l.realm,localAccountId:l.localAccountId,name:l.name,isHomeTenant:_a(l.realm,l.homeAccountId)}));let a=t.toObject(new de,m({},s)),c=a.generateAccountKey();return o.forEach(l=>{l!==c&&this.removeOutdatedAccount(e)}),this.setAccount(a),r?.verbose("Updated an outdated account entity in the cache"),a}return n}removeAccessToken(e){return f(this,null,function*(){let n=this.getAccessTokenCredential(e);if(n){if(n.credentialType.toLowerCase()===N.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&n.tokenType===$.POP){let o=n.keyId;if(o)try{yield this.cryptoImpl.removeTokenBindingKey(o)}catch{throw v(io)}}return this.removeItem(e)}})}removeAppMetadata(){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n)}),!0}readAccountFromCache(e){let n=de.generateAccountCacheKey(e);return this.getAccount(n,this.commonLogger)}getIdToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getIdToken called");let s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:N.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(s,n),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let l=a;if(!r){let u=new Map;a.forEach((g,y)=>{g.realm===e.tenantId&&u.set(y,g)});let h=u.size;if(h<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(h===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;l=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((u,h)=>{this.removeIdToken(h)}),o&&i&&o.addFields({multiMatchedID:a.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,n){let r=n&&n.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,m({clientId:this.clientId},e)))return;let s=this.getIdTokenCredential(i);s&&this.credentialMatchesFilter(s,e)&&o.set(i,s)}),o}idTokenKeyMatchesFilter(e,n){let r=e.toLowerCase();return!(n.clientId&&r.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&r.indexOf(n.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,n,r,o,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");let a=me.createSearchScopes(n.scopes),c=n.authenticationScheme||$.BEARER,l=c&&c.toLowerCase()!==$.BEARER.toLowerCase()?N.ACCESS_TOKEN_WITH_AUTH_SCHEME:N.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:c,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},h=r&&r.accessToken||this.getTokenKeys().accessToken,g=[];h.forEach(I=>{if(this.accessTokenKeyMatchesFilter(I,u,!0)){let T=this.getAccessTokenCredential(I);T&&this.credentialMatchesFilter(T,u)&&g.push(T)}});let y=g.length;return y<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):y>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),g.forEach(I=>{this.removeAccessToken(Sa(I))}),i&&s&&i.addFields({multiMatchedAT:g.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),g[0])}accessTokenKeyMatchesFilter(e,n,r){let o=e.toLowerCase();if(n.clientId&&o.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&o.indexOf(n.homeAccountId.toLowerCase())===-1||n.realm&&o.indexOf(n.realm.toLowerCase())===-1||n.requestedClaimsHash&&o.indexOf(n.requestedClaimsHash.toLowerCase())===-1)return!1;if(n.target){let i=n.target.asArray();for(let s=0;s<i.length;s++){if(r&&!o.includes(i[s].toLowerCase()))return!1;if(!r&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){let n=this.getTokenKeys(),r=[];return n.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;let i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&r.push(i)}),r}getRefreshToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let s=n?er:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:N.REFRESH_TOKEN,clientId:this.clientId,familyId:s},c=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(h=>{if(this.refreshTokenKeyMatchesFilter(h,a)){let g=this.getRefreshTokenCredential(h);g&&this.credentialMatchesFilter(g,a)&&l.push(g)}});let u=l.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&o&&i&&o.addFields({multiMatchedRT:u},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,n){let r=e.toLowerCase();return!(n.familyId&&r.indexOf(n.familyId.toLowerCase())===-1||!n.familyId&&n.clientId&&r.indexOf(n.clientId.toLowerCase())===-1||n.homeAccountId&&r.indexOf(n.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let n={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(n),o=Object.keys(r).map(s=>r[s]),i=o.length;if(i<1)return null;if(i>1)throw v(Zr);return o[0]}isAppMetadataFOCI(e){let n=this.readAppMetadataFromCache(e);return!!(n&&n.familyId===er)}matchHomeAccountId(e,n){return typeof e.homeAccountId=="string"&&n===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,n){let r=e.oid||e.sub;return n===r}matchLocalAccountIdFromTenantProfile(e,n){return e.localAccountId===n}matchName(e,n){return n.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,n){return!!(e&&typeof e=="string"&&n?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,n){return!!(e.userAssertionHash&&n===e.userAssertionHash)}matchEnvironment(e,n){if(this.staticAuthorityOptions){let o=IC(this.staticAuthorityOptions,this.commonLogger);if(o.includes(n)&&o.includes(e.environment))return!0}let r=this.getAuthorityMetadataByAlias(n);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,n){return e.credentialType&&n.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,n){return!!(e.clientId&&n===e.clientId)}matchFamilyId(e,n){return!!(e.familyId&&n===e.familyId)}matchRealm(e,n){return e.realm?.toLowerCase()===n.toLowerCase()}matchNativeAccountId(e,n){return!!(e.nativeAccountId&&n===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,n){return e.login_hint===n||e.preferred_username===n||e.upn===n}matchSid(e,n){return e.sid===n}matchAuthorityType(e,n){return!!(e.authorityType&&n.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,n){return e.credentialType!==N.ACCESS_TOKEN&&e.credentialType!==N.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:me.fromString(e.target).containsScopeSet(n)}matchTokenType(e,n){return!!(e.tokenType&&e.tokenType===n)}matchKeyId(e,n){return!!(e.keyId&&e.keyId===n)}isAppMetadata(e){return e.indexOf(Ys)!==-1}isAuthorityMetadata(e){return e.indexOf(li.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${li.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,n){for(let r in n)e[r]=n[r];return e}},Ma=class extends xn{setAccount(){throw v(F)}getAccount(){throw v(F)}getCachedAccountEntity(){throw v(F)}setIdTokenCredential(){throw v(F)}getIdTokenCredential(){throw v(F)}setAccessTokenCredential(){throw v(F)}getAccessTokenCredential(){throw v(F)}setRefreshTokenCredential(){throw v(F)}getRefreshTokenCredential(){throw v(F)}setAppMetadata(){throw v(F)}getAppMetadata(){throw v(F)}setServerTelemetry(){throw v(F)}getServerTelemetry(){throw v(F)}setAuthorityMetadata(){throw v(F)}getAuthorityMetadata(){throw v(F)}getAuthorityMetadataKeys(){throw v(F)}setThrottlingCache(){throw v(F)}getThrottlingCache(){throw v(F)}removeItem(){throw v(F)}getKeys(){throw v(F)}getAccountKeys(){throw v(F)}getTokenKeys(){throw v(F)}clear(){return f(this,null,function*(){throw v(F)})}updateCredentialCacheKey(){throw v(F)}removeOutdatedAccount(){throw v(F)}};var eu={tokenRenewalOffsetSeconds:Tf,preventCorsPreflight:!1},Cb={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:oe.Info,correlationId:p.EMPTY_STRING},Eb={claimsBasedCachingEnabled:!1},Ib={sendGetRequestAsync(){return f(this,null,function*(){throw v(F)})},sendPostRequestAsync(){return f(this,null,function*(){throw v(F)})}},Tb={sku:p.SKU,version:hi,cpu:p.EMPTY_STRING,os:p.EMPTY_STRING},wb={clientSecret:p.EMPTY_STRING,clientAssertion:void 0},Ab={azureCloudInstance:lr.None,tenant:`${p.DEFAULT_COMMON_TENANT}`},Sb={application:{appName:"",appVersion:""}};function bC({authOptions:t,systemOptions:e,loggerOptions:n,cacheOptions:r,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:h,serializableCache:g}){let y=m(m({},Cb),n);return{authOptions:Db(t),systemOptions:m(m({},eu),e),loggerOptions:y,cacheOptions:m(m({},Eb),r),storageInterface:o||new Ma(t.clientId,dr,new At(y)),networkInterface:i||Ib,cryptoInterface:s||dr,clientCredentials:a||wb,libraryInfo:m(m({},Tb),c),telemetry:m(m({},Sb),l),serverTelemetryManager:u||null,persistencePlugin:h||null,serializableCache:g||null}}function Db(t){return m({clientCapabilities:[],azureCloudOptions:Ab,skipAuthorityMetadataCache:!1},t)}function Na(t){return t.authOptions.authority.options.protocolMode===Ue.OIDC}var Je=class t extends G{constructor(e,n,r,o){super(e,n,r),this.name="ServerError",this.errorNo=o,Object.setPrototypeOf(this,t.prototype)}};var sn=class t{static generateThrottlingStorageKey(e){return`${Sn.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,n){let r=t.generateThrottlingStorageKey(n),o=e.getThrottlingCache(r);if(o){if(o.throttleTime<Date.now()){e.removeItem(r);return}throw new Je(o.errorCodes?.join(" ")||p.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,n,r){if(t.checkResponseStatus(r)||t.checkResponseForRetryAfter(r)){let o={throttleTime:t.calculateThrottleTime(parseInt(r.headers[qe.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(t.generateThrottlingStorageKey(n),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(qe.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let n=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(n||Sn.DEFAULT_THROTTLE_TIME_SECONDS),r+Sn.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,n,r,o){let i={clientId:n,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},s=this.generateThrottlingStorageKey(i);e.removeItem(s)}};var tu=class{constructor(e,n){this.networkClient=e,this.cacheManager=n}sendPostRequest(e,n,r){return f(this,null,function*(){sn.preProcess(this.cacheManager,e);let o;try{o=yield this.networkClient.sendPostRequestAsync(n,r)}catch(i){throw i instanceof G?i:v(zr)}return sn.postProcess(this.cacheManager,e,o),o})}};var ke={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var $t=class{static validateRedirectUri(e){if(!e)throw z(lo)}static validatePrompt(e){let n=[];for(let r in he)n.push(he[r]);if(n.indexOf(e)<0)throw z(po)}static validateClaims(e){try{JSON.parse(e)}catch{throw z(Mn)}}static validateCodeChallengeParams(e,n){if(!e||!n)throw z(Nn);this.validateCodeChallengeMethod(n)}static validateCodeChallengeMethod(e){if([xl.PLAIN,xl.S256].indexOf(e)<0)throw z(yo)}static sanitizeEQParams(e,n){return e?(n.forEach((r,o)=>{e[o]&&delete e[o]}),Object.fromEntries(Object.entries(e).filter(r=>r[1]!==""))):{}}};var an=class{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(Kl,encodeURIComponent(p.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Kl,encodeURIComponent(`${p.TOKEN_RESPONSE_TYPE} ${p.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(xf,encodeURIComponent(e||If.QUERY))}addNativeBroker(){this.parameters.set(dp,encodeURIComponent("1"))}addScopes(e,n=!0,r=ht){n&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");let o=n?[...e||[],...r]:e||[],i=new me(o);this.parameters.set(Uf,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(ur,encodeURIComponent(e))}addRedirectUri(e){$t.validateRedirectUri(e),this.parameters.set(Pf,encodeURIComponent(e))}addPostLogoutRedirectUri(e){$t.validateRedirectUri(e),this.parameters.set(rp,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(op,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(gp,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(pp,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(qe.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(qe.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(fp,encodeURIComponent(e))}addClaims(e,n){let r=this.addClientCapabilitiesToClaims(e,n);$t.validateClaims(r),this.parameters.set(Ff,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(Kf,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(Wf,e.sku),this.parameters.set(Yf,e.version),e.os&&this.parameters.set(Qf,e.os),e.cpu&&this.parameters.set(Jf,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(tp,e.appName),e?.appVersion&&this.parameters.set(np,e.appVersion)}addPrompt(e){$t.validatePrompt(e),this.parameters.set(`${Vf}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(Bf,encodeURIComponent(e))}addNonce(e){this.parameters.set(jf,encodeURIComponent(e))}addCodeChallengeParams(e,n){if($t.validateCodeChallengeParams(e,n),e&&n)this.parameters.set(Gf,encodeURIComponent(e)),this.parameters.set(qf,encodeURIComponent(n));else throw z(Nn)}addAuthorizationCode(e){this.parameters.set($f,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(ip,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(Hf,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(zf,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(sp,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(ap,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(cp,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(lp,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(up,encodeURIComponent(e))}addGrantType(e){this.parameters.set(Lf,encodeURIComponent(e))}addClientInfo(){this.parameters.set(hC,"1")}addExtraQueryParameters(e){let n=$t.sanitizeEQParams(e,this.parameters);Object.keys(n).forEach(r=>{this.parameters.set(r,e[r])})}addClientCapabilitiesToClaims(e,n){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw z(Mn)}return n&&n.length>0&&(r.hasOwnProperty(ai.ACCESS_TOKEN)||(r[ai.ACCESS_TOKEN]={}),r[ai.ACCESS_TOKEN][ai.XMS_CC]={values:n}),JSON.stringify(r)}addUsername(e){this.parameters.set(Fl.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Fl.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Wl,$.POP),this.parameters.set(Yl,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Wl,$.SSH),this.parameters.set(Yl,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(Zf,e.generateCurrentRequestHeaderValue()),this.parameters.set(Xf,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(ep,Sn.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(hp,encodeURIComponent(e))}createQueryString(){let e=new Array;return this.parameters.forEach((n,r)=>{e.push(`${r}=${n}`)}),e.join("&")}};var hr=class{constructor(e,n){this.config=bC(e),this.logger=new At(this.config.loggerOptions,Jl,hi),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new tu(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=n}createTokenRequestHeaders(e){let n={};if(n[qe.CONTENT_TYPE]=p.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case ke.HOME_ACCOUNT_ID:try{let r=On(e.credential);n[qe.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case ke.UPN:n[qe.CCS_HEADER]=`UPN: ${e.credential}`;break}return n}executePostToTokenEndpoint(e,n,r,o,i,s){return f(this,null,function*(){s&&this.performanceClient?.addQueueMeasurement(s,i);let a=yield this.networkManager.sendPostRequest(o,e,{body:n,headers:r});return this.performanceClient?.addFields({refreshTokenSize:a.body.refresh_token?.length||0,httpVerToken:a.headers?.[qe.X_MS_HTTP_VERSION]||""},i),this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a})}updateAuthority(e,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.UpdateTokenEndpointAuthority,n);let r=`https://${e}/${this.authority.tenant}/`,o=yield Of(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,n,this.performanceClient);this.authority=o})}createTokenQueryParameters(e){let n=new an;return e.tokenQueryParameters&&n.addExtraQueryParameters(e.tokenQueryParameters),n.createQueryString()}};var Ln={};_t(Ln,{badToken:()=>pr,consentRequired:()=>vp,interactionRequired:()=>yp,loginRequired:()=>Cp,nativeAccountUnavailable:()=>ka,noTokensFound:()=>fr,refreshTokenExpired:()=>Oa});var fr="no_tokens_found",ka="native_account_unavailable",Oa="refresh_token_expired",yp="interaction_required",vp="consent_required",Cp="login_required",pr="bad_token";var _C=[yp,vp,Cp,pr],bb=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],nu={[fr]:"No refresh token found in the cache. Please sign-in.",[ka]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Oa]:"Refresh token has expired.",[pr]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},RC={noTokensFoundError:{code:fr,desc:nu[fr]},native_account_unavailable:{code:ka,desc:nu[ka]},bad_token:{code:pr,desc:nu[pr]}},He=class t extends G{constructor(e,n,r,o,i,s,a,c){super(e,n,r),Object.setPrototypeOf(this,t.prototype),this.timestamp=o||p.EMPTY_STRING,this.traceId=i||p.EMPTY_STRING,this.correlationId=s||p.EMPTY_STRING,this.claims=a||p.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function Ep(t,e,n){let r=!!t&&_C.indexOf(t)>-1,o=!!n&&bb.indexOf(n)>-1,i=!!e&&_C.some(s=>e.indexOf(s)>-1);return r||i||o}function gi(t){return new He(t,nu[t])}var pt=class{constructor(e,n,r,o,i){this.account=e||null,this.idToken=n||null,this.accessToken=r||null,this.refreshToken=o||null,this.appMetadata=i||null}};var Oe=class t{static setRequestState(e,n,r){let o=t.generateLibraryState(e,r);return n?`${o}${p.RESOURCE_DELIM}${n}`:o}static generateLibraryState(e,n){if(!e)throw v(ir);let r={id:e.createNewGuid()};n&&(r.meta=n);let o=JSON.stringify(r);return e.base64Encode(o)}static parseRequestState(e,n){if(!e)throw v(ir);if(!n)throw v(jt);try{let r=n.split(p.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(p.RESOURCE_DELIM):p.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||p.EMPTY_STRING,libraryState:a}}catch{throw v(jt)}}};var _b={SW:"sw",UHW:"uhw"},gt=class{constructor(e,n){this.cryptoUtils=e,this.performanceClient=n}generateCnf(e,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.PopTokenGenerateCnf,e.correlationId);let r=yield C(this.generateKid.bind(this),d.PopTokenGenerateCnf,n,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:o}})}generateKid(e){return f(this,null,function*(){return this.performanceClient?.addQueueMeasurement(d.PopTokenGenerateKid,e.correlationId),{kid:yield this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:_b.SW}})}signPopToken(e,n,r){return f(this,null,function*(){return this.signPayload(e,n,r)})}signPayload(e,n,r,o){return f(this,null,function*(){let{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:a,shrNonce:c,shrOptions:l}=r,h=(s?new H(s):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt(m({at:e,ts:ft(),m:i?.toUpperCase(),u:h?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:h?.AbsolutePath,q:h?.QueryString?[[],h.QueryString]:void 0,client_claims:a||void 0},o),n,l,r.correlationId)})}};var ru=class{constructor(e,n){this.cache=e,this.hasChanged=n}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};function Rb(t){let e="code=",n=t.error_uri?.lastIndexOf(e);return n&&n>=0?t.error_uri?.substring(n+e.length):void 0}var cn=class t{constructor(e,n,r,o,i,s,a){this.clientId=e,this.cacheStorage=n,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,n){if(!e.state||!n)throw e.state?v(rr,"Cached State"):v(rr,"Server State");let r,o;try{r=decodeURIComponent(e.state)}catch{throw v(jt,e.state)}try{o=decodeURIComponent(n)}catch{throw v(jt,e.state)}if(r!==o)throw v(Yr);if(e.error||e.error_description||e.suberror){let i=Rb(e);throw Ep(e.error,e.error_description,e.suberror)?new He(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new Je(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,n){if(e.error||e.error_description||e.suberror){let r=`${e.error_codes} - [${e.timestamp}]: ${e.error_description} - Correlation ID: ${e.correlation_id} - Trace ID: ${e.trace_id}`,o=e.error_codes?.length?e.error_codes[0]:void 0,i=new Je(e.error,r,e.suberror,o);if(n&&e.status&&e.status>=si.SERVER_ERROR_RANGE_START&&e.status<=si.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${i}`);return}else if(n&&e.status&&e.status>=si.CLIENT_ERROR_RANGE_START&&e.status<=si.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${i}`);return}throw Ep(e.error,e.error_description,e.suberror)?new He(e.error,e.error_description,e.suberror,e.timestamp||p.EMPTY_STRING,e.trace_id||p.EMPTY_STRING,e.correlation_id||p.EMPTY_STRING,e.claims||p.EMPTY_STRING,o):i}}handleServerTokenResponse(e,n,r,o,i,s,a,c,l){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=Rn(e.id_token||p.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw v(Qr);if(o.maxAge||o.maxAge===0){let I=u.auth_time;if(!I)throw v(Dn);pa(I,o.maxAge)}}this.homeAccountIdentifier=de.generateHomeAccountId(e.client_info||p.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,u);let h;i&&i.state&&(h=Oe.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;let g=this.generateCacheRecord(e,n,r,o,u,s,i),y;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),y=new ru(this.serializableCache,!0),yield this.persistencePlugin.beforeCacheAccess(y)),a&&!c&&g.account){let I=g.account.generateAccountKey();if(!this.cacheStorage.getAccount(I,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield t.generateAuthenticationResult(this.cryptoObj,n,g,!1,o,u,h,void 0,l)}yield this.cacheStorage.saveCacheRecord(g,o.storeInCache,o.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&y&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield this.persistencePlugin.afterCacheAccess(y))}return t.generateAuthenticationResult(this.cryptoObj,n,g,!1,o,u,h,e,l)})}generateCacheRecord(e,n,r,o,i,s,a){let c=n.getPreferredCache();if(!c)throw v(_n);let l=Zl(i),u,h;e.id_token&&i&&(u=Rf(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),h=mi(this.cacheStorage,n,this.homeAccountIdentifier,i,this.cryptoObj.base64Decode,e.client_info,c,l,a,void 0,this.logger));let g=null;if(e.access_token){let T=e.scope?me.fromString(e.scope):new me(o.scopes||[]),b=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,_=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,se=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,re=r+b,ne=re+_,Fe=se&&se>0?r+se:void 0;g=Mf(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||n.tenant||"",T.printScopes(),re,ne,this.cryptoObj.base64Decode,Fe,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let y=null;if(e.refresh_token){let T;if(e.refresh_token_expires_in){let b=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;T=r+b}y=Nf(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,s,T)}let I=null;return e.foci&&(I={clientId:this.clientId,environment:c,familyId:e.foci}),new pt(h,u,g,y,I)}static generateAuthenticationResult(e,n,r,o,i,s,a,c,l){return f(this,null,function*(){let u=p.EMPTY_STRING,h=[],g=null,y,I,T=p.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===$.POP&&!i.popKid){let re=new gt(e),{secret:ne,keyId:Fe}=r.accessToken;if(!Fe)throw v(ao);u=yield re.signPopToken(ne,Fe,i)}else u=r.accessToken.secret;h=me.fromString(r.accessToken.target).asArray(),g=new Date(Number(r.accessToken.expiresOn)*1e3),y=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(I=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(T=r.appMetadata.familyId===er?er:"");let b=s?.oid||s?.sub||"",_=s?.tid||"";c?.spa_accountid&&r.account&&(r.account.nativeAccountId=c?.spa_accountid);let se=r.account?Eo(r.account.getAccountInfo(),void 0,s,r.idToken?.secret):null;return{authority:n.canonicalAuthority,uniqueId:b,tenantId:_,scopes:h,account:se,idToken:r?.idToken?.secret||"",idTokenClaims:s||{},accessToken:u,fromCache:o,expiresOn:g,extExpiresOn:y,refreshOn:I,correlationId:i.correlationId,requestId:l||p.EMPTY_STRING,familyId:T,tokenType:r.accessToken?.tokenType||p.EMPTY_STRING,state:a?a.userRequestState:p.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||p.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||p.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}})}};function mi(t,e,n,r,o,i,s,a,c,l,u){u?.verbose("setCachedAccount called");let g=t.getAccountKeys().find(b=>b.startsWith(n)),y=null;g&&(y=t.getAccount(g,u));let I=y||de.createAccount({homeAccountId:n,idTokenClaims:r,clientInfo:i,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},e,o),T=I.tenantProfiles||[];if(a&&!T.find(b=>b.tenantId===a)){let b=pi(n,r);T.push(b)}return I.tenantProfiles=T,I}var Io=class extends hr{constructor(e,n){super(e,n),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}getAuthCodeUrl(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.GetAuthCodeUrl,e.correlationId);let n=yield C(this.createAuthCodeUrlQueryString.bind(this),d.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return H.appendQueryString(this.authority.authorizationEndpoint,n)})}acquireToken(e,n){return f(this,null,function*(){if(this.performanceClient?.addQueueMeasurement(d.AuthClientAcquireToken,e.correlationId),!e.code)throw v(Xr);let r=ft(),o=yield C(this.executeTokenRequest.bind(this),d.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=o.headers?.[qe.X_MS_REQUEST_ID],s=new cn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),C(s.handleServerTokenResponse.bind(s),d.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,r,e,n,void 0,void 0,void 0,i)})}handleFragmentResponse(e,n){if(new cn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,n),!e.code)throw v(oo);return e}getLogoutUri(e){if(!e)throw z(mo);let n=this.createLogoutUrlQueryString(e);return H.appendQueryString(this.authority.endSessionEndpoint,n)}executeTokenRequest(e,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthClientExecuteTokenRequest,n.correlationId);let r=this.createTokenQueryParameters(n),o=H.appendQueryString(e.tokenEndpoint,r),i=yield C(this.createTokenRequestBody.bind(this),d.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,n.correlationId)(n),s;if(n.clientInfo)try{let l=fi(n.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${l.uid}${Ee.CLIENT_INFO_SEPARATOR}${l.utid}`,type:ke.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let a=this.createTokenRequestHeaders(s||n.ccsCredential),c={clientId:n.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:n.scopes,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid};return C(this.executePostToTokenEndpoint.bind(this),d.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,n.correlationId)(o,i,a,c,n.correlationId,d.AuthorizationCodeClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthClientCreateTokenRequestBody,e.correlationId);let n=new an;if(n.addClientId(e.tokenBodyParameters?.[ur]||this.config.authOptions.clientId),this.includeRedirectUri?n.addRedirectUri(e.redirectUri):$t.validateRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.oidcDefaultScopes),n.addAuthorizationCode(e.code),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!Na(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&n.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let i=this.config.clientCredentials.clientAssertion;n.addClientAssertion(yield zl(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(i.assertionType)}if(n.addGrantType(Ws.AUTHORIZATION_CODE_GRANT),n.addClientInfo(),e.authenticationScheme===$.POP){let i=new gt(this.cryptoUtils,this.performanceClient),s;e.popKid?s=this.cryptoUtils.encodeKid(e.popKid):s=(yield C(i.generateCnf.bind(i),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(s)}else if(e.authenticationScheme===$.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw z(kn);let r=e.correlationId||this.config.cryptoInterface.createNewGuid();n.addCorrelationId(r),(!ge.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities);let o;if(e.clientInfo)try{let i=fi(e.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${i.uid}${Ee.CLIENT_INFO_SEPARATOR}${i.utid}`,type:ke.HOME_ACCOUNT_ID}}catch(i){this.logger.verbose("Could not parse client info for CCS Header: "+i)}else o=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case ke.HOME_ACCOUNT_ID:try{let i=On(o.credential);n.addCcsOid(i)}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case ke.UPN:n.addCcsUpn(o.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Ql])&&n.addExtraQueryParameters({[Ql]:"1"}),n.createQueryString()})}createAuthCodeUrlQueryString(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthClientCreateQueryString,e.correlationId);let n=new an;n.addClientId(e.extraQueryParameters?.[ur]||this.config.authOptions.clientId);let r=[...e.scopes||[],...e.extraScopesToConsent||[]];n.addScopes(r,!0,this.oidcDefaultScopes),n.addRedirectUri(e.redirectUri);let o=e.correlationId||this.config.cryptoInterface.createNewGuid();if(n.addCorrelationId(o),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),Na(this.config)||n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==he.SELECT_ACCOUNT)if(e.sid&&e.prompt===he.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){let i=this.extractAccountSid(e.account),s=this.extractLoginHint(e.account);if(s&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(s);try{let a=On(e.account.homeAccountId);n.addCcsOid(a)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i&&e.prompt===he.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(i);try{let a=On(e.account.homeAccountId);n.addCcsOid(a)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{let a=On(e.account.homeAccountId);n.addCcsOid(a)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===$.POP)){let i=new gt(this.cryptoUtils),s;e.popKid?s=this.cryptoUtils.encodeKid(e.popKid):s=(yield C(i.generateCnf.bind(i),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(s)}return n.createQueryString()})}createLogoutUrlQueryString(e){let n=new an;return e.postLogoutRedirectUri&&n.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&n.addCorrelationId(e.correlationId),e.idTokenHint&&n.addIdTokenHint(e.idTokenHint),e.state&&n.addState(e.state),e.logoutHint&&n.addLogoutHint(e.logoutHint),e.extraQueryParameters&&n.addExtraQueryParameters(e.extraQueryParameters),n.createQueryString()}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}};var Mb=300,gr=class extends hr{constructor(e,n){super(e,n)}acquireToken(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientAcquireToken,e.correlationId);let n=ft(),r=yield C(this.executeTokenRequest.bind(this),d.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=r.headers?.[qe.X_MS_REQUEST_ID],i=new cn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),C(i.handleServerTokenResponse.bind(i),d.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,void 0,void 0,!0,e.forceCache,o)})}acquireTokenByRefreshToken(e){return f(this,null,function*(){if(!e)throw z(go);if(this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw v(bn);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield C(this.acquireTokenWithCachedRefreshToken.bind(this),d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(r){let o=r instanceof He&&r.errorCode===fr,i=r instanceof Je&&r.errorCode===Ll.INVALID_GRANT_ERROR&&r.subError===Ll.CLIENT_MISMATCH_ERROR;if(o||i)return C(this.acquireTokenWithCachedRefreshToken.bind(this),d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw r}return C(this.acquireTokenWithCachedRefreshToken.bind(this),d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)})}acquireTokenWithCachedRefreshToken(e,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let r=Qe(this.cacheManager.getRefreshToken.bind(this.cacheManager),d.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,n,void 0,this.performanceClient,e.correlationId);if(!r)throw gi(fr);if(r.expiresOn&&ui(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||Mb))throw gi(Oa);let o=S(m({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||$.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:ke.HOME_ACCOUNT_ID}});try{return yield C(this.acquireToken.bind(this),d.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(i){if(i instanceof He&&i.subError===pr){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let s=Sa(r);this.cacheManager.removeRefreshToken(s)}throw i}})}executeTokenRequest(e,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientExecuteTokenRequest,e.correlationId);let r=this.createTokenQueryParameters(e),o=H.appendQueryString(n.tokenEndpoint,r),i=yield C(this.createTokenRequestBody.bind(this),d.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:n.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return C(this.executePostToTokenEndpoint.bind(this),d.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,s,a,e.correlationId,d.RefreshTokenClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let n=e.correlationId,r=new an;if(r.addClientId(e.tokenBodyParameters?.[ur]||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),r.addGrantType(Ws.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!Na(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addCorrelationId(n),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;r.addClientAssertion(yield zl(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(o.assertionType)}if(e.authenticationScheme===$.POP){let o=new gt(this.cryptoUtils,this.performanceClient),i;e.popKid?i=this.cryptoUtils.encodeKid(e.popKid):i=(yield C(o.generateCnf.bind(o),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(i)}else if(e.authenticationScheme===$.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw z(kn);if((!ge.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case ke.HOME_ACCOUNT_ID:try{let o=On(e.ccsCredential.credential);r.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case ke.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()})}};var Pa=class extends hr{constructor(e,n){super(e,n)}acquireToken(e){return f(this,null,function*(){try{let[n,r]=yield this.acquireCachedToken(S(m({},e),{scopes:e.scopes?.length?e.scopes:[...ht]}));return r===Bt.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new gr(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),n}catch(n){if(n instanceof co&&n.errorCode===rn)return new gr(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw n}})}acquireCachedToken(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.SilentFlowClientAcquireCachedToken,e.correlationId);let n=Bt.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!ge.isEmptyObj(e.claims))throw this.setCacheOutcome(Bt.FORCE_REFRESH_OR_CLAIMS,e.correlationId),v(rn);if(!e.account)throw v(bn);let r=e.account.tenantId||DC(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,r,this.performanceClient,e.correlationId);if(i){if(_f(i.cachedAt)||ui(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Bt.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),v(rn);i.refreshOn&&ui(i.refreshOn,0)&&(n=Bt.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Bt.NO_CACHED_ACCESS_TOKEN,e.correlationId),v(rn);let s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(n,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[yield C(this.generateResultFromCacheRecord.bind(this),d.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),n]})}setCacheOutcome(e,n){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},n),e!==Bt.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}generateResultFromCacheRecord(e,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.SilentFlowClientGenerateResultFromCacheRecord,n.correlationId);let r;if(e.idToken&&(r=Rn(e.idToken.secret,this.config.cryptoInterface.base64Decode)),n.maxAge||n.maxAge===0){let o=r?.auth_time;if(!o)throw v(Dn);pa(o,n.maxAge)}return cn.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,n,r)})}};var Ip={sendGetRequestAsync:()=>Promise.reject(v(F)),sendPostRequestAsync:()=>Promise.reject(v(F))};var ou="missing_kid_error",iu="missing_alg_error";var Nb={[ou]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[iu]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Tp=class t extends G{constructor(e,n){super(e,n),this.name="JoseHeaderError",Object.setPrototypeOf(this,t.prototype)}};function wp(t){return new Tp(t,Nb[t])}var xa=class t{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw wp(ou);if(!e.alg)throw wp(iu);let n=new t({typ:e.typ||Hl.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(n)}};var La=class t{constructor(e,n){this.cacheOutcome=Bt.NOT_APPLICABLE,this.cacheManager=n,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||p.EMPTY_STRING,this.wrapperVer=e.wrapperVer||p.EMPTY_STRING,this.telemetryCacheKey=Me.CACHE_KEY+Ee.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Me.VALUE_SEPARATOR}${this.cacheOutcome}`,n=[this.wrapperSKU,this.wrapperVer].join(Me.VALUE_SEPARATOR),r=this.getRegionDiscoveryFields(),o=[e,r].join(Me.VALUE_SEPARATOR);return[Me.SCHEMA_VERSION,o,n].join(Me.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),n=t.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*n).join(Me.VALUE_SEPARATOR),o=e.errors.slice(0,n).join(Me.VALUE_SEPARATOR),i=e.errors.length,s=n<i?Me.OVERFLOW_TRUE:Me.OVERFLOW_FALSE,a=[i,s].join(Me.VALUE_SEPARATOR);return[Me.SCHEMA_VERSION,e.cacheHits,r,o,a].join(Me.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let n=this.getLastRequests();n.errors.length>=Me.MAX_CACHED_ERRORS&&(n.failedRequests.shift(),n.failedRequests.shift(),n.errors.shift()),n.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof G?e.subError?n.errors.push(e.subError):e.errorCode?n.errors.push(e.errorCode):n.errors.push(e.toString()):n.errors.push(e.toString()):n.errors.push(Me.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),n=t.maxErrorsToSend(e),r=e.errors.length;if(n===r)this.cacheManager.removeItem(this.telemetryCacheKey);else{let o={failedRequests:e.failedRequests.slice(n*2),errors:e.errors.slice(n),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let n,r=0,o=0,i=e.errors.length;for(n=0;n<i;n++){let s=e.failedRequests[2*n]||p.EMPTY_STRING,a=e.failedRequests[2*n+1]||p.EMPTY_STRING,c=e.errors[n]||p.EMPTY_STRING;if(o+=s.toString().length+a.toString().length+c.length+3,o<Me.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||p.EMPTY_STRING),e.push(this.regionSource||p.EMPTY_STRING),e.push(this.regionOutcome||p.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}};var su=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},yi=class{generateId(){return"callback-id"}startMeasurement(e,n){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:bf.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:n||""},measurement:new su}}startPerformanceMeasurement(){return new su}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var To="pkce_not_created",vi="crypto_nonexistent",ln="empty_navigate_uri",Ci="hash_empty_error",mr="no_state_in_hash",Ei="hash_does_not_contain_known_properties",Ii="unable_to_parse_state",Ti="state_interaction_type_mismatch",wi="interaction_in_progress",Ai="popup_window_error",Si="empty_window_error",ot="user_cancelled",au="monitor_popup_timeout",Di="monitor_window_timeout",bi="redirect_in_iframe",_i="block_iframe_reload",Ri="block_nested_popups",cu="iframe_closed_prematurely",un="silent_logout_unsupported",Mi="no_account_error",lu="silent_prompt_value_error",Ni="no_token_request_cache_error",ki="unable_to_parse_token_request_cache_error",yr="no_cached_authority_error",uu="auth_request_not_set_error",du="invalid_cache_type",Oi="non_browser_environment",dn="database_not_open",Fn="no_network_connectivity",Pi="post_request_failed",xi="get_request_failed",wo="failed_to_parse_response",Ze="unable_to_load_token",vr="crypto_key_not_found",Li="auth_code_required",Fi="auth_code_or_nativeAccountId_required",Ui="spa_code_and_nativeAccountId_present",Cr="database_unavailable",Hi="unable_to_acquire_token_from_native_platform",Bi="native_handshake_timeout",ji="native_extension_not_installed",St="native_connection_not_established",Vi="uninitialized_public_client_application",$i="native_prompt_not_supported",Gi="invalid_base64_string",qi="invalid_pop_token_request";var Un="For more visit: aka.ms/msaljs/browser-errors",P={[To]:"The PKCE code challenge and verifier could not be generated.",[vi]:"The crypto object or function is not available.",[ln]:"Navigation URI is empty. Please check stack trace for more info.",[Ci]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Un}`,[mr]:"Hash does not contain state. Please verify that the request originated from msal.",[Ei]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Un}`,[Ii]:"Unable to parse state. Please verify that the request originated from msal.",[Ti]:"Hash contains state but the interaction type does not match the caller.",[wi]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Un}`,[Ai]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Si]:"window.open returned null or undefined window object.",[ot]:"User cancelled the flow.",[au]:`Token acquisition in popup failed due to timeout.  ${Un}`,[Di]:`Token acquisition in iframe failed due to timeout.  ${Un}`,[bi]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[_i]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Un}`,[Ri]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[cu]:"The iframe being monitored was closed prematurely.",[un]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Mi]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[lu]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Ni]:"No token request found in cache.",[ki]:"The cached token request could not be parsed.",[yr]:"No cached authority found.",[uu]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[du]:"Invalid cache type",[Oi]:"Login and token requests are not supported in non-browser environments.",[dn]:"Database is not open!",[Fn]:"No network connectivity. Check your internet connection.",[Pi]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[xi]:"Network request failed. Please check the network trace to determine root cause.",[wo]:"Failed to parse network response. Check network trace.",[Ze]:"Error loading token to cache.",[vr]:"Cryptographic Key or Keypair not found in browser storage.",[Li]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Fi]:"An authorization code or nativeAccountId must be provided to this flow.",[Ui]:"Request cannot contain both spa code and native account id.",[Cr]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Hi]:`Unable to acquire token from native platform.  ${Un}`,[Bi]:"Timed out while attempting to establish connection to browser extension",[ji]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[St]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Un}`,[Vi]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Un}`,[$i]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Gi]:"Invalid base64 encoded string.",[qi]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true."},QB={pkceNotGenerated:{code:To,desc:P[To]},cryptoDoesNotExist:{code:vi,desc:P[vi]},emptyNavigateUriError:{code:ln,desc:P[ln]},hashEmptyError:{code:Ci,desc:P[Ci]},hashDoesNotContainStateError:{code:mr,desc:P[mr]},hashDoesNotContainKnownPropertiesError:{code:Ei,desc:P[Ei]},unableToParseStateError:{code:Ii,desc:P[Ii]},stateInteractionTypeMismatchError:{code:Ti,desc:P[Ti]},interactionInProgress:{code:wi,desc:P[wi]},popupWindowError:{code:Ai,desc:P[Ai]},emptyWindowError:{code:Si,desc:P[Si]},userCancelledError:{code:ot,desc:P[ot]},monitorPopupTimeoutError:{code:au,desc:P[au]},monitorIframeTimeoutError:{code:Di,desc:P[Di]},redirectInIframeError:{code:bi,desc:P[bi]},blockTokenRequestsInHiddenIframeError:{code:_i,desc:P[_i]},blockAcquireTokenInPopupsError:{code:Ri,desc:P[Ri]},iframeClosedPrematurelyError:{code:cu,desc:P[cu]},silentLogoutUnsupportedError:{code:un,desc:P[un]},noAccountError:{code:Mi,desc:P[Mi]},silentPromptValueError:{code:lu,desc:P[lu]},noTokenRequestCacheError:{code:Ni,desc:P[Ni]},unableToParseTokenRequestCacheError:{code:ki,desc:P[ki]},noCachedAuthorityError:{code:yr,desc:P[yr]},authRequestNotSet:{code:uu,desc:P[uu]},invalidCacheType:{code:du,desc:P[du]},notInBrowserEnvironment:{code:Oi,desc:P[Oi]},databaseNotOpen:{code:dn,desc:P[dn]},noNetworkConnectivity:{code:Fn,desc:P[Fn]},postRequestFailed:{code:Pi,desc:P[Pi]},getRequestFailed:{code:xi,desc:P[xi]},failedToParseNetworkResponse:{code:wo,desc:P[wo]},unableToLoadTokenError:{code:Ze,desc:P[Ze]},signingKeyNotFoundInStorage:{code:vr,desc:P[vr]},authCodeRequired:{code:Li,desc:P[Li]},authCodeOrNativeAccountRequired:{code:Fi,desc:P[Fi]},spaCodeAndNativeAccountPresent:{code:Ui,desc:P[Ui]},databaseUnavailable:{code:Cr,desc:P[Cr]},unableToAcquireTokenFromNativePlatform:{code:Hi,desc:P[Hi]},nativeHandshakeTimeout:{code:Bi,desc:P[Bi]},nativeExtensionNotInstalled:{code:ji,desc:P[ji]},nativeConnectionNotEstablished:{code:St,desc:P[St]},uninitializedPublicClientApplication:{code:Vi,desc:P[Vi]},nativePromptNotSupported:{code:$i,desc:P[$i]},invalidBase64StringError:{code:Gi,desc:P[Gi]},invalidPopTokenRequest:{code:qi,desc:P[qi]}},Ao=class t extends G{constructor(e){super(e,P[e]),Object.setPrototypeOf(this,t.prototype),this.name="BrowserAuthError"}};function E(t){return new Ao(t)}var Be={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},So={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Hn={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},ce={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Ap={GET:"GET",POST:"POST"},J={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},Bn={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},Fa={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},ee={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962},w=function(t){return t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none",t}(w||{}),fe={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},Sp={scopes:ht},Dp="jwk",bp={React:"@azure/msal-react",Angular:"@azure/msal-angular"},hu="msal.db",MC=1,NC=`${hu}.keys`,Xe={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},kC=[Xe.Default,Xe.Skip,Xe.RefreshTokenAndNetwork],OC="msal.browser.log.level",PC="msal.browser.log.pii";function Ua(t){return encodeURIComponent(Ha(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Do(t){return xC(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ha(t){return xC(new TextEncoder().encode(t))}function xC(t){let e=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(e)}var kb="RSASSA-PKCS1-v1_5",UC="SHA-256",Ob=2048,Pb=new Uint8Array([1,0,1]),LC="0123456789abcdef",FC=new Uint32Array(1),Rp={name:kb,hash:UC,modulusLength:Ob,publicExponent:Pb};function HC(t){if("crypto"in window)t.verbose("BrowserCrypto: modern crypto interface available");else throw t.error("BrowserCrypto: crypto interface is unavailable"),E(vi)}function Mp(t,e,n){return f(this,null,function*(){e?.addQueueMeasurement(d.Sha256Digest,n);let o=new TextEncoder().encode(t);return window.crypto.subtle.digest(UC,o)})}function BC(t){return window.crypto.getRandomValues(t)}function _p(){return window.crypto.getRandomValues(FC),FC[0]}function Le(){let t=Date.now(),e=_p()*1024+(_p()&1023),n=new Uint8Array(16),r=Math.trunc(e/2**30),o=e&2**30-1,i=_p();n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/2**16,n[4]=t/2**8,n[5]=t,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let s="";for(let a=0;a<n.length;a++)s+=LC.charAt(n[a]>>>4),s+=LC.charAt(n[a]&15),(a===3||a===5||a===7||a===9)&&(s+="-");return s}function jC(t,e){return f(this,null,function*(){return window.crypto.subtle.generateKey(Rp,t,e)})}function fu(t){return f(this,null,function*(){return window.crypto.subtle.exportKey(Dp,t)})}function VC(t,e,n){return f(this,null,function*(){return window.crypto.subtle.importKey(Dp,t,Rp,e,n)})}function $C(t,e){return f(this,null,function*(){return window.crypto.subtle.sign(Rp,t,e)})}function pu(t){return f(this,null,function*(){let e=yield Mp(t),n=new Uint8Array(e);return Do(n)})}var zi="storage_not_supported",gu="stubbed_public_client_application_called",Ki="in_mem_redirect_unavailable";var mu={[zi]:"Given storage configuration option was not supported.",[gu]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Ki]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},xb={storageNotSupportedError:{code:zi,desc:mu[zi]},stubPcaInstanceCalled:{code:gu,desc:mu[gu]},inMemRedirectUnavailable:{code:Ki,desc:mu[Ki]}},bo=class t extends G{constructor(e,n){super(e,n),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,t.prototype)}};function yu(t){return new bo(t,mu[t])}function Np(t){t.location.hash="",typeof t.history.replaceState=="function"&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function kp(t){let e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Ba(){return window.parent!==window}function GC(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Be.POPUP_NAME_PREFIX}.`)===0}function it(){return window.location.href.split("?")[0].split("#")[0]}function Op(){let e=new H(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function qC(){if(H.hashContainsKnownProperties(window.location.hash)&&Ba())throw E(_i)}function zC(t){if(Ba()&&!t)throw E(bi)}function KC(){if(GC())throw E(Ri)}function WC(){if(typeof window>"u")throw E(Oi)}function vu(t){if(!t)throw E(Vi)}function ja(t){WC(),qC(),KC(),vu(t)}function Cu(t,e){if(ja(t),zC(e.system.allowRedirectInIframe),e.cache.cacheLocation===ce.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw yu(Ki)}function Va(t){let e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function Lb(){return Le()}var $a=class t{navigateInternal(e,n){return t.defaultNavigateWindow(e,n)}navigateExternal(e,n){return t.defaultNavigateWindow(e,n)}static defaultNavigateWindow(e,n){return n.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},n.timeout)})}};var Iu=class{sendGetRequestAsync(e,n){return f(this,null,function*(){let r;try{r=yield fetch(e,{method:Ap.GET,headers:this.getFetchHeaders(n)})}catch{throw window.navigator.onLine?E(xi):E(Fn)}try{return{headers:this.getHeaderDict(r.headers),body:yield r.json(),status:r.status}}catch{throw E(wo)}})}sendPostRequestAsync(e,n){return f(this,null,function*(){let r=n&&n.body||p.EMPTY_STRING,o;try{o=yield fetch(e,{method:Ap.POST,headers:this.getFetchHeaders(n),body:r})}catch{throw window.navigator.onLine?E(Pi):E(Fn)}try{return{headers:this.getHeaderDict(o.headers),body:yield o.json(),status:o.status}}catch{throw E(wo)}})}getFetchHeaders(e){let n=new Headers;if(!(e&&e.headers))return n;let r=e.headers;return Object.keys(r).forEach(o=>{n.append(o,r[o])}),n}getHeaderDict(e){let n={};return e.forEach((r,o)=>{n[o]=r}),n}};var Fb=6e4,Tu=1e4,Ub=3e4,Hb=2e3;function YC({auth:t,cache:e,system:n,telemetry:r},o){let i={clientId:p.EMPTY_STRING,authority:`${p.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:p.EMPTY_STRING,authorityMetadata:p.EMPTY_STRING,redirectUri:p.EMPTY_STRING,postLogoutRedirectUri:p.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Ue.AAD,OIDCOptions:{serverResponseType:Ht.FRAGMENT,defaultScopes:[p.OPENID_SCOPE,p.PROFILE_SCOPE,p.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:lr.None,tenant:p.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},s={cacheLocation:ce.SessionStorage,temporaryCacheLocation:ce.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===ce.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:oe.Info,piiLoggingEnabled:!1},c=S(m({},eu),{loggerOptions:a,networkClient:o?new Iu:Ip,navigationClient:new $a,loadFrameTimeout:0,windowHashTimeout:n?.loadFrameTimeout||Fb,iframeHashTimeout:n?.loadFrameTimeout||Tu,navigateFrameWait:0,redirectNavigationTimeout:Ub,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:n?.nativeBrokerHandshakeTimeout||Hb,pollIntervalMilliseconds:Be.DEFAULT_POLL_INTERVAL_MS}),l=S(m(m({},c),n),{loggerOptions:n?.loggerOptions||a}),u={application:{appName:p.EMPTY_STRING,appVersion:p.EMPTY_STRING},client:new yi};if(t?.protocolMode!==Ue.OIDC&&t?.OIDCOptions&&new At(l.loggerOptions).warning(JSON.stringify(z(Vt.cannotSetOIDCOptions))),t?.protocolMode&&t.protocolMode!==Ue.AAD&&l?.allowNativeBroker)throw z(Vt.cannotAllowNativeBroker);return{auth:S(m(m({},i),t),{OIDCOptions:m(m({},i.OIDCOptions),t?.OIDCOptions)}),cache:m(m({},s),e),system:l,telemetry:m(m({},u),r)}}var QC="@azure/msal-browser",Wi="3.17.0";var wu=class t{static loggerCallback(e,n){switch(e){case oe.Error:console.error(n);return;case oe.Info:console.info(n);return;case oe.Verbose:console.debug(n);return;case oe.Warning:console.warn(n);return;default:console.log(n);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=YC(e,this.browserEnvironment);let n;try{n=window[ce.SessionStorage]}catch{}let r=n?.getItem(OC),o=n?.getItem(PC)?.toLowerCase(),i=o==="true"?!0:o==="false"?!1:void 0,s=m({},this.config.system.loggerOptions),a=r&&Object.keys(oe).includes(r)?oe[r]:void 0;a&&(s.loggerCallback=t.loggerCallback,s.logLevel=a),i!==void 0&&(s.piiLoggingEnabled=i),this.logger=new At(s,QC,Wi),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}};var Au=(()=>{class t extends wu{getModuleName(){return t.MODULE_NAME}getId(){return t.ID}initialize(){return f(this,null,function*(){return this.available=typeof window<"u",this.available})}}return t.MODULE_NAME="",t.ID="StandardOperatingContext",t})();function st(t){return new TextDecoder().decode(Bb(t))}function Bb(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw E(Gi)}let n=atob(e);return Uint8Array.from(n,r=>r.codePointAt(0)||0)}var Su=class{constructor(){this.dbName=hu,this.version=MC,this.tableName=NC,this.dbOpen=!1}open(){return f(this,null,function*(){return new Promise((e,n)=>{let r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",o=>{o.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",o=>{let i=o;this.db=i.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>n(E(Cr)))})})}closeConnection(){let e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}validateDbIsOpen(){return f(this,null,function*(){if(!this.dbOpen)return this.open()})}getItem(e){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(E(dn));let s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);s.addEventListener("success",a=>{let c=a;this.closeConnection(),n(c.target.result)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})})}setItem(e,n){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((r,o)=>{if(!this.db)return o(E(dn));let a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(n,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",c=>{this.closeConnection(),o(c)})})})}removeItem(e){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(E(dn));let s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);s.addEventListener("success",()=>{this.closeConnection(),n()}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})})}getKeys(){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((e,n)=>{if(!this.db)return n(E(dn));let i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",s=>{let a=s;this.closeConnection(),e(a.target.result)}),i.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}containsKey(e){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(E(dn));let s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);s.addEventListener("success",a=>{let c=a;this.closeConnection(),n(c.target.result===1)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})})}deleteDatabase(){return f(this,null,function*(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,n)=>{let r=window.indexedDB.deleteDatabase(hu),o=setTimeout(()=>n(!1),200);r.addEventListener("success",()=>(clearTimeout(o),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(o),e(!0))),r.addEventListener("error",()=>(clearTimeout(o),n(!1)))})})}};var _o=class{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,n){this.cache.set(e,n)}removeItem(e){this.cache.delete(e)}getKeys(){let e=[];return this.cache.forEach((n,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}};var Du=class{constructor(e){this.inMemoryCache=new _o,this.indexedDBCache=new Su,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Ao&&e.errorCode===Cr)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}getItem(e){return f(this,null,function*(){let n=this.inMemoryCache.getItem(e);if(!n)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return n})}setItem(e,n){return f(this,null,function*(){this.inMemoryCache.setItem(e,n);try{yield this.indexedDBCache.setItem(e,n)}catch(r){this.handleDatabaseAccessError(r)}})}removeItem(e){return f(this,null,function*(){this.inMemoryCache.removeItem(e);try{yield this.indexedDBCache.removeItem(e)}catch(n){this.handleDatabaseAccessError(n)}})}getKeys(){return f(this,null,function*(){let e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield this.indexedDBCache.getKeys()}catch(n){this.handleDatabaseAccessError(n)}return e})}containsKey(e){return f(this,null,function*(){let n=this.inMemoryCache.containsKey(e);if(!n)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return n})}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){return f(this,null,function*(){try{this.logger.verbose("Deleting persistent keystore");let e=yield this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}})}};var ZC=(()=>{class t{constructor(n,r){this.logger=n,HC(n),this.cache=new Du(this.logger),this.performanceClient=r}createNewGuid(){return Le()}base64Encode(n){return Ha(n)}base64Decode(n){return st(n)}base64UrlEncode(n){return Ua(n)}encodeKid(n){return this.base64UrlEncode(JSON.stringify({kid:n}))}getPublicKeyThumbprint(n){return f(this,null,function*(){let r=this.performanceClient?.startMeasurement(d.CryptoOptsGetPublicKeyThumbprint,n.correlationId),o=yield jC(t.EXTRACTABLE,t.POP_KEY_USAGES),i=yield fu(o.publicKey),s={e:i.e,kty:i.kty,n:i.n},a=JC(s),c=yield this.hashString(a),l=yield fu(o.privateKey),u=yield VC(l,!1,["sign"]);return yield this.cache.setItem(c,{privateKey:u,publicKey:o.publicKey,requestMethod:n.resourceRequestMethod,requestUri:n.resourceRequestUri}),r&&r.end({success:!0}),c})}removeTokenBindingKey(n){return f(this,null,function*(){return yield this.cache.removeItem(n),!(yield this.cache.containsKey(n))})}clearKeystore(){return f(this,null,function*(){this.cache.clearInMemory();try{return yield this.cache.clearPersistent(),!0}catch(n){return n instanceof Error?this.logger.error(`Clearing keystore failed with error: ${n.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}})}signJwt(n,r,o,i){return f(this,null,function*(){let s=this.performanceClient?.startMeasurement(d.CryptoOptsSignJwt,i),a=yield this.cache.getItem(r);if(!a)throw E(vr);let c=yield fu(a.publicKey),l=JC(c),u=Ua(JSON.stringify({kid:r})),h=xa.getShrHeaderString(S(m({},o?.header),{alg:c.alg,kid:u})),g=Ua(h);n.cnf={jwk:JSON.parse(l)};let y=Ua(JSON.stringify(n)),I=`${g}.${y}`,b=new TextEncoder().encode(I),_=yield $C(a.privateKey,b),se=Do(new Uint8Array(_)),re=`${I}.${se}`;return s&&s.end({success:!0}),re})}hashString(n){return f(this,null,function*(){return pu(n)})}}return t.POP_KEY_USAGES=["sign","verify"],t.EXTRACTABLE=!0,t})();function JC(t){return JSON.stringify(t,Object.keys(t).sort())}var Ga=class{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==ce.LocalStorage&&e!==ce.SessionStorage||!window[e])throw yu(zi)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,n){this.windowStorage.setItem(e,n)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}};function bu(t,e){if(!e)return null;try{return Oe.parseRequestState(t,e).libraryState.meta}catch{throw v(Ne.invalidState)}}var Yi=class t extends xn{constructor(e,n,r,o,i,s){super(e,r,o,i),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=n,this.logger=o,this.internalStorage=new _o,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),n.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=s}setupBrowserStorage(e){switch(e){case ce.LocalStorage:case ce.SessionStorage:try{return new Ga(e)}catch(n){this.logger.verbose(n);break}}return this.cacheConfig.cacheLocation=ce.MemoryStorage,new _o}setupTemporaryCacheStorage(e,n){switch(n){case ce.LocalStorage:case ce.SessionStorage:try{return new Ga(e||ce.SessionStorage)}catch(r){return this.logger.verbose(r),this.internalStorage}case ce.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){let e=`${p.CACHE_PREFIX}.${we.ID_TOKEN}`,n=`${p.CACHE_PREFIX}.${we.CLIENT_INFO}`,r=`${p.CACHE_PREFIX}.${we.ERROR}`,o=`${p.CACHE_PREFIX}.${we.ERROR_DESC}`,i=this.browserStorage.getItem(e),s=this.browserStorage.getItem(n),a=this.browserStorage.getItem(r),c=this.browserStorage.getItem(o),l=[i,s,a,c];[we.ID_TOKEN,we.CLIENT_INFO,we.ERROR,we.ERROR_DESC].forEach((h,g)=>{let y=l[g];y&&this.setTemporaryCache(h,y,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");let e=this.getItem(Bn.ACCOUNT_KEYS),n=this.getItem(`${Bn.TOKEN_KEYS}.${this.clientId}`);if(e&&n){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(o=>{if(this.isCredentialKey(o)){let i=this.getItem(o);if(i){let s=this.validateAndParseJson(i);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case N.ID_TOKEN:if(ue.isIdTokenEntity(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${o} found, saving key to token key map`);let a=s,c=this.updateCredentialCacheKey(o,a);this.addTokenKey(c,N.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${o}`);break;case N.ACCESS_TOKEN:case N.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(ue.isAccessTokenEntity(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${o} found, saving key to token key map`);let a=s,c=this.updateCredentialCacheKey(o,a);this.addTokenKey(c,N.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${o}`);break;case N.REFRESH_TOKEN:if(ue.isRefreshTokenEntity(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${o} found, saving key to token key map`);let a=s,c=this.updateCredentialCacheKey(o,a);this.addTokenKey(c,N.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${o}`);break}}}if(this.isAccountKey(o)){let i=this.getItem(o);if(i){let s=this.validateAndParseJson(i);s&&de.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${o} found, saving key to account key map`),this.addAccountKeyToMap(o))}}})}validateAndParseJson(e){try{let n=JSON.parse(e);return n&&typeof n=="object"?n:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,n){this.browserStorage.setItem(e,n)}getAccount(e,n){this.logger.trace("BrowserCacheManager.getAccount called");let r=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,r,n)}getCachedAccountEntity(e){let n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e),null;let r=this.validateAndParseJson(n);return!r||!de.isAccountEntity(r)?(this.removeAccountKeyFromMap(e),null):xn.toObject(new de,r)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");let n=e.generateAccountKey();this.setItem(n,JSON.stringify(e)),this.addAccountKeyToMap(n)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");let e=this.getItem(Bn.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);let n=this.getAccountKeys();n.indexOf(e)===-1?(n.push(e),this.setItem(Bn.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);let n=this.getAccountKeys(),r=n.indexOf(e);r>-1?(n.splice(r,1),this.setItem(Bn.ACCOUNT_KEYS,JSON.stringify(n)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e){return f(this,null,function*(){ls(t.prototype,this,"removeAccount").call(this,e),this.removeAccountKeyFromMap(e)})}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,N.ID_TOKEN)}removeAccessToken(e){return f(this,null,function*(){ls(t.prototype,this,"removeAccessToken").call(this,e),this.removeTokenKey(e,N.ACCESS_TOKEN)})}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,N.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");let e=this.getItem(`${Bn.TOKEN_KEYS}.${this.clientId}`);if(e){let n=this.validateAndParseJson(e);if(n&&n.hasOwnProperty("idToken")&&n.hasOwnProperty("accessToken")&&n.hasOwnProperty("refreshToken"))return n;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,n){this.logger.trace("BrowserCacheManager addTokenKey called");let r=this.getTokenKeys();switch(n){case N.ID_TOKEN:r.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case N.ACCESS_TOKEN:r.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case N.REFRESH_TOKEN:r.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${n}`),v(Ne.unexpectedCredentialType)}this.setItem(`${Bn.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,n){this.logger.trace("BrowserCacheManager removeTokenKey called");let r=this.getTokenKeys();switch(n){case N.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);let o=r.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case N.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);let i=r.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case N.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);let s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${n}`),v(Ne.unexpectedCredentialType)}this.setItem(`${Bn.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){let n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,N.ID_TOKEN),null;let r=this.validateAndParseJson(n);return!r||!ue.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,N.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");let n=ue.generateCredentialKey(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,N.ID_TOKEN)}getAccessTokenCredential(e){let n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,N.ACCESS_TOKEN),null;let r=this.validateAndParseJson(n);return!r||!ue.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,N.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");let n=ue.generateCredentialKey(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,N.ACCESS_TOKEN)}getRefreshTokenCredential(e){let n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,N.REFRESH_TOKEN),null;let r=this.validateAndParseJson(n);return!r||!ue.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,N.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");let n=ue.generateCredentialKey(e);this.setItem(n,JSON.stringify(e)),this.addTokenKey(n,N.REFRESH_TOKEN)}getAppMetadata(e){let n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;let r=this.validateAndParseJson(n);return!r||!ue.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");let n=ue.generateAppMetadataKey(e);this.setItem(n,JSON.stringify(e))}getServerTelemetry(e){let n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;let r=this.validateAndParseJson(n);return!r||!ue.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(n))}getAuthorityMetadata(e){let n=this.internalStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;let r=this.validateAndParseJson(n);return r&&ue.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(n=>this.isAuthorityMetadata(n))}setWrapperMetadata(e,n){this.internalStorage.setItem(Fa.WRAPPER_SKU,e),this.internalStorage.setItem(Fa.WRAPPER_VER,n)}getWrapperMetadata(){let e=this.internalStorage.getItem(Fa.WRAPPER_SKU)||p.EMPTY_STRING,n=this.internalStorage.getItem(Fa.WRAPPER_VER)||p.EMPTY_STRING;return[e,n]}setAuthorityMetadata(e,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(n))}getActiveAccount(){let e=this.generateCacheKey(we.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(e);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");let o=this.generateCacheKey(we.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;let s=this.getAccountInfoFilteredBy({localAccountId:i});return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}let r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){let n=this.generateCacheKey(we.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(we.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");let o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(n,JSON.stringify(o)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(r)}getThrottlingCache(e){let n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;let r=this.validateAndParseJson(n);return!r||!ue.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(n))}getTemporaryCache(e,n){let r=n?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){let i=this.getItemCookie(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}let o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===ce.LocalStorage){let i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,n,r){let o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(o,n))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}clear(){return f(this,null,function*(){yield this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(p.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(p.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()})}clearTokensAndKeysWithClaims(e){return f(this,null,function*(){e.addQueueMeasurement(d.ClearTokensAndKeysWithClaims);let n=this.getTokenKeys(),r=[];n.accessToken.forEach(o=>{let i=this.getAccessTokenCredential(o);i?.requestedClaimsHash&&o.includes(i.requestedClaimsHash.toLowerCase())&&r.push(this.removeAccessToken(o))}),yield Promise.all(r),r.length>0&&this.logger.warning(`${r.length} access tokens with claims in the cache keys have been removed from the cache.`)})}setItemCookie(e,n,r){let o=`${encodeURIComponent(e)}=${encodeURIComponent(n)};path=/;SameSite=Lax;`;if(r){let i=this.getCookieExpirationTime(r);o+=`expires=${i};`}this.cacheConfig.secureCookies&&(o+="Secure;"),document.cookie=o}getItemCookie(e){let n=`${encodeURIComponent(e)}=`,r=document.cookie.split(";");for(let o=0;o<r.length;o++){let i=r[o];for(;i.charAt(0)===" ";)i=i.substring(1);if(i.indexOf(n)===0)return decodeURIComponent(i.substring(n.length,i.length))}return p.EMPTY_STRING}clearMsalCookies(){let e=`${p.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(r=>{for(;r.charAt(0)===" ";)r=r.substring(1);if(r.indexOf(e)===0){let o=r.split("=")[0];this.clearItemCookie(o)}})}clearItemCookie(e){this.setItemCookie(e,p.EMPTY_STRING,-1)}getCookieExpirationTime(e){let n=new Date;return new Date(n.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):ge.startsWith(e,p.CACHE_PREFIX)||ge.startsWith(e,we.ADAL_ID_TOKEN)?e:`${p.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){let{libraryState:{id:n}}=Oe.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${J.AUTHORITY}.${n}`)}generateNonceKey(e){let{libraryState:{id:n}}=Oe.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${J.NONCE_IDTOKEN}.${n}`)}generateStateKey(e){let{libraryState:{id:n}}=Oe.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${J.REQUEST_STATE}.${n}`)}getCachedAuthority(e){let n=this.generateStateKey(e),r=this.getTemporaryCache(n);if(!r)return null;let o=this.generateAuthorityKey(r);return this.getTemporaryCache(o)}updateCacheEntries(e,n,r,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");let s=this.generateStateKey(e);this.setTemporaryCache(s,e,!1);let a=this.generateNonceKey(e);this.setTemporaryCache(a,n,!1);let c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,r,!1),i){let l={credential:i.homeAccountId,type:ke.HOME_ACCOUNT_ID};this.setTemporaryCache(J.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(o){let l={credential:o,type:ke.UPN};this.setTemporaryCache(J.CCS_CREDENTIAL,JSON.stringify(l),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(n=>{n.indexOf(e)!==-1&&this.removeTemporaryItem(n)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(J.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(J.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(J.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(J.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(J.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(J.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){let n=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(n);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||p.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(n=>{if(n.indexOf(J.REQUEST_STATE)===-1)return;let r=this.temporaryCacheStorage.getItem(n);if(!r)return;let o=bu(this.cryptoImpl,r);o&&o.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");let n=Ha(JSON.stringify(e));this.setTemporaryCache(J.REQUEST_PARAMS,n,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");let n=this.getTemporaryCache(J.REQUEST_PARAMS,!0);if(!n)throw E(Ni);let r;try{r=JSON.parse(st(n))}catch(o){throw this.logger.errorPii(`Attempted to parse: ${n}`),this.logger.error(`Parsing cached token request threw with error: ${o}`),E(ki)}if(this.removeTemporaryItem(this.generateCacheKey(J.REQUEST_PARAMS)),!r.authority){let o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw E(yr);r.authority=i}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");let e=this.getTemporaryCache(J.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;let n=this.validateAndParseJson(e);return n||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){let n=this.getInteractionInProgress();return e?n===this.clientId:!!n}getInteractionInProgress(){let e=`${p.CACHE_PREFIX}.${J.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){let n=`${p.CACHE_PREFIX}.${J.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw E(wi);this.setTemporaryCache(n,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(n)}getLegacyLoginHint(){let e=this.getTemporaryCache(we.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(we.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));let n=this.getTemporaryCache(we.ID_TOKEN,!0);n&&(this.browserStorage.removeItem(this.generateCacheKey(we.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));let r=n||e;if(r){let o=sr.extractTokenClaims(r,st);if(o.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.preferred_username;if(o.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,n){let r=ue.generateCredentialKey(n);if(e!==r){let o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(r,o),this.logger.verbose(`Updated an outdated ${n.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${n.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}hydrateCache(e,n){return f(this,null,function*(){let r=ue.createIdTokenEntity(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId),o;n.claims&&(o=yield this.cryptoImpl.hashString(n.claims));let i=ue.createAccessTokenEntity(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,st,void 0,e.tokenType,void 0,n.sshKid,n.claims,o),s=new pt(void 0,r,i);return this.saveCacheRecord(s)})}saveCacheRecord(e,n,r){return f(this,null,function*(){try{yield ls(t.prototype,this,"saveCacheRecord").call(this,e,n,r)}catch(o){if(o instanceof Pn&&this.performanceClient&&r)try{let i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},r)}catch{}throw o}})}},XC=(t,e)=>{let n={cacheLocation:ce.MemoryStorage,temporaryCacheLocation:ce.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Yi(t,n,dr,e)};function eE(t,e,n,r){return t.verbose("getAllAccounts called"),n?e.getAllAccounts(r):[]}function tE(t,e,n){if(e.trace("getAccount called"),Object.keys(t).length===0)return e.warning("getAccount: No accountFilter provided"),null;let r=n.getAccountInfoFilteredBy(t);return r?(e.verbose("getAccount: Account matching provided filter found, returning"),r):(e.verbose("getAccount: No matching account found, returning null"),null)}function nE(t,e,n){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;let r=n.getAccountInfoFilteredBy({username:t});return r?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),r):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function rE(t,e,n){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;let r=n.getAccountInfoFilteredBy({homeAccountId:t});return r?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),r):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function oE(t,e,n){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;let r=n.getAccountInfoFilteredBy({localAccountId:t});return r?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),r):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function iE(t,e){e.setActiveAccount(t)}function sE(t){return t.getActiveAccount()}var A={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};var _u=class{constructor(e,n){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=n,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if(typeof window<"u"){let n=Le();return this.eventCallbacks.set(n,e),this.logger.verbose(`Event callback registered with id: ${n}`),n}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,n,r,o){if(typeof window<"u"){let i={eventType:e,interactionType:n||null,payload:r||null,error:o||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${e}`),this.eventCallbacks.forEach((s,a)=>{this.logger.verbose(`Emitting event to callback ${a}: ${e}`),s.apply(null,[i])})}}handleAccountCacheChange(e){try{e.key?.includes(we.ACTIVE_ACCOUNT_FILTERS)&&this.emitEvent(A.ACTIVE_ACCOUNT_CHANGED);let n=e.newValue||e.oldValue;if(!n)return;let r=JSON.parse(n);if(typeof r!="object"||!de.isAccountEntity(r))return;let i=xn.toObject(new de,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(A.ACCOUNT_ADDED,void 0,i)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(A.ACCOUNT_REMOVED,void 0,i))}catch{return}}};var Qi=class{constructor(e,n,r,o,i,s,a,c,l){this.config=e,this.browserStorage=n,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=s,this.nativeMessageHandler=c,this.correlationId=l||Le(),this.logger=o.clone(Be.MSAL_SKU,Wi,this.correlationId),this.performanceClient=a}clearCacheOnLogout(e){return f(this,null,function*(){if(e){de.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{yield this.browserStorage.removeAccount(de.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),yield this.browserStorage.clear(),yield this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})}getRedirectUri(e){this.logger.verbose("getRedirectUri called");let n=e||this.config.auth.redirectUri||it();return H.getAbsoluteUrl(n,it())}initializeServerTelemetryManager(e,n){this.logger.verbose("initializeServerTelemetryManager called");let r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:n||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new La(r,this.browserStorage)}getDiscoveredAuthority(e,n,r){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);let o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e||this.config.auth.authority,s=wt.generateAuthority(i,n||this.config.auth.azureCloudOptions),a=yield C(ql.createDiscoveredInstance,d.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);if(r&&!a.isAlias(r.environment))throw z(Vt.authorityMismatch);return a})}};var jb=32;function aE(t,e,n){return f(this,null,function*(){t.addQueueMeasurement(d.GeneratePkceCodes,n);let r=Qe(Vb,d.GenerateCodeVerifier,e,t,n)(t,e,n),o=yield C($b,d.GenerateCodeChallengeFromVerifier,e,t,n)(r,t,e,n);return{verifier:r,challenge:o}})}function Vb(t,e,n){try{let r=new Uint8Array(jb);return Qe(BC,d.GetRandomValues,e,t,n)(r),Do(r)}catch{throw E(To)}}function $b(t,e,n,r){return f(this,null,function*(){e.addQueueMeasurement(d.GenerateCodeChallengeFromVerifier,r);try{let o=yield C(Mp,d.Sha256Digest,n,e,r)(t,e,r);return Do(new Uint8Array(o))}catch{throw E(To)}})}function qa(t,e,n,r){return f(this,null,function*(){n.addQueueMeasurement(d.InitializeBaseRequest,t.correlationId);let o=t.authority||e.auth.authority,i=[...t&&t.scopes||[]],s=S(m({},t),{correlationId:t.correlationId,authority:o,scopes:i});if(!s.authenticationScheme)s.authenticationScheme=$.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(s.authenticationScheme===$.SSH){if(!t.sshJwk)throw z(Vt.missingSshJwk);if(!t.sshKid)throw z(Vt.missingSshKid)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&t.claims&&!ge.isEmptyObj(t.claims)&&(s.requestedClaimsHash=yield pu(t.claims)),s})}function cE(t,e,n,r,o){return f(this,null,function*(){r.addQueueMeasurement(d.InitializeSilentRequest,t.correlationId);let i=yield C(qa,d.InitializeBaseRequest,o,r,t.correlationId)(t,n,r,o);return S(m(m({},t),i),{account:e,forceRefresh:t.forceRefresh||!1})})}var at=class extends Qi{initializeAuthorizationCodeRequest(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);let n=yield C(aE,d.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r=S(m({},e),{redirectUri:e.redirectUri,code:p.EMPTY_STRING,codeVerifier:n.verifier});return e.codeChallenge=n.challenge,e.codeChallengeMethod=p.S256_CODE_CHALLENGE_METHOD,r})}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);let n=m({correlationId:this.correlationId||Le()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){let r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=H.getAbsoluteUrl(e.postLogoutRedirectUri,it())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=H.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,it())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=H.getAbsoluteUrl(it(),it())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId),n}getLogoutHintFromIdTokenClaims(e){let n=e.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e,n,r,o){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientCreateAuthCodeClient,this.correlationId);let i=yield C(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,n,r,o);return new Io(i,this.performanceClient)})}getClientConfiguration(e,n,r,o){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientGetClientConfiguration,this.correlationId);let i=yield C(this.getDiscoveredAuthority.bind(this),d.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)(n,r,o),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:i,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Be.MSAL_SKU,version:Wi,cpu:p.EMPTY_STRING,os:p.EMPTY_STRING},telemetry:this.config.telemetry}})}initializeAuthorizationRequest(e,n){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);let r=this.getRedirectUri(e.redirectUri),o={interactionType:n},i=Oe.setRequestState(this.browserCrypto,e&&e.state||p.EMPTY_STRING,o),s=yield C(qa,d.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(S(m({},e),{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),a=S(m({},s),{redirectUri:r,state:i,nonce:e.nonce||Le(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),c=e.account||this.browserStorage.getActiveAccount();if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),a.account=c),!a.loginHint&&!c){let l=this.browserStorage.getLegacyLoginHint();l&&(a.loginHint=l)}return a})}};var lE="ContentError",Ru="user_switch";var uE="USER_INTERACTION_REQUIRED",dE="USER_CANCEL",hE="NO_NETWORK",fE="PERSISTENT_ERROR",pE="DISABLED",gE="ACCOUNT_UNAVAILABLE";var Gb=-2147186943,qb={[Ru]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Gt=class t extends G{constructor(e,n,r){super(e,n),Object.setPrototypeOf(this,t.prototype),this.name="NativeAuthError",this.ext=r}};function Er(t){if(t.ext&&t.ext.status&&(t.ext.status===fE||t.ext.status===pE)||t.ext&&t.ext.error&&t.ext.error===Gb)return!0;switch(t.errorCode){case lE:return!0;default:return!1}}function za(t,e,n){if(n&&n.status)switch(n.status){case gE:return gi(Ln.nativeAccountUnavailable);case uE:return new He(t,e);case dE:return E(ot);case hE:return E(Fn)}return new Gt(t,qb[t]||e,n)}var Ji=class extends at{acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.SilentCacheClientAcquireToken,e.correlationId);let n=this.initializeServerTelemetryManager(ee.acquireTokenSilent_silentFlow),r=yield C(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(n,e.authority,e.azureCloudOptions,e.account),o=new Pa(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{let s=(yield C(o.acquireCachedToken.bind(o),d.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),s}catch(i){throw i instanceof Ao&&i.errorCode===vr&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}})}logout(e){this.logger.verbose("logoutRedirect called");let n=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(n?.account)}};var Pp={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"},Dt=class extends Qi{constructor(e,n,r,o,i,s,a,c,l,u,h,g){super(e,n,r,o,i,s,c,l,g),this.apiId=a,this.accountId=u,this.nativeMessageHandler=l,this.nativeStorageManager=h,this.silentCacheClient=new Ji(e,this.nativeStorageManager,r,o,i,s,c,l,g)}acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");let n=this.performanceClient.startMeasurement(d.NativeInteractionClientAcquireToken,e.correlationId),r=Aa.nowSeconds(),o=yield this.initializeNativeRequest(e);try{let l=yield this.acquireTokensFromCache(this.accountId,o);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),l}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}let i=mn(o,[]),s={method:Hn.GetToken,request:i},a=yield this.nativeMessageHandler.sendMessage(s),c=this.validateNativeResponse(a);return this.handleNativeResponse(c,o,r).then(l=>(n.end({success:!0,isNativeBroker:!0,requestId:l.requestId}),l)).catch(l=>{throw n.end({success:!1,errorCode:l.errorCode,subErrorCode:l.subError,isNativeBroker:!0}),l})})}createSilentCacheRequest(e,n){return{authority:e.authority,correlationId:this.correlationId,scopes:me.fromString(e.scope).asArray(),account:n,forceRefresh:!1}}acquireTokensFromCache(e,n){return f(this,null,function*(){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),v(Ne.noAccountFound);let r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw v(Ne.noAccountFound);try{let o=this.createSilentCacheRequest(n,r),i=yield this.silentCacheClient.acquireToken(o),s=S(m({},r),{idTokenClaims:i?.idTokenClaims,idToken:i?.idToken});return S(m({},i),{account:s})}catch(o){throw o}})}acquireTokenRedirect(e,n){return f(this,null,function*(){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");let r=yield this.initializeNativeRequest(e),o=mn(r,[]),i={method:Hn.GetToken,request:o};try{let c=yield this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(c)}catch(c){if(c instanceof Gt&&Er(c))throw c}this.browserStorage.setTemporaryCache(J.NATIVE_REQUEST,JSON.stringify(r),!0);let s={apiId:ee.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);n.end({success:!0}),yield this.navigationClient.navigateExternal(a,s)})}handleRedirectPromise(e,n){return f(this,null,function*(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&n&&e?.addFields({errorCode:"no_cached_request"},n),null;let c=r,{prompt:o}=c,i=mn(c,["prompt"]);o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(J.NATIVE_REQUEST));let s={method:Hn.GetToken,request:i},a=Aa.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");let l=yield this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(l);let u=this.handleNativeResponse(l,i,a);return this.browserStorage.setInteractionInProgress(!1),yield u}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}})}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,n,r){return f(this,null,function*(){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");let o=sr.extractTokenClaims(e.id_token,st),i=this.createHomeAccountIdentifier(e,o),s=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:n.accountId})?.homeAccountId;if(i!==s&&e.account.id!==n.accountId)throw za(Ru);let a=yield this.getDiscoveredAuthority(n.authority),c=mi(this.browserStorage,a,i,o,st,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger),l=yield this.generateAuthenticationResult(e,n,o,c,a.canonicalAuthority,r);return this.cacheAccount(c),this.cacheNativeTokens(e,n,i,o,e.access_token,l.tenantId,r),l})}createHomeAccountIdentifier(e,n){return de.generateHomeAccountId(e.client_info||p.EMPTY_STRING,Ye.Default,this.logger,this.browserCrypto,n)}generateScopes(e,n){return e.scope?me.fromString(e.scope):me.fromString(n.scope)}generatePopAccessToken(e,n){return f(this,null,function*(){if(n.tokenType===$.POP&&n.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;let r=new gt(this.browserCrypto),o={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce};if(!n.keyId)throw v(Ne.keyIdMissing);return r.signPopToken(e.access_token,n.keyId,o)}else return e.access_token})}generateAuthenticationResult(e,n,r,o,i,s){return f(this,null,function*(){let a=this.addTelemetryFromNativeResponse(e),c=e.scope?me.fromString(e.scope):me.fromString(n.scope),l=e.account.properties||{},u=l.UID||r.oid||r.sub||p.EMPTY_STRING,h=l.TenantId||r.tid||p.EMPTY_STRING,g=Eo(o.getAccountInfo(),void 0,r,e.id_token);g.nativeAccountId!==e.account.id&&(g.nativeAccountId=e.account.id);let y=yield this.generatePopAccessToken(e,n),I=n.tokenType===$.POP?$.POP:$.BEARER;return{authority:i,uniqueId:u,tenantId:h,scopes:c.asArray(),account:g,idToken:e.id_token,idTokenClaims:r,accessToken:y,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(s+e.expires_in)*1e3),tokenType:I,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}})}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(n=>{this.logger.error(`Error occurred while removing account context from browser storage. ${n}`)})}cacheNativeTokens(e,n,r,o,i,s,a){let c=ue.createIdTokenEntity(r,n.authority,e.id_token||"",n.clientId,o.tid||""),l=n.tokenType===$.POP?p.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=a+l,h=this.generateScopes(e,n),g=ue.createAccessTokenEntity(r,n.authority,i,n.clientId,o.tid||s,h.printScopes(),u,0,st,void 0,n.tokenType,void 0,n.keyId),y=new pt(void 0,c,g);this.nativeStorageManager.saveCacheRecord(y,n.storeInCache)}addTelemetryFromNativeResponse(e){let n=this.getMATSFromResponse(e);return n?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:n.broker_version,matsAccountJoinOnStart:n.account_join_on_start,matsAccountJoinOnEnd:n.account_join_on_end,matsDeviceJoin:n.device_join,matsPromptBehavior:n.prompt_behavior,matsApiErrorCode:n.api_error_code,matsUiVisible:n.ui_visible,matsSilentCode:n.silent_code,matsSilentBiSubCode:n.silent_bi_sub_code,matsSilentMessage:n.silent_message,matsSilentStatus:n.silent_status,matsHttpStatus:n.http_status,matsHttpEventCount:n.http_event_count},this.correlationId),n):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Xs($r.unexpectedError,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){return f(this,null,function*(){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");let n=e.authority||this.config.auth.authority;e.account&&(yield this.getDiscoveredAuthority(n,e.azureCloudOptions,e.account));let r=new H(n);r.validateAsUri();let l=e,{scopes:o}=l,i=mn(l,["scopes"]),s=new me(o||[]);s.appendScopes(ht);let a=()=>{switch(this.apiId){case ee.ssoSilent:case ee.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),he.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case he.NONE:case he.CONSENT:case he.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),E($i)}},c=S(m({},i),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:m(m({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(c.signPopToken&&e.popKid)throw E(qi);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=So.MATS_TELEMETRY,e.authenticationScheme===$.POP){let u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},h=new gt(this.browserCrypto),g;if(c.keyId)g=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{let y=yield C(h.generateCnf.bind(h),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);g=y.reqCnfString,c.keyId=y.kid,c.signPopToken=!0}c.reqCnf=g}return c})}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(Pp.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(Pp.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(ba.CLIENT_ID)){let n=e.extraParameters[ba.CLIENT_ID],r=e.redirectUri,o=e.extraParameters[Pp.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:n,child_redirect_uri:r},e.redirectUri=o}}};var mt=class t{constructor(e,n,r,o){this.logger=e,this.handshakeTimeoutMs=n,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(d.NativeMessageHandlerHandshake)}sendMessage(e){return f(this,null,function*(){this.logger.trace("NativeMessageHandler - sendMessage called.");let n={channel:So.CHANNEL_ID,extensionId:this.extensionId,responseId:Le(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(n)}`),this.messageChannel.port1.postMessage(n),new Promise((r,o)=>{this.resolvers.set(n.responseId,{resolve:r,reject:o})})})}static createProvider(e,n,r){return f(this,null,function*(){e.trace("NativeMessageHandler - createProvider called.");try{let o=new t(e,n,r,So.PREFERRED_EXTENSION_ID);return yield o.sendHandshakeRequest(),o}catch{let i=new t(e,n,r);return yield i.sendHandshakeRequest(),i}})}sendHandshakeRequest(){return f(this,null,function*(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);let e={channel:So.CHANNEL_ID,extensionId:this.extensionId,responseId:Le(),body:{method:Hn.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=n=>{this.onChannelMessage(n)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((n,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:n,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(E(Bi)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;let n=e.data;if(!(!n.channel||n.channel!==So.CHANNEL_ID)&&!(n.extensionId&&n.extensionId!==this.extensionId)&&n.body.method===Hn.HandshakeRequest){let r=this.handshakeResolvers.get(n.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${n.responseId}`);return}this.logger.verbose(n.extensionId?`Extension with id: ${n.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(E(ji))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");let n=e.data,r=this.resolvers.get(n.responseId),o=this.handshakeResolvers.get(n.responseId);try{let i=n.body.method;if(i===Hn.Response){if(!r)return;let s=n.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(s)}`),s.status!=="Success")r.reject(za(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?r.reject(za(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result);else throw Xs($r.unexpectedError,"Event does not contain result.");this.resolvers.delete(n.responseId)}else if(i===Hn.HandshakeResponse){if(!o){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${n.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=n.extensionId,this.extensionVersion=n.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(n.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(i):o&&o.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,n,r,o){if(n.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return n.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return n.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case $.BEARER:case $.POP:return n.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return n.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}};var Ir=class{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}handleCodeResponse(e,n){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.HandleCodeResponse,n.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,n.state)}catch(o){throw o instanceof Je&&o.subError===ot?E(ot):o}return C(this.handleCodeResponseFromServer.bind(this),d.HandleCodeResponseFromServer,this.logger,this.performanceClient,n.correlationId)(r,n)})}handleCodeResponseFromServer(e,n,r=!0){return f(this,null,function*(){if(this.performanceClient.addQueueMeasurement(d.HandleCodeResponseFromServer,n.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(yield C(this.authModule.updateAuthority.bind(this.authModule),d.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,n.correlationId)(e.cloud_instance_host_name,n.correlationId)),r&&(e.nonce=n.nonce||void 0),e.state=n.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{let i=this.createCcsCredentials(n);i&&(this.authCodeRequest.ccsCredential=i)}return yield C(this.authModule.acquireToken.bind(this.authModule),d.AuthClientAcquireToken,this.logger,this.performanceClient,n.correlationId)(this.authCodeRequest,e)})}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:ke.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:ke.UPN}:null}};function Mu(t,e,n){let r=cr.getDeserializedResponse(t);if(!r)throw cr.stripLeadingHashOrQuery(t)?(n.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${e} detected is: ${t}`),E(Ei)):(n.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),E(Ci));return r}function mE(t,e,n){if(!t.state)throw E(mr);let r=bu(e,t.state);if(!r)throw E(Ii);if(r.interactionType!==n)throw E(Ti)}var Nu=class extends at{constructor(e,n,r,o,i,s,a,c,l,u){super(e,n,r,o,i,s,a,l,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c}acquireToken(e){try{let n=this.generatePopupName(e.scopes||ht,e.authority||this.config.auth.authority),r=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,r);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");let o=this.openSizedPopup("about:blank",n,r);return this.acquireTokenPopupAsync(e,n,r,o)}}catch(n){return Promise.reject(n)}}logout(e){try{this.logger.verbose("logoutPopup called");let n=this.initializeLogoutRequest(e),r=this.generateLogoutPopupName(n),o=e&&e.authority,i=e&&e.mainWindowRedirectUri,s=e?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,s,o,void 0,i);{this.logger.verbose("asyncPopup set to false, opening popup");let a=this.openSizedPopup("about:blank",r,s);return this.logoutPopupAsync(n,r,s,o,a,i)}}catch(n){return Promise.reject(n)}}acquireTokenPopupAsync(e,n,r,o){return f(this,null,function*(){this.logger.verbose("acquireTokenPopupAsync called");let i=this.initializeServerTelemetryManager(ee.acquireTokenPopup),s=yield C(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,w.Popup);Va(s.authority);try{let a=yield C(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(s),c=yield C(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(i,s.authority,s.azureCloudOptions,s.account),l=mt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme),u;l&&(u=this.performanceClient.startMeasurement(d.FetchAccountIdWithNativeBroker,e.correlationId));let h=yield c.getAuthCodeUrl(S(m({},s),{nativeBroker:l})),g=new Ir(c,this.browserStorage,a,this.logger,this.performanceClient),y={popup:o,popupName:n,popupWindowAttributes:r},I=this.initiateAuthRequest(h,y);this.eventHandler.emitEvent(A.POPUP_OPENED,w.Popup,{popupWindow:I},null);let T=yield this.monitorPopupForHash(I),b=Qe(Mu,d.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(T,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(sn.removeThrottle(this.browserStorage,this.config.auth.clientId,a),b.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw E(St);let se=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ee.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,b.accountId,this.nativeStorage,s.correlationId),{userRequestState:re}=Oe.parseRequestState(this.browserCrypto,s.state);return yield se.acquireToken(S(m({},s),{state:re,prompt:void 0}))}return yield g.handleCodeResponse(b,s)}catch(a){throw o&&o.close(),a instanceof G&&(a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a)),a}})}logoutPopupAsync(e,n,r,o,i,s){return f(this,null,function*(){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(A.LOGOUT_START,w.Popup,e);let a=this.initializeServerTelemetryManager(ee.logoutPopup);try{yield this.clearCacheOnLogout(e.account);let c=yield C(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(a,o,void 0,e.account||void 0);try{c.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&c.authority.protocolMode===Ue.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(A.LOGOUT_SUCCESS,w.Popup,e),s){let h={apiId:ee.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=H.getAbsoluteUrl(s,it());yield this.navigationClient.navigateInternal(g,h)}i&&i.close();return}}let l=c.getLogoutUri(e);this.eventHandler.emitEvent(A.LOGOUT_SUCCESS,w.Popup,e);let u=this.openPopup(l,{popupName:n,popupWindowAttributes:r,popup:i});if(this.eventHandler.emitEvent(A.POPUP_OPENED,w.Popup,{popupWindow:u},null),yield this.monitorPopupForHash(u).catch(()=>{}),s){let h={apiId:ee.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=H.getAbsoluteUrl(s,it());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${g}`),yield this.navigationClient.navigateInternal(g,h)}else this.logger.verbose("No main window navigation requested")}catch(c){throw i&&i.close(),c instanceof G&&(c.setCorrelationId(this.correlationId),a.cacheFailedRequest(c)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(A.LOGOUT_FAILURE,w.Popup,null,c),this.eventHandler.emitEvent(A.LOGOUT_END,w.Popup),c}this.eventHandler.emitEvent(A.LOGOUT_END,w.Popup)})}initiateAuthRequest(e,n){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,n);throw this.logger.error("Navigate url is empty"),E(ln)}monitorPopupForHash(e){return new Promise((n,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");let o=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(o),r(E(ot));return}let i="";try{i=e.location.href}catch{}if(!i||i==="about:blank")return;clearInterval(o);let s="",a=this.config.auth.OIDCOptions.serverResponseType;e&&(a===Ht.QUERY?s=e.location.search:s=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),n(s)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e)})}openPopup(e,n){try{let r;if(n.popup?(r=n.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof n.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,n.popupName,n.popupWindowAttributes)),!r)throw E(Si);return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),E(Ai)}}openSizedPopup(e,n,r){let o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=r.popupSize?.width,l=r.popupSize?.height,u=r.popupPosition?.top,h=r.popupPosition?.left;return(!c||c<0||c>s)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=Be.POPUP_WIDTH),(!l||l<0||l>a)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=Be.POPUP_HEIGHT),(!u||u<0||u>a)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,a/2-Be.POPUP_HEIGHT/2+i)),(!h||h<0||h>s)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,s/2-Be.POPUP_WIDTH/2+o)),window.open(e,n,`width=${c}, height=${l}, top=${u}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(w.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,n){return`${Be.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${n}.${this.correlationId}`}generateLogoutPopupName(e){let n=e.account&&e.account.homeAccountId;return`${Be.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${n}.${this.correlationId}`}};var Ka=class{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}initiateAuthRequest(e,n){return f(this,null,function*(){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){n.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(J.ORIGIN_URI,n.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(J.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);let r={apiId:ee.acquireTokenRedirect,timeout:n.redirectTimeout,noHistory:!1};if(typeof n.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),n.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),yield n.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),yield n.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),E(ln)})}handleCodeResponse(e,n){return f(this,null,function*(){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);let r=this.browserStorage.generateStateKey(n),o=this.browserStorage.getTemporaryCache(r);if(!o)throw v(Ne.stateNotFound,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,o)}catch(l){throw l instanceof Je&&l.subError===ot?E(ot):l}let s=this.browserStorage.generateNonceKey(o),a=this.browserStorage.getTemporaryCache(s);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&(yield C(this.authModule.updateAuthority.bind(this.authModule),d.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId)),i.nonce=a||void 0,i.state=o,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{let l=this.checkCcsCredentials();l&&(this.authCodeRequest.ccsCredential=l)}let c=yield this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(n),c})}checkCcsCredentials(){let e=this.browserStorage.getTemporaryCache(J.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}};var ku=class extends at{constructor(e,n,r,o,i,s,a,c,l,u){super(e,n,r,o,i,s,a,l,u),this.nativeStorage=c}acquireToken(e){return f(this,null,function*(){let n=yield C(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,w.Redirect);this.browserStorage.updateCacheEntries(n.state,n.nonce,n.authority,n.loginHint||"",n.account||null);let r=this.initializeServerTelemetryManager(ee.acquireTokenRedirect),o=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(n.state),this.eventHandler.emitEvent(A.RESTORE_FROM_BFCACHE,w.Redirect))};try{let i=yield C(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(n),s=yield C(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(r,n.authority,n.azureCloudOptions,n.account),a=new Ka(s,this.browserStorage,i,this.logger,this.performanceClient),c=yield s.getAuthCodeUrl(S(m({},n),{nativeBroker:mt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)})),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",o),yield a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate})}catch(i){throw i instanceof G&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(n.state),i}})}handleRedirectPromise(e="",n){return f(this,null,function*(){let r=this.initializeServerTelemetryManager(ee.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let[o,i]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(w.Redirect),n.event.errorCode="no_server_response",null;let s=this.browserStorage.getTemporaryCache(J.ORIGIN_URI,!0)||p.EMPTY_STRING,a=H.removeHashFromUrl(s),c=H.removeHashFromUrl(window.location.href);if(a===c&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&kp(s),yield this.handleResponse(o,r);if(this.config.auth.navigateToLoginRequestUrl){if(!Ba()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(J.URL_HASH,i,!0);let l={apiId:ee.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},u=!0;if(!s||s==="null"){let h=Op();this.browserStorage.setTemporaryCache(J.ORIGIN_URI,h,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=yield this.navigationClient.navigateInternal(h,l)}else this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),u=yield this.navigationClient.navigateInternal(s,l);if(!u)return yield this.handleResponse(o,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield this.handleResponse(o,r);return null}catch(o){throw o instanceof G&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.browserStorage.cleanRequestByInteractionType(w.Redirect),o}})}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let n=e;n||(this.config.auth.OIDCOptions.serverResponseType===Ht.QUERY?n=window.location.search:n=window.location.hash);let r=cr.getDeserializedResponse(n);if(r){try{mE(r,this.browserCrypto,w.Redirect)}catch(i){return i instanceof G&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return Np(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,n]}let o=this.browserStorage.getTemporaryCache(J.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(J.URL_HASH)),o&&(r=cr.getDeserializedResponse(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}handleResponse(e,n){return f(this,null,function*(){let r=e.state;if(!r)throw E(mr);let o=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw E(St);let c=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ee.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,o.correlationId),{userRequestState:l}=Oe.parseRequestState(this.browserCrypto,r);return c.acquireToken(S(m({},o),{state:l,prompt:void 0})).finally(()=>{this.browserStorage.cleanRequestByState(r)})}let i=this.browserStorage.getCachedAuthority(r);if(!i)throw E(yr);let s=yield C(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(n,i);return sn.removeThrottle(this.browserStorage,this.config.auth.clientId,o),new Ka(s,this.browserStorage,o,this.logger,this.performanceClient).handleCodeResponse(e,r)})}logout(e){return f(this,null,function*(){this.logger.verbose("logoutRedirect called");let n=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(ee.logout);try{this.eventHandler.emitEvent(A.LOGOUT_START,w.Redirect,e),yield this.clearCacheOnLogout(n.account);let o={apiId:ee.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=yield C(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(r,e&&e.authority,void 0,e&&e.account||void 0);if(i.authority.protocolMode===Ue.OIDC)try{i.authority.endSessionEndpoint}catch{if(n.account?.homeAccountId){this.browserStorage.removeAccount(n.account?.homeAccountId),this.eventHandler.emitEvent(A.LOGOUT_SUCCESS,w.Redirect,n);return}}let s=i.getLogoutUri(n);if(this.eventHandler.emitEvent(A.LOGOUT_SUCCESS,w.Redirect,n),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(s)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(s,o);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(s,o);return}}catch(o){throw o instanceof G&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.eventHandler.emitEvent(A.LOGOUT_FAILURE,w.Redirect,null,o),this.eventHandler.emitEvent(A.LOGOUT_END,w.Redirect),o}this.eventHandler.emitEvent(A.LOGOUT_END,w.Redirect)})}getRedirectStartPage(e){let n=e||window.location.href;return H.getAbsoluteUrl(n,it())}};function yE(t,e,n,r,o){return f(this,null,function*(){if(e.addQueueMeasurement(d.SilentHandlerInitiateAuthRequest,r),!t)throw n.info("Navigate url is empty"),E(ln);return o?C(zb,d.SilentHandlerLoadFrame,n,e,r)(t,o,e,r):Qe(Kb,d.SilentHandlerLoadFrameSync,n,e,r)(t)})}function vE(t,e,n,r,o,i,s){return f(this,null,function*(){return r.addQueueMeasurement(d.SilentHandlerMonitorIframeForHash,i),new Promise((a,c)=>{e<Tu&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${Tu}ms). This may result in timeouts.`);let l=window.setTimeout(()=>{window.clearInterval(u),c(E(Di))},e),u=window.setInterval(()=>{let h="",g=t.contentWindow;try{h=g?g.location.href:""}catch{}if(!h||h==="about:blank")return;let y="";g&&(s===Ht.QUERY?y=g.location.search:y=g.location.hash),window.clearTimeout(l),window.clearInterval(u),a(y)},n)}).finally(()=>{Qe(Wb,d.RemoveHiddenIframe,o,r,i)(t)})})}function zb(t,e,n,r){return n.addQueueMeasurement(d.SilentHandlerLoadFrame,r),new Promise((o,i)=>{let s=CE();window.setTimeout(()=>{if(!s){i("Unable to load iframe");return}s.src=t,o(s)},e)})}function Kb(t){let e=CE();return e.src=t,e}function CE(){let t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(t),t}function Wb(t){document.body===t.parentNode&&document.body.removeChild(t)}var Ou=class extends at{constructor(e,n,r,o,i,s,a,c,l,u,h){super(e,n,r,o,i,s,c,u,h),this.apiId=a,this.nativeStorage=l}acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");let n=m({},e);n.prompt?n.prompt!==he.NONE&&n.prompt!==he.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${n.prompt} with ${he.NONE}`),n.prompt=he.NONE):n.prompt=he.NONE;let r=yield C(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(n,w.Silent);Va(r.authority);let o=this.initializeServerTelemetryManager(this.apiId);try{let i=yield C(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)(o,r.authority,r.azureCloudOptions,r.account);return yield C(this.silentTokenHelper.bind(this),d.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,r)}catch(i){throw i instanceof G&&(i.setCorrelationId(this.correlationId),o.cacheFailedRequest(i)),i}})}logout(){return Promise.reject(E(un))}silentTokenHelper(e,n){return f(this,null,function*(){let r=n.correlationId;this.performanceClient.addQueueMeasurement(d.SilentIframeClientTokenHelper,r);let o=yield C(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(n),i=yield C(e.getAuthCodeUrl.bind(e),d.GetAuthCodeUrl,this.logger,this.performanceClient,r)(S(m({},n),{nativeBroker:mt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,n.authenticationScheme)})),s=new Ir(e,this.browserStorage,o,this.logger,this.performanceClient),a=yield C(yE,d.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,l=yield C(vE,d.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,c),u=Qe(Mu,d.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,c,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw E(St);let h=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,r),{userRequestState:g}=Oe.parseRequestState(this.browserCrypto,n.state);return C(h.acquireToken.bind(h),d.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)(S(m({},n),{state:g,prompt:n.prompt||he.NONE}))}return C(s.handleCodeResponse.bind(s),d.HandleCodeResponse,this.logger,this.performanceClient,r)(u,n)})}};var Pu=class extends at{acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.SilentRefreshClientAcquireToken,e.correlationId);let n=yield C(qa,d.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r=m(m({},e),n);e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));let o=this.initializeServerTelemetryManager(ee.acquireTokenSilent_silentFlow),i=yield this.createRefreshTokenClient(o,r.authority,r.azureCloudOptions,r.account);return C(i.acquireTokenByRefreshToken.bind(i),d.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(s=>{throw s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s),s})})}logout(){return Promise.reject(E(un))}createRefreshTokenClient(e,n,r,o){return f(this,null,function*(){let i=yield C(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,n,r,o);return new gr(i,this.performanceClient)})}};var xu=class{constructor(e,n,r,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=n,this.logger=r,this.cryptoObj=o}loadExternalTokens(e,n,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!n.id_token)throw E(Ze);let o=sr.extractTokenClaims(n.id_token,st),i,s,a;if(e.account)a=de.createFromAccountInfo(e.account),i=new pt(a,this.loadIdToken(n.id_token,a.homeAccountId,e.account.environment,e.account.tenantId),this.loadAccessToken(e,n,a.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadRefreshToken(e,n,a.homeAccountId,e.account.environment));else if(e.authority){let c=wt.generateAuthority(e.authority,e.azureCloudOptions),l={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache};if(s=new wt(c,this.config.system.networkClient,this.storage,l,this.logger,e.correlationId||Le()),r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),a=this.loadAccount(o,s,r.clientInfo),i=new pt(a,this.loadIdToken(n.id_token,a.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,n,a.homeAccountId,s.hostnameAndPort,s.tenant,r),this.loadRefreshToken(e,n,a.homeAccountId,s.hostnameAndPort));else if(n.client_info)this.logger.trace("TokenCache - homeAccountId from response"),a=this.loadAccount(o,s,n.client_info),i=new pt(a,this.loadIdToken(n.id_token,a.homeAccountId,s.hostnameAndPort,s.tenant),this.loadAccessToken(e,n,a.homeAccountId,s.hostnameAndPort,s.tenant,r),this.loadRefreshToken(e,n,a.homeAccountId,s.hostnameAndPort));else throw E(Ze)}else throw E(Ze);return this.generateAuthenticationResult(e,o,i,a,s)}loadAccount(e,n,r,o){if(this.isBrowserEnvironment){this.logger.verbose("TokenCache - loading account");let i;if(o?i=o:n.authorityType!==void 0&&r&&(i=de.generateHomeAccountId(r,n.authorityType,this.logger,this.cryptoObj,e)),!i)throw E(Ze);let s=e.tid,a=mi(this.storage,n,i,e,st,r,n.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(a),a}else throw E(Ze)}loadIdToken(e,n,r,o){let i=ue.createIdTokenEntity(n,r,e,this.config.auth.clientId,o);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(i),i;throw E(Ze)}loadAccessToken(e,n,r,o,i,s){if(!n.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!n.expires_in)throw E(Ze);if(!s.extendedExpiresOn)throw E(Ze);let a=new me(e.scopes).printScopes(),c=s.expiresOn||n.expires_in+new Date().getTime()/1e3,l=s.extendedExpiresOn,u=ue.createAccessTokenEntity(r,o,n.access_token,this.config.auth.clientId,i,a,c,l,st);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u),u;throw E(Ze)}loadRefreshToken(e,n,r,o){if(!n.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;let i=ue.createRefreshTokenEntity(r,o,n.refresh_token,this.config.auth.clientId);if(this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(i),i;throw E(Ze)}generateAuthenticationResult(e,n,r,o,i){let s=p.EMPTY_STRING,a=[],c=null,l;r?.accessToken&&(s=r.accessToken.secret,a=me.fromString(r.accessToken.target).asArray(),c=new Date(Number(r.accessToken.expiresOn)*1e3),l=new Date(Number(r.accessToken.extendedExpiresOn)*1e3));let u=n.oid||n.sub||p.EMPTY_STRING,h=n.tid||p.EMPTY_STRING;return{authority:i?i.canonicalAuthority:p.EMPTY_STRING,uniqueId:u,tenantId:h,scopes:a,account:o.getAccountInfo(),idToken:r.idToken?.secret||"",idTokenClaims:n||{},accessToken:s,fromCache:!0,expiresOn:c,correlationId:e.correlationId||p.EMPTY_STRING,requestId:p.EMPTY_STRING,extExpiresOn:l,familyId:p.EMPTY_STRING,tokenType:r?.accessToken?.tokenType||p.EMPTY_STRING,state:p.EMPTY_STRING,cloudGraphHostName:o.cloudGraphHostName||p.EMPTY_STRING,msGraphHost:o.msGraphHost||p.EMPTY_STRING,code:void 0,fromNativeBroker:!1}}};var Lu=class extends Io{constructor(e){super(e),this.includeRedirectUri=!1}};var Fu=class extends at{constructor(e,n,r,o,i,s,a,c,l,u){super(e,n,r,o,i,s,c,l,u),this.apiId=a}acquireToken(e){return f(this,null,function*(){if(!e.code)throw E(Li);let n=yield C(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,w.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{let o=S(m({},n),{code:e.code}),i=yield C(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)(r,n.authority,n.azureCloudOptions,n.account),s=new Lu(i);this.logger.verbose("Auth code client created");let a=new Ir(s,this.browserStorage,o,this.logger,this.performanceClient);return yield C(a.handleCodeResponseFromServer.bind(a),d.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},n,!1)}catch(o){throw o instanceof G&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),o}})}logout(){return Promise.reject(E(un))}};function hn(t){let e=t?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Uu(t,e){try{ja(t)}catch(n){throw e.end({success:!1},n),n}}var Zi=class t{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new ZC(this.logger,this.performanceClient):dr,this.eventHandler=new _u(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Yi(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,kf(this.config.auth),this.performanceClient):XC(this.config.auth.clientId,this.logger);let n={cacheLocation:ce.MemoryStorage,temporaryCacheLocation:ce.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Yi(this.config.auth.clientId,n,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new xu(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e){return f(this,null,function*(){let n=new t(e);return yield n.initialize(),n})}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(){return f(this,null,function*(){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}let e=this.config.system.allowNativeBroker,n=this.performanceClient.startMeasurement(d.InitializeClientApplication);if(this.eventHandler.emitEvent(A.INITIALIZE_START),e)try{this.nativeExtensionProvider=yield mt.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(r){this.logger.verbose(r)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),yield C(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),d.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient)(this.performanceClient)),this.initialized=!0,this.eventHandler.emitEvent(A.INITIALIZE_END),n.end({allowNativeBroker:e,success:!0})})}handleRedirectPromise(e){return f(this,null,function*(){if(this.logger.verbose("handleRedirectPromise called"),vu(this.initialized),this.isBrowserEnvironment){let n=e||"",r=this.redirectResponse.get(n);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(n,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})}handleRedirectPromiseInternal(e){return f(this,null,function*(){let n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),o=r&&mt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=o?r?.correlationId:this.browserStorage.getTemporaryCache(J.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(d.AcquireTokenRedirect,i);this.eventHandler.emitEvent(A.HANDLE_REDIRECT_START,w.Redirect);let a;if(o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");let c=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ee.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=C(c.handleRedirectPromise.bind(c),d.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");let c=this.createRedirectClient(i);a=C(c.handleRedirectPromise.bind(c),d.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return a.then(c=>(c?(n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(A.LOGIN_SUCCESS,w.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_SUCCESS,w.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:hn(c.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(A.HANDLE_REDIRECT_END,w.Redirect),c)).catch(c=>{let l=c;throw n.length>0?this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_FAILURE,w.Redirect,null,l):this.eventHandler.emitEvent(A.LOGIN_FAILURE,w.Redirect,null,l),this.eventHandler.emitEvent(A.HANDLE_REDIRECT_END,w.Redirect),s.end({success:!1},l),c})})}acquireTokenRedirect(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",n);let r=this.performanceClient.startMeasurement(d.AcquireTokenPreRedirect,n);r.add({accountType:hn(e.account),scenarioId:e.scenarioId});let o=e.onRedirectNavigate;e.onRedirectNavigate=s=>{let a=typeof o=="function"?o(s):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};let i=this.getAllAccounts().length>0;try{Cu(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_START,w.Redirect,e):this.eventHandler.emitEvent(A.LOGIN_START,w.Redirect,e);let s;return this.nativeExtensionProvider&&this.canUseNative(e)?s=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ee.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,n).acquireTokenRedirect(e,r).catch(c=>{if(c instanceof Gt&&Er(c))return this.nativeExtensionProvider=void 0,this.createRedirectClient(n).acquireToken(e);if(c instanceof He)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):s=this.createRedirectClient(n).acquireToken(e),yield s}catch(s){throw r.end({success:!1},s),i?this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_FAILURE,w.Redirect,null,s):this.eventHandler.emitEvent(A.LOGIN_FAILURE,w.Redirect,null,s),s}})}acquireTokenPopup(e){let n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(d.AcquireTokenPopup,n);r.add({scenarioId:e.scenarioId,accountType:hn(e.account)});try{this.logger.verbose("acquireTokenPopup called",n),Uu(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}let o=this.getAllAccounts();o.length>0?this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_START,w.Popup,e):this.eventHandler.emitEvent(A.LOGIN_START,w.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative(S(m({},e),{correlationId:n}),ee.acquireTokenPopup).then(s=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,requestId:s.requestId,accountType:hn(s.account)}),s)).catch(s=>{if(s instanceof Gt&&Er(s))return this.nativeExtensionProvider=void 0,this.createPopupClient(n).acquireToken(e);if(s instanceof He)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(n).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),s}):i=this.createPopupClient(n).acquireToken(e),i.then(s=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(A.LOGIN_SUCCESS,w.Popup,s):this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_SUCCESS,w.Popup,s),r.end({success:!0,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:hn(s.account)}),s)).catch(s=>(o.length>0?this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_FAILURE,w.Popup,null,s):this.eventHandler.emitEvent(A.LOGIN_FAILURE,w.Popup,null,s),r.end({success:!1},s),Promise.reject(s)))}trackPageVisibilityWithMeasurement(){let e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e),r=S(m({},e),{prompt:e.prompt,correlationId:n});this.ssoSilentMeasurement=this.performanceClient.startMeasurement(d.SsoSilent,n),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:hn(e.account)}),Uu(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(A.SSO_SILENT_START,w.Silent,r);let o;return this.canUseNative(r)?o=this.acquireTokenNative(r,ee.ssoSilent).catch(i=>{if(i instanceof Gt&&Er(i))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw i}):o=this.createSilentIframeClient(r.correlationId).acquireToken(r),o.then(i=>(this.eventHandler.emitEvent(A.SSO_SILENT_SUCCESS,w.Silent,i),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:i.fromNativeBroker,requestId:i.requestId,accessTokenSize:i.accessToken.length,idTokenSize:i.idToken.length,accountType:hn(i.account)}),i)).catch(i=>{throw this.eventHandler.emitEvent(A.SSO_SILENT_FAILURE,w.Silent,null,i),this.ssoSilentMeasurement?.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenByCode(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",n);let r=this.performanceClient.startMeasurement(d.AcquireTokenByCode,n);Uu(this.initialized,r),this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_BY_CODE_START,w.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw E(Ui);if(e.code){let o=e.code,i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",n),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",n),i=this.acquireTokenByCodeAsync(S(m({},e),{correlationId:n})).then(s=>(this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_BY_CODE_SUCCESS,w.Silent,s),this.hybridAuthCodeResponses.delete(o),r.end({success:!0,isNativeBroker:s.fromNativeBroker,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:hn(s.account)}),s)).catch(s=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_BY_CODE_FAILURE,w.Silent,null,s),r.end({success:!1},s),s}),this.hybridAuthCodeResponses.set(o,i)),yield i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){let o=yield this.acquireTokenNative(S(m({},e),{correlationId:n}),ee.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof Gt&&Er(i)&&(this.nativeExtensionProvider=void 0),i});return r.end({accountType:hn(o.account),success:!0}),o}else throw E(Hi);else throw E(Fi)}catch(o){throw this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_BY_CODE_FAILURE,w.Silent,null,o),r.end({success:!1},o),o}})}acquireTokenByCodeAsync(e){return f(this,null,function*(){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(d.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),yield this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(o=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker,requestId:o.requestId}),o)).catch(o=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenFromCache(e,n){return f(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(d.AcquireTokenFromCache,e.correlationId),n){case Xe.Default:case Xe.AccessToken:case Xe.AccessTokenAndRefreshToken:let r=this.createSilentCacheClient(e.correlationId);return C(r.acquireToken.bind(r),d.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw v(Ne.tokenRefreshRequired)}})}acquireTokenByRefreshToken(e,n){return f(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(d.AcquireTokenByRefreshToken,e.correlationId),n){case Xe.Default:case Xe.AccessTokenAndRefreshToken:case Xe.RefreshToken:case Xe.RefreshTokenAndNetwork:let r=this.createSilentRefreshClient(e.correlationId);return C(r.acquireToken.bind(r),d.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw v(Ne.tokenRefreshRequired)}})}acquireTokenBySilentIframe(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.AcquireTokenBySilentIframe,e.correlationId);let n=this.createSilentIframeClient(e.correlationId);return C(n.acquireToken.bind(n),d.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)})}logout(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",n),this.logoutRedirect(m({correlationId:n},e))})}logoutRedirect(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e);return Cu(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(n).logout(e)})}logoutPopup(e){try{let n=this.getRequestCorrelationId(e);return ja(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(n).logout(e)}catch(n){return Promise.reject(n)}}clearCache(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e);return this.createSilentCacheClient(n).logout(e)})}getAllAccounts(e){return eE(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return tE(e,this.logger,this.browserStorage)}getAccountByUsername(e){return nE(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return rE(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return oE(e,this.logger,this.browserStorage)}setActiveAccount(e){iE(e,this.browserStorage)}getActiveAccount(){return sE(this.browserStorage)}hydrateCache(e,n){return f(this,null,function*(){this.logger.verbose("hydrateCache called");let r=de.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,n)):this.browserStorage.hydrateCache(e,n)})}acquireTokenNative(e,n,r){return f(this,null,function*(){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw E(St);return new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,n,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)})}canUseNative(e,n){if(this.logger.trace("canUseNative called"),!mt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case he.NONE:case he.CONSENT:case he.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!n&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){let n=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return n&&n.nativeAccountId||""}createPopupClient(e){return new Nu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new ku(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Ou(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ee.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Ji(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Pu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Fu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ee.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,n){this.browserStorage.setWrapperMetadata(e,n)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Le():p.EMPTY_STRING}loginRedirect(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",n),this.acquireTokenRedirect(m({correlationId:n},e||Sp))})}loginPopup(e){let n=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",n),this.acquireTokenPopup(m({correlationId:n},e||Sp))}acquireTokenSilent(e){return f(this,null,function*(){let n=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(d.AcquireTokenSilent,n);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Uu(this.initialized,r),this.logger.verbose("acquireTokenSilent called",n);let o=e.account||this.getActiveAccount();if(!o)throw E(Mi);r.add({accountType:hn(o)});let i={clientId:this.config.auth.clientId,authority:e.authority||p.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(i),a=this.activeSilentTokenRequests.get(s);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n);let c=C(this.acquireTokenSilentAsync.bind(this),d.AcquireTokenSilentAsync,this.logger,this.performanceClient,n)(S(m({},e),{correlationId:n}),o).then(l=>(this.activeSilentTokenRequests.delete(s),r.end({success:!0,fromCache:l.fromCache,isNativeBroker:l.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:l.requestId,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),l)).catch(l=>{throw this.activeSilentTokenRequests.delete(s),r.end({success:!1},l),l});return this.activeSilentTokenRequests.set(s,c),S(m({},yield c),{state:e.state})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),r.discard(),S(m({},yield a),{state:e.state})})}acquireTokenSilentAsync(e,n){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(d.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_START,w.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",()=>this.trackPageVisibility(e.correlationId));let r=yield C(cE,d.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,n,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||Xe.Default;return this.acquireTokenSilentNoIframe(r,o).catch(s=>f(this,null,function*(){if(Yb(s,o))if(this.activeIframeRequest)if(o!==Xe.Skip){let[c,l]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${l}`,r.correlationId);let u=this.performanceClient.startMeasurement(d.AwaitConcurrentIframe,r.correlationId);u.add({awaitIframeCorrelationId:l});let h=yield c;if(u.end({success:h}),h)return this.logger.verbose(`Parallel iframe request with correlationId: ${l} succeeded. Retrying cache and/or RT redemption`,r.correlationId),this.acquireTokenSilentNoIframe(r,o);throw this.logger.info(`Iframe request with correlationId: ${l} failed. Interaction is required.`),s}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),C(this.acquireTokenBySilentIframe.bind(this),d.AcquireTokenBySilentIframe,this.logger,this.performanceClient,r.correlationId)(r);else{let c;return this.activeIframeRequest=[new Promise(l=>{c=l}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),C(this.acquireTokenBySilentIframe.bind(this),d.AcquireTokenBySilentIframe,this.logger,this.performanceClient,r.correlationId)(r).then(l=>(c(!0),l)).catch(l=>{throw c(!1),l}).finally(()=>{this.activeIframeRequest=void 0})}else throw s})).then(s=>(this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_SUCCESS,w.Silent,s),e.correlationId&&this.performanceClient.addFields({fromCache:s.fromCache,isNativeBroker:s.fromNativeBroker,requestId:s.requestId},e.correlationId),s)).catch(s=>{throw this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_FAILURE,w.Silent,null,s),s}).finally(()=>{document.removeEventListener("visibilitychange",()=>this.trackPageVisibility(e.correlationId))})})}acquireTokenSilentNoIframe(e,n){return f(this,null,function*(){return mt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,ee.acquireTokenSilent_silentFlow).catch(r=>f(this,null,function*(){throw r instanceof Gt&&Er(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,v(Ne.tokenRefreshRequired)):r}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),C(this.acquireTokenFromCache.bind(this),d.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,n).catch(r=>{if(n===Xe.AccessToken)throw r;return this.eventHandler.emitEvent(A.ACQUIRE_TOKEN_NETWORK_START,w.Silent,e),C(this.acquireTokenByRefreshToken.bind(this),d.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,n)}))})}};function Yb(t,e){let n=!(t instanceof He&&t.subError!==Ln.badToken),r=t.errorCode===Be.INVALID_GRANT_ERROR||t.errorCode===Ne.tokenRefreshRequired,o=n&&r||t.errorCode===Ln.noTokensFound||t.errorCode===Ln.refreshTokenExpired,i=kC.includes(e);return o&&i}function EE(t){return f(this,null,function*(){let e=new Au(t);return yield e.initialize(),Zi.createController(e)})}var Wa=class t{static createPublicClientApplication(e){return f(this,null,function*(){let n=yield EE(e);return new t(e,n)})}constructor(e,n){this.controller=n||new Zi(new Au(e))}initialize(){return f(this,null,function*(){return this.controller.initialize()})}acquireTokenPopup(e){return f(this,null,function*(){return this.controller.acquireTokenPopup(e)})}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,n){return this.controller.initializeWrapperLibrary(e,n)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(e,n){return f(this,null,function*(){return this.controller.hydrateCache(e,n)})}clearCache(e){return this.controller.clearCache(e)}};var Ya=class{static getInteractionStatusFromEvent(e,n){switch(e.eventType){case A.LOGIN_START:return fe.Login;case A.SSO_SILENT_START:return fe.SsoSilent;case A.ACQUIRE_TOKEN_START:if(e.interactionType===w.Redirect||e.interactionType===w.Popup)return fe.AcquireToken;break;case A.HANDLE_REDIRECT_START:return fe.HandleRedirect;case A.LOGOUT_START:return fe.Logout;case A.SSO_SILENT_SUCCESS:case A.SSO_SILENT_FAILURE:if(n&&n!==fe.SsoSilent)break;return fe.None;case A.LOGOUT_END:if(n&&n!==fe.Logout)break;return fe.None;case A.HANDLE_REDIRECT_END:if(n&&n!==fe.HandleRedirect)break;return fe.None;case A.LOGIN_SUCCESS:case A.LOGIN_FAILURE:case A.ACQUIRE_TOKEN_SUCCESS:case A.ACQUIRE_TOKEN_FAILURE:case A.RESTORE_FROM_BFCACHE:if(e.interactionType===w.Redirect||e.interactionType===w.Popup){if(n&&n!==fe.Login&&n!==fe.AcquireToken)break;return fe.None}break}return null}};var V="primary",uc=Symbol("RouteTitle"),Hp=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function rs(t){return new Hp(t)}function Qb(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let o={};for(let i=0;i<r.length;i++){let s=r[i],a=t[i];if(s.startsWith(":"))o[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:o}}function Jb(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!fn(t[n],e[n]))return!1;return!0}function fn(t,e){let n=t?Bp(t):void 0,r=e?Bp(e):void 0;if(!n||!r||n.length!=r.length)return!1;let o;for(let i=0;i<n.length;i++)if(o=n[i],!DE(t[o],e[o]))return!1;return!0}function Bp(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function DE(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((o,i)=>r[i]===o)}else return t===e}function bE(t){return t.length>0?t[t.length-1]:null}function Ar(t){return yd(t)?t:xs(t)?X(Promise.resolve(t)):M(t)}var Zb={exact:RE,subset:ME},_E={exact:Xb,subset:e_,ignored:()=>!0};function IE(t,e,n){return Zb[n.paths](t.root,e.root,n.matrixParams)&&_E[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function Xb(t,e){return fn(t,e)}function RE(t,e,n){if(!Mo(t.segments,e.segments)||!ju(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!RE(t.children[r],e.children[r],n))return!1;return!0}function e_(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>DE(t[n],e[n]))}function ME(t,e,n){return NE(t,e,e.segments,n)}function NE(t,e,n,r){if(t.segments.length>n.length){let o=t.segments.slice(0,n.length);return!(!Mo(o,n)||e.hasChildren()||!ju(o,n,r))}else if(t.segments.length===n.length){if(!Mo(t.segments,n)||!ju(t.segments,n,r))return!1;for(let o in e.children)if(!t.children[o]||!ME(t.children[o],e.children[o],r))return!1;return!0}else{let o=n.slice(0,t.segments.length),i=n.slice(t.segments.length);return!Mo(t.segments,o)||!ju(t.segments,o,r)||!t.children[V]?!1:NE(t.children[V],e,i,r)}}function ju(t,e,n){return e.every((r,o)=>_E[n](t[o].parameters,r.parameters))}var Tr=class{constructor(e=new ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=rs(this.queryParams),this._queryParamMap}toString(){return r_.serialize(this)}},ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Vu(this)}},Ro=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=rs(this.parameters),this._parameterMap}toString(){return OE(this)}};function t_(t,e){return Mo(t,e)&&t.every((n,r)=>fn(n.parameters,e[r].parameters))}function Mo(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function n_(t,e){let n=[];return Object.entries(t.children).forEach(([r,o])=>{r===V&&(n=n.concat(e(o,r)))}),Object.entries(t.children).forEach(([r,o])=>{r!==V&&(n=n.concat(e(o,r)))}),n}var hg=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>new Gu,providedIn:"root"});let t=e;return t})(),Gu=class{parse(e){let n=new Vp(e);return new Tr(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Qa(e.root,!0)}`,r=s_(e.queryParams),o=typeof e.fragment=="string"?`#${o_(e.fragment)}`:"";return`${n}${r}${o}`}},r_=new Gu;function Vu(t){return t.segments.map(e=>OE(e)).join("/")}function Qa(t,e){if(!t.hasChildren())return Vu(t);if(e){let n=t.children[V]?Qa(t.children[V],!1):"",r=[];return Object.entries(t.children).forEach(([o,i])=>{o!==V&&r.push(`${o}:${Qa(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=n_(t,(r,o)=>o===V?[Qa(t.children[V],!1)]:[`${o}:${Qa(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[V]!=null?`${Vu(t)}/${n[0]}`:`${Vu(t)}/(${n.join("//")})`}}function kE(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Hu(t){return kE(t).replace(/%3B/gi,";")}function o_(t){return encodeURI(t)}function jp(t){return kE(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $u(t){return decodeURIComponent(t)}function TE(t){return $u(t.replace(/\+/g,"%20"))}function OE(t){return`${jp(t.path)}${i_(t.parameters)}`}function i_(t){return Object.entries(t).map(([e,n])=>`;${jp(e)}=${jp(n)}`).join("")}function s_(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(o=>`${Hu(n)}=${Hu(o)}`).join("&"):`${Hu(n)}=${Hu(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var a_=/^[^\/()?;#]+/;function xp(t){let e=t.match(a_);return e?e[0]:""}var c_=/^[^\/()?;=#]+/;function l_(t){let e=t.match(c_);return e?e[0]:""}var u_=/^[^=?&#]+/;function d_(t){let e=t.match(u_);return e?e[0]:""}var h_=/^[^&#]+/;function f_(t){let e=t.match(h_);return e?e[0]:""}var Vp=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ie([],{}):new ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[V]=new ie(e,n)),r}parseSegment(){let e=xp(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new x(4009,!1);return this.capture(e),new Ro($u(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=l_(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=xp(this.remaining);o&&(r=o,this.capture(r))}e[$u(n)]=$u(r)}parseQueryParam(e){let n=d_(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let s=f_(this.remaining);s&&(r=s,this.capture(r))}let o=TE(n),i=TE(r);if(e.hasOwnProperty(o)){let s=e[o];Array.isArray(s)||(s=[s],e[o]=s),s.push(i)}else e[o]=i}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=xp(this.remaining),o=this.remaining[r.length];if(o!=="/"&&o!==")"&&o!==";")throw new x(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=V);let s=this.parseChildren();n[i]=Object.keys(s).length===1?s[V]:new ie([],s),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new x(4011,!1)}};function PE(t){return t.segments.length>0?new ie([],{[V]:t}):t}function xE(t){let e={};for(let[r,o]of Object.entries(t.children)){let i=xE(o);if(r===V&&i.segments.length===0&&i.hasChildren())for(let[s,a]of Object.entries(i.children))e[s]=a;else(i.segments.length>0||i.hasChildren())&&(e[r]=i)}let n=new ie(t.segments,e);return p_(n)}function p_(t){if(t.numberOfChildren===1&&t.children[V]){let e=t.children[V];return new ie(t.segments.concat(e.segments),e.children)}return t}function os(t){return t instanceof Tr}function g_(t,e,n=null,r=null){let o=LE(t);return FE(o,e,n,r)}function LE(t){let e;function n(i){let s={};for(let c of i.children){let l=n(c);s[c.outlet]=l}let a=new ie(i.url,s);return i===t&&(e=a),a}let r=n(t.root),o=PE(r);return e??o}function FE(t,e,n,r){let o=t;for(;o.parent;)o=o.parent;if(e.length===0)return Lp(o,o,o,n,r);let i=m_(e);if(i.toRoot())return Lp(o,o,new ie([],{}),n,r);let s=y_(i,o,t),a=s.processChildren?Xa(s.segmentGroup,s.index,i.commands):HE(s.segmentGroup,s.index,i.commands);return Lp(o,s.segmentGroup,a,n,r)}function qu(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function nc(t){return typeof t=="object"&&t!=null&&t.outlets}function Lp(t,e,n,r,o){let i={};r&&Object.entries(r).forEach(([c,l])=>{i[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let s;t===e?s=n:s=UE(t,e,n);let a=PE(xE(s));return new Tr(a,i,o)}function UE(t,e,n){let r={};return Object.entries(t.children).forEach(([o,i])=>{i===e?r[o]=n:r[o]=UE(i,e,n)}),new ie(t.segments,r)}var zu=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&qu(r[0]))throw new x(4003,!1);let o=r.find(nc);if(o&&o!==bE(r))throw new x(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function m_(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new zu(!0,0,t);let e=0,n=!1,r=t.reduce((o,i,s)=>{if(typeof i=="object"&&i!=null){if(i.outlets){let a={};return Object.entries(i.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...o,{outlets:a}]}if(i.segmentPath)return[...o,i.segmentPath]}return typeof i!="string"?[...o,i]:s===0?(i.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&o.push(a))}),o):[...o,i]},[]);return new zu(n,e,r)}var ts=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function y_(t,e,n){if(t.isAbsolute)return new ts(e,!0,0);if(!n)return new ts(e,!1,NaN);if(n.parent===null)return new ts(n,!0,0);let r=qu(t.commands[0])?0:1,o=n.segments.length-1+r;return v_(n,o,t.numberOfDoubleDots)}function v_(t,e,n){let r=t,o=e,i=n;for(;i>o;){if(i-=o,r=r.parent,!r)throw new x(4005,!1);o=r.segments.length}return new ts(r,!1,o-i)}function C_(t){return nc(t[0])?t[0].outlets:{[V]:t}}function HE(t,e,n){if(t??=new ie([],{}),t.segments.length===0&&t.hasChildren())return Xa(t,e,n);let r=E_(t,e,n),o=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let i=new ie(t.segments.slice(0,r.pathIndex),{});return i.children[V]=new ie(t.segments.slice(r.pathIndex),t.children),Xa(i,0,o)}else return r.match&&o.length===0?new ie(t.segments,{}):r.match&&!t.hasChildren()?$p(t,e,n):r.match?Xa(t,0,o):$p(t,e,n)}function Xa(t,e,n){if(n.length===0)return new ie(t.segments,{});{let r=C_(n),o={};if(Object.keys(r).some(i=>i!==V)&&t.children[V]&&t.numberOfChildren===1&&t.children[V].segments.length===0){let i=Xa(t.children[V],e,n);return new ie(t.segments,i.children)}return Object.entries(r).forEach(([i,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(o[i]=HE(t.children[i],e,s))}),Object.entries(t.children).forEach(([i,s])=>{r[i]===void 0&&(o[i]=s)}),new ie(t.segments,o)}}function E_(t,e,n){let r=0,o=e,i={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(r>=n.length)return i;let s=t.segments[o],a=n[r];if(nc(a))break;let c=`${a}`,l=r<n.length-1?n[r+1]:null;if(o>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!AE(c,l,s))return i;r+=2}else{if(!AE(c,{},s))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function $p(t,e,n){let r=t.segments.slice(0,e),o=0;for(;o<n.length;){let i=n[o];if(nc(i)){let c=I_(i.outlets);return new ie(r,c)}if(o===0&&qu(n[0])){let c=t.segments[e];r.push(new Ro(c.path,wE(n[0]))),o++;continue}let s=nc(i)?i.outlets[V]:`${i}`,a=o<n.length-1?n[o+1]:null;s&&a&&qu(a)?(r.push(new Ro(s,wE(a))),o+=2):(r.push(new Ro(s,{})),o++)}return new ie(r,{})}function I_(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=$p(new ie([],{}),0,r))}),e}function wE(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function AE(t,e,n){return t==n.path&&fn(e,n.parameters)}var ec="imperative",je=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(je||{}),bt=class{constructor(e,n){this.id=e,this.url=n}},rc=class extends bt{constructor(e,n,r="imperative",o=null){super(e,n),this.type=je.NavigationStart,this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},No=class extends bt{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=je.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},vt=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(vt||{}),Gp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Gp||{}),wr=class extends bt{constructor(e,n,r,o){super(e,n),this.reason=r,this.code=o,this.type=je.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ko=class extends bt{constructor(e,n,r,o){super(e,n),this.reason=r,this.code=o,this.type=je.NavigationSkipped}},oc=class extends bt{constructor(e,n,r,o){super(e,n),this.error=r,this.target=o,this.type=je.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ku=class extends bt{constructor(e,n,r,o){super(e,n),this.urlAfterRedirects=r,this.state=o,this.type=je.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qp=class extends bt{constructor(e,n,r,o){super(e,n),this.urlAfterRedirects=r,this.state=o,this.type=je.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zp=class extends bt{constructor(e,n,r,o,i){super(e,n),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i,this.type=je.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Kp=class extends bt{constructor(e,n,r,o){super(e,n),this.urlAfterRedirects=r,this.state=o,this.type=je.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wp=class extends bt{constructor(e,n,r,o){super(e,n),this.urlAfterRedirects=r,this.state=o,this.type=je.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yp=class{constructor(e){this.route=e,this.type=je.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Qp=class{constructor(e){this.route=e,this.type=je.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Jp=class{constructor(e){this.snapshot=e,this.type=je.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zp=class{constructor(e){this.snapshot=e,this.type=je.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xp=class{constructor(e){this.snapshot=e,this.type=je.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},eg=class{constructor(e){this.snapshot=e,this.type=je.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ic=class{},sc=class{constructor(e){this.url=e}};var tg=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Xu,this.attachRef=null}},Xu=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,o){let i=this.getOrCreateContext(r);i.outlet=o,this.contexts.set(r,i)}onChildOutletDestroyed(r){let o=this.getContext(r);o&&(o.outlet=null,o.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let o=this.getContext(r);return o||(o=new tg,this.contexts.set(r,o)),o}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Wu=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=ng(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=ng(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=rg(e,this._root);return n.length<2?[]:n[n.length-2].children.map(o=>o.value).filter(o=>o!==e)}pathFromRoot(e){return rg(e,this._root).map(n=>n.value)}};function ng(t,e){if(t===e.value)return e;for(let n of e.children){let r=ng(t,n);if(r)return r}return null}function rg(t,e){if(t===e.value)return[e];for(let n of e.children){let r=rg(t,n);if(r.length)return r.unshift(e),r}return[]}var yt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function es(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Yu=class extends Wu{constructor(e,n){super(e),this.snapshot=n,pg(this,e)}toString(){return this.snapshot.toString()}};function BE(t){let e=T_(t),n=new De([new Ro("",{})]),r=new De({}),o=new De({}),i=new De({}),s=new De(""),a=new is(n,r,i,s,o,V,t,e.root);return a.snapshot=e.root,new Yu(new yt(a,[]),e)}function T_(t){let e={},n={},r={},o="",i=new ac([],e,r,o,n,V,t,null,{});return new Qu("",new yt(i,[]))}var is=class{constructor(e,n,r,o,i,s,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=i,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(j(l=>l[uc]))??M(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=o,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>rs(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>rs(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function fg(t,e,n="emptyOnly"){let r,{routeConfig:o}=t;return e!==null&&(n==="always"||o?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:m(m({},e.params),t.params),data:m(m({},e.data),t.data),resolve:m(m(m(m({},t.data),e.data),o?.data),t._resolvedData)}:r={params:m({},t.params),data:m({},t.data),resolve:m(m({},t.data),t._resolvedData??{})},o&&VE(o)&&(r.resolve[uc]=o.title),r}var ac=class{get title(){return this.data?.[uc]}constructor(e,n,r,o,i,s,a,c,l){this.url=e,this.params=n,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=rs(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=rs(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},Qu=class extends Wu{constructor(e,n){super(n),this.url=e,pg(this,n)}toString(){return jE(this._root)}};function pg(t,e){e.value._routerState=t,e.children.forEach(n=>pg(t,n))}function jE(t){let e=t.children.length>0?` { ${t.children.map(jE).join(", ")} } `:"";return`${t.value}${e}`}function Fp(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,fn(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),fn(e.params,n.params)||t.paramsSubject.next(n.params),Jb(e.url,n.url)||t.urlSubject.next(n.url),fn(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function og(t,e){let n=fn(t.params,e.params)&&t_(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||og(t.parent,e.parent))}function VE(t){return typeof t.title=="string"||t.title===null}var gg=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=V,this.activateEvents=new Ot,this.deactivateEvents=new Ot,this.attachEvents=new Ot,this.detachEvents=new Ot,this.parentContexts=D(Xu),this.location=D(Ns),this.changeDetector=D(Ls),this.environmentInjector=D(nt),this.inputBinder=D(mg,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:o,previousValue:i}=r.name;if(o)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new x(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new x(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new x(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,o){this.activated=r,this._activatedRoute=o,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,o){if(this.isActivated)throw new x(4013,!1);this._activatedRoute=r;let i=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new ig(r,c,i.injector);this.activated=i.createComponent(a,{index:i.length,injector:l,environmentInjector:o??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275dir=cl({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[fl]});let t=e;return t})(),ig=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===is?this.route:e===Xu?this.childContexts:this.parent.get(e,n)}},mg=new O("");function w_(t,e,n){let r=cc(t,e._root,n?n._root:void 0);return new Yu(r,e)}function cc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let o=A_(t,e,n);return new yt(r,o)}else{if(t.shouldAttach(e.value)){let i=t.retrieve(e.value);if(i!==null){let s=i.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>cc(t,a)),s}}let r=S_(e.value),o=e.children.map(i=>cc(t,i));return new yt(r,o)}}function A_(t,e,n){return e.children.map(r=>{for(let o of n.children)if(t.shouldReuseRoute(r.value,o.value.snapshot))return cc(t,r,o);return cc(t,r)})}function S_(t){return new is(new De(t.url),new De(t.params),new De(t.queryParams),new De(t.fragment),new De(t.data),t.outlet,t.component,t)}var $E="ngNavigationCancelingError";function GE(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=os(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,o=qE(!1,vt.Redirect);return o.url=n,o.navigationBehaviorOptions=r,o}function qE(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[$E]=!0,n.cancellationCode=e,n}function D_(t){return zE(t)&&os(t.url)}function zE(t){return!!t&&t[$E]}var b_=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=xt({type:e,selectors:[["ng-component"]],standalone:!0,features:[nn],decls:1,vars:0,template:function(o,i){o&1&&ni(0,"router-outlet")},dependencies:[gg],encapsulation:2});let t=e;return t})();function __(t,e){return t.providers&&!t._injector&&(t._injector=Wh(t.providers,e,`Route: ${t.path}`)),t._injector??e}function yg(t){let e=t.children&&t.children.map(yg),n=e?S(m({},t),{children:e}):m({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==V&&(n.component=b_),n}function pn(t){return t.outlet||V}function R_(t,e){let n=t.filter(r=>pn(r)===e);return n.push(...t.filter(r=>pn(r)!==e)),n}function dc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var M_=(t,e,n,r)=>j(o=>(new sg(e,o.targetRouterState,o.currentRouterState,n,r).activate(t),o)),sg=class{constructor(e,n,r,o,i){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=i}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Fp(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let o=es(n);e.children.forEach(i=>{let s=i.value.outlet;this.deactivateRoutes(i,o[s],r),delete o[s]}),Object.values(o).forEach(i=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(e,n,r){let o=e.value,i=n?n.value:null;if(o===i)if(o.component){let s=r.getContext(o.outlet);s&&this.deactivateChildRoutes(e,n,s.children)}else this.deactivateChildRoutes(e,n,r);else i&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),o=r&&e.value.component?r.children:n,i=es(e);for(let s of Object.values(i))this.deactivateRouteAndItsChildren(s,o);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),o=r&&e.value.component?r.children:n,i=es(e);for(let s of Object.values(i))this.deactivateRouteAndItsChildren(s,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let o=es(n);e.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new eg(i.value.snapshot))}),e.children.length&&this.forwardEvent(new Zp(e.value.snapshot))}activateRoutes(e,n,r){let o=e.value,i=n?n.value:null;if(Fp(o),o===i)if(o.component){let s=r.getOrCreateContext(o.outlet);this.activateChildRoutes(e,n,s.children)}else this.activateChildRoutes(e,n,r);else if(o.component){let s=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Fp(a.route.value),this.activateChildRoutes(e,null,s.children)}else{let a=dc(o.snapshot);s.attachRef=null,s.route=o,s.injector=a,s.outlet&&s.outlet.activateWith(o,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,r)}},Ju=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ns=class{constructor(e,n){this.component=e,this.route=n}};function N_(t,e,n){let r=t._root,o=e?e._root:null;return Ja(r,o,n,[r.value])}function k_(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function as(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!Fm(t)?t:e.get(t):r}function Ja(t,e,n,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let i=es(e);return t.children.forEach(s=>{O_(s,i[s.value.outlet],n,r.concat([s.value]),o),delete i[s.value.outlet]}),Object.entries(i).forEach(([s,a])=>tc(a,n.getContext(s),o)),o}function O_(t,e,n,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let i=t.value,s=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(s&&i.routeConfig===s.routeConfig){let c=P_(s,i,i.routeConfig.runGuardsAndResolvers);c?o.canActivateChecks.push(new Ju(r)):(i.data=s.data,i._resolvedData=s._resolvedData),i.component?Ja(t,e,a?a.children:null,r,o):Ja(t,e,n,r,o),c&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new ns(a.outlet.component,s))}else s&&tc(e,a,o),o.canActivateChecks.push(new Ju(r)),i.component?Ja(t,null,a?a.children:null,r,o):Ja(t,null,n,r,o);return o}function P_(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Mo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Mo(t.url,e.url)||!fn(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!og(t,e)||!fn(t.queryParams,e.queryParams);case"paramsChange":default:return!og(t,e)}}function tc(t,e,n){let r=es(t),o=t.value;Object.entries(r).forEach(([i,s])=>{o.component?e?tc(s,e.children.getContext(i),n):tc(s,null,n):tc(s,e,n)}),o.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ns(e.outlet.component,o)):n.canDeactivateChecks.push(new ns(null,o)):n.canDeactivateChecks.push(new ns(null,o))}function hc(t){return typeof t=="function"}function x_(t){return typeof t=="boolean"}function L_(t){return t&&hc(t.canLoad)}function F_(t){return t&&hc(t.canActivate)}function U_(t){return t&&hc(t.canActivateChild)}function H_(t){return t&&hc(t.canDeactivate)}function B_(t){return t&&hc(t.canMatch)}function KE(t){return t instanceof yn||t?.name==="EmptyError"}var Bu=Symbol("INITIAL_VALUE");function ss(){return _e(t=>Oc(t.map(e=>e.pipe(lt(1),Td(Bu)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===Bu)return Bu;if(n===!1||n instanceof Tr)return n}return!0}),ve(e=>e!==Bu),lt(1)))}function j_(t,e){return be(n=>{let{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:i,canDeactivateChecks:s}}=n;return s.length===0&&i.length===0?M(S(m({},n),{guardsResult:!0})):V_(s,r,o,t).pipe(be(a=>a&&x_(a)?$_(r,i,t,e):M(a)),j(a=>S(m({},n),{guardsResult:a})))})}function V_(t,e,n,r){return X(t).pipe(be(o=>W_(o.component,o.route,n,e,r)),qt(o=>o!==!0,!0))}function $_(t,e,n,r){return X(e).pipe(Nt(o=>Vo(q_(o.route.parent,r),G_(o.route,r),K_(t,o.path,n),z_(t,o.route,n))),qt(o=>o!==!0,!0))}function G_(t,e){return t!==null&&e&&e(new Xp(t)),M(!0)}function q_(t,e){return t!==null&&e&&e(new Jp(t)),M(!0)}function z_(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return M(!0);let o=r.map(i=>Pc(()=>{let s=dc(e)??n,a=as(i,s),c=F_(a)?a.canActivate(e,t):Cn(s,()=>a(e,t));return Ar(c).pipe(qt())}));return M(o).pipe(ss())}function K_(t,e,n){let r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(s=>k_(s)).filter(s=>s!==null).map(s=>Pc(()=>{let a=s.guards.map(c=>{let l=dc(s.node)??n,u=as(c,l),h=U_(u)?u.canActivateChild(r,t):Cn(l,()=>u(r,t));return Ar(h).pipe(qt())});return M(a).pipe(ss())}));return M(i).pipe(ss())}function W_(t,e,n,r,o){let i=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!i||i.length===0)return M(!0);let s=i.map(a=>{let c=dc(e)??o,l=as(a,c),u=H_(l)?l.canDeactivate(t,e,n,r):Cn(c,()=>l(t,e,n,r));return Ar(u).pipe(qt())});return M(s).pipe(ss())}function Y_(t,e,n,r){let o=e.canLoad;if(o===void 0||o.length===0)return M(!0);let i=o.map(s=>{let a=as(s,t),c=L_(a)?a.canLoad(e,n):Cn(t,()=>a(e,n));return Ar(c)});return M(i).pipe(ss(),WE(r))}function WE(t){return hd(xe(e=>{if(os(e))throw GE(t,e)}),j(e=>e===!0))}function Q_(t,e,n,r){let o=e.canMatch;if(!o||o.length===0)return M(!0);let i=o.map(s=>{let a=as(s,t),c=B_(a)?a.canMatch(e,n):Cn(t,()=>a(e,n));return Ar(c)});return M(i).pipe(ss(),WE(r))}var lc=class{constructor(e){this.segmentGroup=e||null}},Zu=class extends Error{constructor(e){super(),this.urlTree=e}};function Xi(t){return jo(new lc(t))}function J_(t){return jo(new x(4e3,!1))}function Z_(t){return jo(qE(!1,vt.GuardRejected))}var ag=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],o=n.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return M(r);if(o.numberOfChildren>1||!o.children[V])return J_(e.redirectTo);o=o.children[V]}}applyRedirectCommands(e,n,r){let o=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Zu(o);return o}applyRedirectCreateUrlTree(e,n,r,o){let i=this.createSegmentGroup(e,n.root,r,o);return new Tr(i,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([o,i])=>{if(typeof i=="string"&&i.startsWith(":")){let a=i.substring(1);r[o]=n[a]}else r[o]=i}),r}createSegmentGroup(e,n,r,o){let i=this.createSegments(e,n.segments,r,o),s={};return Object.entries(n.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,o)}),new ie(i,s)}createSegments(e,n,r,o){return n.map(i=>i.path.startsWith(":")?this.findPosParam(e,i,o):this.findOrReturn(i,r))}findPosParam(e,n,r){let o=r[n.path.substring(1)];if(!o)throw new x(4001,!1);return o}findOrReturn(e,n){let r=0;for(let o of n){if(o.path===e.path)return n.splice(r),o;r++}return e}},cg={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function X_(t,e,n,r,o){let i=vg(t,e,n);return i.matched?(r=__(e,r),Q_(r,e,n,o).pipe(j(s=>s===!0?i:m({},cg)))):M(i)}function vg(t,e,n){if(e.path==="**")return eR(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?m({},cg):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let o=(e.matcher||Qb)(n,t,e);if(!o)return m({},cg);let i={};Object.entries(o.posParams??{}).forEach(([a,c])=>{i[a]=c.path});let s=o.consumed.length>0?m(m({},i),o.consumed[o.consumed.length-1].parameters):i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:n.slice(o.consumed.length),parameters:s,positionalParamSegments:o.posParams??{}}}function eR(t){return{matched:!0,parameters:t.length>0?bE(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function SE(t,e,n,r){return n.length>0&&rR(t,n,r)?{segmentGroup:new ie(e,nR(r,new ie(n,t.children))),slicedSegments:[]}:n.length===0&&oR(t,n,r)?{segmentGroup:new ie(t.segments,tR(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new ie(t.segments,t.children),slicedSegments:n}}function tR(t,e,n,r){let o={};for(let i of n)if(ed(t,e,i)&&!r[pn(i)]){let s=new ie([],{});o[pn(i)]=s}return m(m({},r),o)}function nR(t,e){let n={};n[V]=e;for(let r of t)if(r.path===""&&pn(r)!==V){let o=new ie([],{});n[pn(r)]=o}return n}function rR(t,e,n){return n.some(r=>ed(t,e,r)&&pn(r)!==V)}function oR(t,e,n){return n.some(r=>ed(t,e,r))}function ed(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function iR(t,e,n,r){return pn(t)!==r&&(r===V||!ed(e,n,t))?!1:vg(e,t,n).matched}function sR(t,e,n){return e.length===0&&!t.children[n]}var lg=class{};function aR(t,e,n,r,o,i,s="emptyOnly"){return new ug(t,e,n,r,o,s,i).recognize()}var cR=31,ug=class{constructor(e,n,r,o,i,s,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=o,this.urlTree=i,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new ag(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new x(4002,`'${e.segmentGroup}'`)}recognize(){let e=SE(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new ac([],Object.freeze({}),Object.freeze(m({},this.urlTree.queryParams)),this.urlTree.fragment,{},V,this.rootComponentType,null,{}),o=new yt(r,n),i=new Qu("",o),s=g_(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(i._root,null),{state:i,tree:s}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,V).pipe(Mt(r=>{if(r instanceof Zu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof lc?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,o=fg(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(o.params),r.data=Object.freeze(o.data),e.children.forEach(i=>this.inheritParamsAndData(i,r))}processSegmentGroup(e,n,r,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,o,!0).pipe(j(i=>i instanceof yt?[i]:[]))}processChildren(e,n,r){let o=[];for(let i of Object.keys(r.children))i==="primary"?o.unshift(i):o.push(i);return X(o).pipe(Nt(i=>{let s=r.children[i],a=R_(n,i);return this.processSegmentGroup(e,a,s,i)}),Id((i,s)=>(i.push(...s),i)),$n(null),Ed(),be(i=>{if(i===null)return Xi(r);let s=YE(i);return lR(s),M(s)}))}processSegment(e,n,r,o,i,s){return X(n).pipe(Nt(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,o,i,s).pipe(Mt(c=>{if(c instanceof lc)return M(null);throw c}))),qt(a=>!!a),Mt(a=>{if(KE(a))return sR(r,o,i)?M(new lg):Xi(r);throw a}))}processSegmentAgainstRoute(e,n,r,o,i,s,a){return iR(r,o,i,s)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,o,r,i,s):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,o,n,r,i,s):Xi(o):Xi(o)}expandSegmentAgainstRouteUsingRedirect(e,n,r,o,i,s){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=vg(n,o,i);if(!a)return Xi(n);o.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>cR&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,o.redirectTo,l);return this.applyRedirects.lineralizeSegments(o,h).pipe(be(g=>this.processSegment(e,r,n,g.concat(u),s,!1)))}matchSegmentAgainstRoute(e,n,r,o,i){let s=X_(n,r,o,e,this.urlSerializer);return r.path==="**"&&(n.children={}),s.pipe(_e(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,o).pipe(_e(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:u,remainingSegments:h,parameters:g}=a,y=new ac(u,g,Object.freeze(m({},this.urlTree.queryParams)),this.urlTree.fragment,dR(r),pn(r),r.component??r._loadedComponent??null,r,hR(r)),{segmentGroup:I,slicedSegments:T}=SE(n,u,h,c);if(T.length===0&&I.hasChildren())return this.processChildren(l,c,I).pipe(j(_=>_===null?null:new yt(y,_)));if(c.length===0&&T.length===0)return M(new yt(y,[]));let b=pn(r)===i;return this.processSegment(l,c,I,T,b?V:i,!0).pipe(j(_=>new yt(y,_ instanceof yt?[_]:[])))}))):Xi(n)))}getChildConfig(e,n,r){return n.children?M({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?M({routes:n._loadedRoutes,injector:n._loadedInjector}):Y_(e,n,r,this.urlSerializer).pipe(be(o=>o?this.configLoader.loadChildren(e,n).pipe(xe(i=>{n._loadedRoutes=i.routes,n._loadedInjector=i.injector})):Z_(n))):M({routes:[],injector:e})}};function lR(t){t.sort((e,n)=>e.value.outlet===V?-1:n.value.outlet===V?1:e.value.outlet.localeCompare(n.value.outlet))}function uR(t){let e=t.value.routeConfig;return e&&e.path===""}function YE(t){let e=[],n=new Set;for(let r of t){if(!uR(r)){e.push(r);continue}let o=e.find(i=>r.value.routeConfig===i.value.routeConfig);o!==void 0?(o.children.push(...r.children),n.add(o)):e.push(r)}for(let r of n){let o=YE(r.children);e.push(new yt(r.value,o))}return e.filter(r=>!n.has(r))}function dR(t){return t.data||{}}function hR(t){return t.resolve||{}}function fR(t,e,n,r,o,i){return be(s=>aR(t,e,n,r,s.extractedUrl,o,i).pipe(j(({state:a,tree:c})=>S(m({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function pR(t,e){return be(n=>{let{targetSnapshot:r,guards:{canActivateChecks:o}}=n;if(!o.length)return M(n);let i=new Set(o.map(c=>c.route)),s=new Set;for(let c of i)if(!s.has(c))for(let l of QE(c))s.add(l);let a=0;return X(s).pipe(Nt(c=>i.has(c)?gR(c,r,t,e):(c.data=fg(c,c.parent,t).resolve,M(void 0))),xe(()=>a++),$o(1),be(c=>a===s.size?M(n):ze))})}function QE(t){let e=t.children.map(n=>QE(n)).flat();return[t,...e]}function gR(t,e,n,r){let o=t.routeConfig,i=t._resolve;return o?.title!==void 0&&!VE(o)&&(i[uc]=o.title),mR(i,t,e,r).pipe(j(s=>(t._resolvedData=s,t.data=fg(t,t.parent,n).resolve,null)))}function mR(t,e,n,r){let o=Bp(t);if(o.length===0)return M({});let i={};return X(o).pipe(be(s=>yR(t[s],e,n,r).pipe(qt(),xe(a=>{i[s]=a}))),$o(1),Cd(i),Mt(s=>KE(s)?ze:jo(s)))}function yR(t,e,n,r){let o=dc(e)??r,i=as(t,o),s=i.resolve?i.resolve(e,n):Cn(o,()=>i(e,n));return Ar(s)}function Up(t){return _e(e=>{let n=t(e);return n?X(n).pipe(j(()=>e)):M(e)})}var JE=(()=>{let e=class e{buildTitle(r){let o,i=r.root;for(;i!==void 0;)o=this.getResolvedTitleForRoute(i)??o,i=i.children.find(s=>s.outlet===V);return o}getResolvedTitleForRoute(r){return r.data[uc]}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>D(vR),providedIn:"root"});let t=e;return t})(),vR=(()=>{let e=class e extends JE{constructor(r){super(),this.title=r}updateTitle(r){let o=this.buildTitle(r);o!==void 0&&this.title.setTitle(o)}};e.\u0275fac=function(o){return new(o||e)(R(uC))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Cg=new O("",{providedIn:"root",factory:()=>({})}),Eg=new O(""),CR=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=D(Xh)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return M(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let o=Ar(r.loadComponent()).pipe(j(ZE),xe(s=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s}),Gn(()=>{this.componentLoaders.delete(r)})),i=new Bo(o,()=>new Ie).pipe(Ho());return this.componentLoaders.set(r,i),i}loadChildren(r,o){if(this.childrenLoaders.get(o))return this.childrenLoaders.get(o);if(o._loadedRoutes)return M({routes:o._loadedRoutes,injector:o._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(o);let s=ER(o,this.compiler,r,this.onLoadEndListener).pipe(Gn(()=>{this.childrenLoaders.delete(o)})),a=new Bo(s,()=>new Ie).pipe(Ho());return this.childrenLoaders.set(o,a),a}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ER(t,e,n,r){return Ar(t.loadChildren()).pipe(j(ZE),be(o=>o instanceof bs||Array.isArray(o)?M(o):X(e.compileModuleAsync(o))),j(o=>{r&&r(t);let i,s,a=!1;return Array.isArray(o)?(s=o,a=!0):(i=o.create(n).injector,s=i.get(Eg,[],{optional:!0,self:!0}).flat()),{routes:s.map(yg),injector:i}}))}function IR(t){return t&&typeof t=="object"&&"default"in t}function ZE(t){return IR(t)?t.default:t}var Ig=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>D(TR),providedIn:"root"});let t=e;return t})(),TR=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,o){return r}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wR=new O("");var AR=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ie,this.transitionAbortSubject=new Ie,this.configLoader=D(CR),this.environmentInjector=D(nt),this.urlSerializer=D(hg),this.rootContexts=D(Xu),this.location=D(wn),this.inputBindingEnabled=D(mg,{optional:!0})!==null,this.titleStrategy=D(JE),this.options=D(Cg,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=D(Ig),this.createViewTransition=D(wR,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>M(void 0),this.rootComponentType=null;let r=i=>this.events.next(new Yp(i)),o=i=>this.events.next(new Qp(i));this.configLoader.onLoadEndListener=o,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let o=++this.navigationId;this.transitions?.next(S(m(m({},this.transitions.value),r),{id:o}))}setupNavigations(r,o,i){return this.transitions=new De({id:0,currentUrlTree:o,currentRawUrl:o,extractedUrl:this.urlHandlingStrategy.extract(o),urlAfterRedirects:this.urlHandlingStrategy.extract(o),rawUrl:o,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:ec,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ve(s=>s.id!==0),j(s=>S(m({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),_e(s=>{let a=!1,c=!1;return M(s).pipe(_e(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",vt.SupersededByNewNavigation),ze;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?S(m({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&h!=="reload"){let g="";return this.events.next(new ko(l.id,this.urlSerializer.serialize(l.rawUrl),g,Gp.IgnoredSameUrlNavigation)),l.resolve(null),ze}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return M(l).pipe(_e(g=>{let y=this.transitions?.getValue();return this.events.next(new rc(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),y!==this.transitions?.getValue()?ze:Promise.resolve(g)}),fR(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),xe(g=>{s.targetSnapshot=g.targetSnapshot,s.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=S(m({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let y=new Ku(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(y)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:g,extractedUrl:y,source:I,restoredState:T,extras:b}=l,_=new rc(g,this.urlSerializer.serialize(y),I,T);this.events.next(_);let se=BE(this.rootComponentType).snapshot;return this.currentTransition=s=S(m({},l),{targetSnapshot:se,urlAfterRedirects:y,extras:S(m({},b),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=y,M(s)}else{let g="";return this.events.next(new ko(l.id,this.urlSerializer.serialize(l.extractedUrl),g,Gp.IgnoredByUrlHandlingStrategy)),l.resolve(null),ze}}),xe(l=>{let u=new qp(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),j(l=>(this.currentTransition=s=S(m({},l),{guards:N_(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),j_(this.environmentInjector,l=>this.events.next(l)),xe(l=>{if(s.guardsResult=l.guardsResult,os(l.guardsResult))throw GE(this.urlSerializer,l.guardsResult);let u=new zp(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),ve(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",vt.GuardRejected),!1)),Up(l=>{if(l.guards.canActivateChecks.length)return M(l).pipe(xe(u=>{let h=new Kp(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}),_e(u=>{let h=!1;return M(u).pipe(pR(this.paramsInheritanceStrategy,this.environmentInjector),xe({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(u,"",vt.NoDataFromResolver)}}))}),xe(u=>{let h=new Wp(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}))}),Up(l=>{let u=h=>{let g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(xe(y=>{h.component=y}),j(()=>{})));for(let y of h.children)g.push(...u(y));return g};return Oc(u(l.targetSnapshot.root)).pipe($n(null),lt(1))}),Up(()=>this.afterPreactivation()),_e(()=>{let{currentSnapshot:l,targetSnapshot:u}=s,h=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return h?X(h).pipe(j(()=>s)):M(s)}),j(l=>{let u=w_(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=S(m({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),xe(()=>{this.events.next(new ic)}),M_(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),lt(1),xe({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new No(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),fs(this.transitionAbortSubject.pipe(xe(l=>{throw l}))),Gn(()=>{!a&&!c&&this.cancelNavigationTransition(s,"",vt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Mt(l=>{if(c=!0,zE(l))this.events.next(new wr(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),D_(l)?this.events.next(new sc(l.url)):s.resolve(!1);else{this.events.next(new oc(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(r.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return ze}))}))}cancelNavigationTransition(r,o,i){let s=new wr(r.id,this.urlSerializer.serialize(r.extractedUrl),o,i);this.events.next(s),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function SR(t){return t!==ec}var DR=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>D(bR),providedIn:"root"});let t=e;return t})(),dg=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},bR=(()=>{let e=class e extends dg{};e.\u0275fac=(()=>{let r;return function(i){return(r||(r=kh(e)))(i||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),XE=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:()=>D(_R),providedIn:"root"});let t=e;return t})(),_R=(()=>{let e=class e extends XE{constructor(){super(...arguments),this.location=D(wn),this.urlSerializer=D(hg),this.options=D(Cg,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=D(Ig),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Tr,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=BE(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(o=>{o.type==="popstate"&&r(o.url,o.state)})}handleRouterEvent(r,o){if(r instanceof rc)this.stateMemento=this.createStateMemento();else if(r instanceof ko)this.rawUrlTree=o.initialUrl;else if(r instanceof Ku){if(this.urlUpdateStrategy==="eager"&&!o.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(o.finalUrl,o.initialUrl);this.setBrowserUrl(i,o)}}else r instanceof ic?(this.currentUrlTree=o.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(o.finalUrl,o.initialUrl),this.routerState=o.targetRouterState,this.urlUpdateStrategy==="deferred"&&(o.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,o))):r instanceof wr&&(r.code===vt.GuardRejected||r.code===vt.NoDataFromResolver)?this.restoreHistory(o):r instanceof oc?this.restoreHistory(o,!0):r instanceof No&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,o){let i=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(i)||o.extras.replaceUrl){let s=this.browserPageId,a=m(m({},o.extras.state),this.generateNgRouterState(o.id,s));this.location.replaceState(i,"",a)}else{let s=m(m({},o.extras.state),this.generateNgRouterState(o.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(r,o=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===r.finalUrl&&s===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(o&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,o){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:o}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(i){return(r||(r=kh(e)))(i||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Za=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Za||{});function RR(t,e){t.events.pipe(ve(n=>n instanceof No||n instanceof wr||n instanceof oc||n instanceof ko),j(n=>n instanceof No||n instanceof ko?Za.COMPLETE:(n instanceof wr?n.code===vt.Redirect||n.code===vt.SupersededByNewNavigation:!1)?Za.REDIRECTING:Za.FAILED),ve(n=>n!==Za.REDIRECTING),lt(1)).subscribe(()=>{e()})}function MR(t){throw t}var NR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},kR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},td=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=D(Al),this.stateManager=D(XE),this.options=D(Cg,{optional:!0})||{},this.pendingTasks=D(Br),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=D(AR),this.urlSerializer=D(hg),this.location=D(wn),this.urlHandlingStrategy=D(Ig),this._events=new Ie,this.errorHandler=this.options.errorHandler||MR,this.navigated=!1,this.routeReuseStrategy=D(DR),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=D(Eg,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!D(mg,{optional:!0}),this.eventsSubscription=new Se,this.isNgZoneEnabled=D(Ce)instanceof Ce&&Ce.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(o=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(o,s),o instanceof wr&&o.code!==vt.Redirect&&o.code!==vt.SupersededByNewNavigation)this.navigated=!0;else if(o instanceof No)this.navigated=!0;else if(o instanceof sc){let a=this.urlHandlingStrategy.merge(o.url,i.currentRawUrl),c={info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||SR(i.source)};this.scheduleNavigation(a,ec,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}PR(o)&&this._events.next(o)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ec,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,o)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",o)},0)})}navigateToSyncWithBrowser(r,o,i){let s={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let l=m({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,o,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(yg),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,o={}){let{relativeTo:i,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:l}=o,u=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=m(m({},this.currentUrlTree.queryParams),s);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}h!==null&&(h=this.removeEmptyProps(h));let g;try{let y=i?i.snapshot:this.routerState.snapshot.root;g=LE(y)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),g=this.currentUrlTree.root}return FE(g,r,h,u??null)}navigateByUrl(r,o={skipLocationChange:!1}){let i=os(r)?r:this.parseUrl(r),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,ec,null,o)}navigate(r,o={skipLocationChange:!1}){return OR(r),this.navigateByUrl(this.createUrlTree(r,o),o)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,o){let i;if(o===!0?i=m({},NR):o===!1?i=m({},kR):i=o,os(r))return IE(this.currentUrlTree,r,i);let s=this.parseUrl(r);return IE(this.currentUrlTree,s,i)}removeEmptyProps(r){return Object.entries(r).reduce((o,[i,s])=>(s!=null&&(o[i]=s),o),{})}scheduleNavigation(r,o,i,s,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((g,y)=>{c=g,l=y});let h=this.pendingTasks.add();return RR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:o,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:s,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(g=>Promise.reject(g))}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function OR(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new x(4008,!1)}function PR(t){return!(t instanceof ic)&&!(t instanceof sc)}var xR=new O("");function eI(t,...e){return ei([{provide:Eg,multi:!0,useValue:t},[],{provide:is,useFactory:LR,deps:[td]},{provide:Sl,multi:!0,useFactory:FR},e.map(n=>n.\u0275providers)])}function LR(t){return t.routerState.root}function FR(){let t=D(Ms);return e=>{let n=t.get(ri);if(e!==n.components[0])return;let r=t.get(td),o=t.get(UR);t.get(HR)===1&&r.initialNavigation(),t.get(BR,null,q.Optional)?.setUpPreloading(),t.get(xR,null,q.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var UR=new O("",{factory:()=>new Ie}),HR=new O("",{providedIn:"root",factory:()=>1});var BR=new O("");var tI="@azure/msal-angular",Tg="3.0.20",fc=new O("MSAL_INSTANCE"),cs=new O("MSAL_GUARD_CONFIG"),nd=new O("MSAL_INTERCEPTOR_CONFIG"),VR=new O("MSAL_BROADCAST_CONFIG"),gn=(()=>{class t{constructor(n,r){this.instance=n,this.location=r;let o=this.location.path(!0).split("#").pop();o&&(this.redirectHash=`#${o}`),this.instance.initializeWrapperLibrary(bp.Angular,Tg)}initialize(){return X(this.instance.initialize())}acquireTokenPopup(n){return X(this.instance.acquireTokenPopup(n))}acquireTokenRedirect(n){return X(this.instance.acquireTokenRedirect(n))}acquireTokenSilent(n){return X(this.instance.acquireTokenSilent(n))}handleRedirectObservable(n){return X(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(n||this.redirectHash)))}loginPopup(n){return X(this.instance.loginPopup(n))}loginRedirect(n){return X(this.instance.loginRedirect(n))}logout(n){return X(this.instance.logout(n))}logoutRedirect(n){return X(this.instance.logoutRedirect(n))}logoutPopup(n){return X(this.instance.logoutPopup(n))}ssoSilent(n){return X(this.instance.ssoSilent(n))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(tI,Tg)),this.logger}setLogger(n){this.logger=n.clone(tI,Tg),this.instance.setLogger(n)}}return t.\u0275fac=function(n){return new(n||t)(R(fc),R(wn))},t.\u0275prov=k({token:t,factory:t.\u0275fac}),t})(),jn=(()=>{class t{constructor(n,r,o){this.msalInstance=n,this.authService=r,this.msalBroadcastConfig=o,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.authService.getLogger().verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new hs(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new Ie,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new De(fe.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(i=>{this._msalSubject.next(i);let s=Ya.getInteractionStatusFromEvent(i,this._inProgress.value);s!==null&&(this.authService.getLogger().verbose(`BroadcastService - ${i.eventType} results in setting inProgress from ${this._inProgress.value} to ${s}`),this._inProgress.next(s))})}}return t.\u0275fac=function(n){return new(n||t)(R(fc),R(gn),R(VR,8))},t.\u0275prov=k({token:t,factory:t.\u0275fac}),t})(),pc=(()=>{class t{constructor(n,r,o,i,s){this.msalGuardConfig=n,this.msalBroadcastService=r,this.authService=o,this.location=i,this.router=s,this.msalBroadcastService.inProgress$.subscribe()}parseUrl(n){return this.router.parseUrl(n)}getDestinationUrl(n){this.authService.getLogger().verbose("Guard - getting destination url");let r=document.getElementsByTagName("base"),o=this.location.normalize(r.length?r[0].href:window.location.origin),i=this.location.prepareExternalUrl(n);return i.startsWith("#")?(this.authService.getLogger().verbose("Guard - destination by hash routing"),`${o}/${i}`):`${o}${n}`}loginInteractively(n){let r=typeof this.msalGuardConfig.authRequest=="function"?this.msalGuardConfig.authRequest(this.authService,n):m({},this.msalGuardConfig.authRequest);if(this.msalGuardConfig.interactionType===w.Popup)return this.authService.getLogger().verbose("Guard - logging in by popup"),this.authService.loginPopup(r).pipe(j(i=>(this.authService.getLogger().verbose("Guard - login by popup successful, can activate, setting active account"),this.authService.instance.setActiveAccount(i.account),!0)));this.authService.getLogger().verbose("Guard - logging in by redirect");let o=this.getDestinationUrl(n.url);return this.authService.loginRedirect(m({redirectStartPage:o},r)).pipe(j(()=>!1))}activateHelper(n){if(this.msalGuardConfig.interactionType!==w.Popup&&this.msalGuardConfig.interactionType!==w.Redirect)throw new bo("invalid_interaction_type","Invalid interaction type provided to MSAL Guard. InteractionType.Popup or InteractionType.Redirect must be provided in the MsalGuardConfiguration");if(this.authService.getLogger().verbose("MSAL Guard activated"),typeof window<"u"){if(H.hashContainsKnownProperties(window.location.hash)&&Eu.isInIframe()&&!this.authService.instance.getConfiguration().system.allowRedirectInIframe)return this.authService.getLogger().warning("Guard - redirectUri set to page with MSAL Guard. It is recommended to not set redirectUri to a page that requires authentication."),M(!1)}else return this.authService.getLogger().info("Guard - window is undefined, MSAL does not support server-side token acquisition"),M(!0);this.msalGuardConfig.loginFailedRoute&&(this.loginFailedRoute=this.parseUrl(this.msalGuardConfig.loginFailedRoute));let r=this.location.path(!0);return this.authService.initialize().pipe(Nt(()=>this.authService.handleRedirectObservable()),Nt(()=>{if(!this.authService.instance.getAllAccounts().length)return n?(this.authService.getLogger().verbose("Guard - no accounts retrieved, log in required to activate"),this.loginInteractively(n)):(this.authService.getLogger().verbose("Guard - no accounts retrieved, no state, cannot load"),M(!1));if(this.authService.getLogger().verbose("Guard - at least 1 account exists, can activate or load"),n){let o=this.includesCode(n.url),i=!!n.root&&!!n.root.fragment&&this.includesCode(`#${n.root.fragment}`),s=this.location.prepareExternalUrl(n.url).indexOf("#")===0;if(o&&(i||s))return this.authService.getLogger().info("Guard - Hash contains known code response, stopping navigation."),r.indexOf("#")>-1?M(this.parseUrl(this.location.path())):M(this.parseUrl(""))}return M(!0)}),Mt(o=>(this.authService.getLogger().error("Guard - error while logging in, unable to activate"),this.authService.getLogger().errorPii(`Guard - error: ${o.message}`),this.loginFailedRoute&&n?(this.authService.getLogger().verbose("Guard - loginFailedRoute set, redirecting"),M(this.loginFailedRoute)):M(!1))))}includesCode(n){return n.lastIndexOf("/code")>-1&&n.lastIndexOf("/code")===n.length-5||n.indexOf("#code=")>-1||n.indexOf("&code=")>-1}canActivate(n,r){return this.authService.getLogger().verbose("Guard - canActivate"),this.activateHelper(r)}canActivateChild(n,r){return this.authService.getLogger().verbose("Guard - canActivateChild"),this.activateHelper(r)}canMatch(){return this.authService.getLogger().verbose("Guard - canLoad"),this.activateHelper()}}return t.\u0275fac=function(n){return new(n||t)(R(cs),R(jn),R(gn),R(wn),R(td))},t.\u0275prov=k({token:t,factory:t.\u0275fac}),t})(),nI=(()=>{class t{constructor(n,r,o,i,s){this.msalInterceptorConfig=n,this.authService=r,this.location=o,this.msalBroadcastService=i,this._document=s}intercept(n,r){if(this.msalInterceptorConfig.interactionType!==w.Popup&&this.msalInterceptorConfig.interactionType!==w.Redirect)throw new bo("invalid_interaction_type","Invalid interaction type provided to MSAL Interceptor. InteractionType.Popup, InteractionType.Redirect must be provided in the msalInterceptorConfiguration");this.authService.getLogger().verbose("MSAL Interceptor activated");let o=this.getScopesForEndpoint(n.url,n.method);if(!o||o.length===0)return this.authService.getLogger().verbose("Interceptor - no scopes for endpoint"),r.handle(n);let i;this.authService.instance.getActiveAccount()?(this.authService.getLogger().verbose("Interceptor - active account selected"),i=this.authService.instance.getActiveAccount()):(this.authService.getLogger().verbose("Interceptor - no active account, fallback to first account"),i=this.authService.instance.getAllAccounts()[0]);let s=typeof this.msalInterceptorConfig.authRequest=="function"?this.msalInterceptorConfig.authRequest(this.authService,n,{account:i}):S(m({},this.msalInterceptorConfig.authRequest),{account:i});return this.authService.getLogger().info(`Interceptor - ${o.length} scopes found for endpoint`),this.authService.getLogger().infoPii(`Interceptor - [${o}] scopes found for ${n.url}`),this.acquireToken(s,o,i).pipe(_e(a=>{this.authService.getLogger().verbose("Interceptor - setting authorization headers");let c=n.headers.set("Authorization",`Bearer ${a.accessToken}`),l=n.clone({headers:c});return r.handle(l)}))}acquireToken(n,r,o){return this.authService.acquireTokenSilent(S(m({},n),{scopes:r,account:o})).pipe(Mt(()=>(this.authService.getLogger().error("Interceptor - acquireTokenSilent rejected with error. Invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(lt(1),_e(i=>i===fe.None?this.acquireTokenInteractively(n,r):this.msalBroadcastService.inProgress$.pipe(ve(s=>s===fe.None),lt(1),_e(()=>this.acquireToken(n,r,o))))))),_e(i=>i.accessToken?M(i):(this.authService.getLogger().error("Interceptor - acquireTokenSilent resolved with null access token. Known issue with B2C tenants, invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(ve(s=>s===fe.None),lt(1),_e(()=>this.acquireTokenInteractively(n,r))))))}acquireTokenInteractively(n,r){if(this.msalInterceptorConfig.interactionType===w.Popup)return this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by popup"),this.authService.acquireTokenPopup(S(m({},n),{scopes:r}));this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by redirect");let o=window.location.href;return this.authService.acquireTokenRedirect(S(m({},n),{scopes:r,redirectStartPage:o})),ze}getScopesForEndpoint(n,r){this.authService.getLogger().verbose("Interceptor - getting scopes for endpoint");let o=this.location.normalize(n),i=Array.from(this.msalInterceptorConfig.protectedResourceMap.keys()),s=this.matchResourcesToEndpoint(i,o);return s.length>0?this.matchScopesToEndpoint(this.msalInterceptorConfig.protectedResourceMap,s,r):null}matchResourcesToEndpoint(n,r){let o=[];return n.forEach(i=>{let s=this.location.normalize(i),a=this.getAbsoluteUrl(s),c=new URL(a),l=this.getAbsoluteUrl(r),u=new URL(l);this.checkUrlComponents(c,u)&&o.push(i)}),o}checkUrlComponents(n,r){let o=["protocol","host","pathname","search","hash"];for(let i of o)if(n[i]){let s=decodeURIComponent(n[i]);if(!ge.matchPattern(s,r[i]))return!1}return!0}getAbsoluteUrl(n){let r=this._document.createElement("a");return r.href=n,r.href}matchScopesToEndpoint(n,r,o){let i=[];return r.forEach(s=>{let a=[],c=n.get(s);if(c===null){i.push(null);return}c.forEach(l=>{if(typeof l=="string")a.push(l);else{let u=o.toLowerCase();l.httpMethod.toLowerCase()===u&&(l.scopes===null?i.push(null):l.scopes.forEach(g=>{a.push(g)}))}}),a.length>0&&i.push(a)}),i.length>0?(i.length>1&&this.authService.getLogger().warning("Interceptor - More than 1 matching scopes for endpoint found."),i[0]):null}}return t.\u0275fac=function(n){return new(n||t)(R(nd),R(gn),R(wn),R(jn),R(Ge))},t.\u0275prov=k({token:t,factory:t.\u0275fac}),t})();var rI=(()=>{class t{static forRoot(n,r,o){return{ngModule:t,providers:[{provide:fc,useValue:n},{provide:cs,useValue:r},{provide:nd,useValue:o},gn]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Lr({type:t}),t.\u0275inj=xr({providers:[pc,jn],imports:[Fs]}),t})();function $R(t,e){t&1&&(Te(0,"div")(1,"p",0),pe(2,"Welcome to WebPortal 1!"),ae(),Te(3,"p"),pe(4,"This sample demonstrates how to configure MSAL Angular to login, logout, protect a route, and acquire an access token for a protected resource such as the Microsoft Graph."),ae(),Te(5,"p"),pe(6,"Please sign-in to see your profile information."),ae()())}function GR(t,e){if(t&1&&(Te(0,"div")(1,"p"),pe(2,"Login successful!"),ae(),Te(3,"div")(4,"p")(5,"strong"),pe(6,"Name: "),ae(),pe(7),ae(),Te(8,"p")(9,"strong"),pe(10,"Username: "),ae(),pe(11),ae()()()),t&2){let n=Ps();dt(7),tn(" ",n.profile==null?null:n.profile.name,""),dt(4),tn(" ",n.profile==null?null:n.profile.username,"")}}var iI=(()=>{let e=class e{constructor(r,o){this.authService=r,this.msalBroadcastService=o,this.loginDisplay=!1}ngOnInit(){this.msalBroadcastService.msalSubject$.pipe(ve(r=>r.eventType===A.LOGIN_SUCCESS)).subscribe(r=>{console.log(r);let o=r.payload;this.authService.instance.setActiveAccount(o.account)}),this.msalBroadcastService.inProgress$.pipe(ve(r=>r===fe.None)).subscribe(()=>{this.setLoginDisplay()})}setLoginDisplay(){if(this.loginDisplay=this.authService.instance.getAllAccounts().length>0,this.loginDisplay){let r=this.authService.instance.getAllAccounts();this.profile={},this.profile.name=r[0].name,this.profile.username=r[0].username}}};e.\u0275fac=function(o){return new(o||e)($e(gn),$e(jn))},e.\u0275cmp=xt({type:e,selectors:[["app-home"]],standalone:!0,features:[nn],decls:2,vars:2,consts:[[1,"welcome"]],template:function(o,i){o&1&&ks(0,$R,7,0,"div")(1,GR,12,2,"div"),o&2&&(Qh(0,i.loginDisplay?-1:0),dt(),Qh(1,i.loginDisplay?1:-1))}});let t=e;return t})();var sI=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=xt({type:e,selectors:[["app-failed"]],standalone:!0,features:[nn],decls:2,vars:0,template:function(o,i){o&1&&(Te(0,"p"),pe(1,"failed works!"),ae())}});let t=e;return t})();var aI=[{path:"profile",component:dC,canActivate:[pc]},{path:"",component:iI},{path:"login-failed",component:sI}];function qR(t,e){console.log(e)}function zR(){return new Wa({auth:{clientId:Xn.msalConfig.auth.clientId,authority:Xn.msalConfig.auth.authority,redirectUri:"https://swapnil725.github.io/directory-listing",postLogoutRedirectUri:"https://swapnil725.github.io/directory-listing"},cache:{cacheLocation:ce.LocalStorage},system:{allowNativeBroker:!1,loggerOptions:{loggerCallback:qR,logLevel:oe.Info,piiLoggingEnabled:!1}}})}function KR(){let t=new Map;return t.set(Xn.apiConfig.uri,Xn.apiConfig.scopes),{interactionType:w.Redirect,protectedResourceMap:t}}function WR(){return{interactionType:w.Redirect,authRequest:{scopes:[...Xn.apiConfig.scopes]},loginFailedRoute:"/login-failed"}}var cI={providers:[eI(aI),Zv(Xv(),eC()),{provide:uf,useClass:nI,multi:!0},{provide:fc,useFactory:zR},{provide:cs,useFactory:WR},{provide:nd,useFactory:KR},gn,pc,jn]};function YR(t,e){if(t&1){let n=Jh();Te(0,"div")(1,"button",3),Os("click",function(){Th(n);let o=Ps();return wh(o.loginRedirect())}),pe(2,"Login using Redirect"),ae()()}}function QR(t,e){if(t&1){let n=Jh();Te(0,"div")(1,"button",3),Os("click",function(){Th(n);let o=Ps();return wh(o.logout())}),pe(2,"Logout using Redirect"),ae()()}}var lI=(()=>{let e=class e{constructor(r,o,i,s){this.msalGuardConfig=r,this.authService=o,this.msalBroadcastService=i,this.http=s,this.title="web-portal",this.isIframe=!1,this.loginDisplay=!1,this._destroying$=new Ie}ngOnInit(){this.authService.handleRedirectObservable().subscribe(),this.isIframe=window!==window.parent&&!window.opener,this.setLoginDisplay(),this.authService.instance.enableAccountStorageEvents(),this.msalBroadcastService.msalSubject$.pipe(ve(r=>r.eventType===A.ACCOUNT_ADDED||r.eventType===A.ACCOUNT_REMOVED)).subscribe(r=>{this.authService.instance.getAllAccounts().length===0?window.location.pathname="/":this.setLoginDisplay()}),this.msalBroadcastService.inProgress$.pipe(ve(r=>r===fe.None),fs(this._destroying$)).subscribe(()=>{this.setLoginDisplay(),this.checkAndSetActiveAccount()})}setLoginDisplay(){this.loginDisplay=this.authService.instance.getAllAccounts().length>0}getProfile(r){this.http.get(r).subscribe(o=>{this.profile=o})}checkAndSetActiveAccount(){if(!this.authService.instance.getActiveAccount()&&this.authService.instance.getAllAccounts().length>0){let o=this.authService.instance.getAllAccounts();this.authService.instance.setActiveAccount(o[0])}}loginRedirect(){this.msalGuardConfig.authRequest?this.authService.loginRedirect(m({},this.msalGuardConfig.authRequest)):this.authService.loginRedirect()}loginPopup(){this.msalGuardConfig.authRequest?this.authService.loginPopup(m({},this.msalGuardConfig.authRequest)).subscribe(r=>{this.authService.instance.setActiveAccount(r.account)}):this.authService.loginPopup().subscribe(r=>{this.authService.instance.setActiveAccount(r.account)})}logout(r){r?this.authService.logoutPopup({mainWindowRedirectUri:"/"}):this.authService.logoutRedirect()}ngOnDestroy(){this._destroying$.next(void 0),this._destroying$.complete()}};e.\u0275fac=function(o){return new(o||e)($e(cs),$e(gn),$e(jn),$e(Gs))},e.\u0275cmp=xt({type:e,selectors:[["app-root"]],standalone:!0,features:[nn],decls:9,vars:3,consts:[["href","/",1,"title"],[4,"ngIf"],[1,"container"],[3,"click"]],template:function(o,i){o&1&&(Te(0,"div")(1,"a",0),pe(2),ae(),ni(3,"br")(4,"br"),ks(5,YR,3,0,"div",1)(6,QR,3,0,"div",1),ae(),Te(7,"div",2),ni(8,"router-outlet"),ae()),o&2&&(dt(2),Zh(i.title),dt(3),wl("ngIf",!i.loginDisplay),dt(),wl("ngIf",i.loginDisplay))},dependencies:[gg,Fs,Uv,rI]});let t=e;return t})();lC(lI,cI).catch(t=>console.error(t));
